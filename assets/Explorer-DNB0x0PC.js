import{k as M,j as K,b as C,m as S,p as y,i as o,c as d,f as R,F as j,S as D,n as O,q,r as B,l as Q,g as x,d as U,t as _}from"./index-KbroOzgI.js";import{S as W,C as Y}from"./Shalala-Gxspf2Kv.js";import{T as z,C as H}from"./Chesstree2-dtmTG1yT.js";import{R as J,S as V}from"./studyrepo-BZzCa7LT.js";import{I as X}from"./chess_pgn_logic-BaBYzI3_.js";import{s as Z}from"./scroll-DnAhRpRC.js";var ee=_("<div class=explorer><div class=e-studies><h3>Studies</h3><select></select><div class=e-chapters><h3>Chapters</h3></div></div><div class=e-chapter-wrap>"),G=_("<option>"),te=_("<span> Loading ... "),ae=_("<select>"),re=_("<span>Loading..."),ne=_("<div class=explorer-chapter><div class=board-wrap></div><div class=replay-wrap><div class=replay-header><h3></h3></div><div class=replay><div class=replay-v></div><div class=replay-jump><button data-icon=></button><button data-icon=></button><button data-icon=></button><button data-icon=></button></div><div class=replay-tools>");const ve=()=>{let h=J.all.filter(t=>t.study_link!==""&&t.category!=="Tactics");const[E,k]=M(0),[f]=K(()=>h[E()].study_link,t=>V.read_study(t)),[m,b]=M(0),r=C(()=>{var t;return(t=f())==null?void 0:t.chapters}),a=C(()=>{var t;return(t=r())==null?void 0:t[m()]});return S(y(f,()=>{b(0)})),(()=>{var t=ee(),v=t.firstChild,u=v.firstChild,e=u.nextSibling,n=e.nextSibling;n.firstChild;var p=v.nextSibling;return e.addEventListener("change",l=>k(parseInt(l.currentTarget.value))),o(e,d(j,{each:h,children:(l,c)=>(()=>{var i=G();return o(i,()=>l.study_name),R(()=>i.value=c()),i})()})),o(n,d(D,{get when(){return r()},get fallback(){return te()},children:l=>(()=>{var c=ae();return c.addEventListener("change",i=>b(parseInt(i.currentTarget.value))),o(c,d(j,{get each(){return l()},children:(i,$)=>(()=>{var g=G();return o(g,()=>i.name),R(()=>g.value=$()),g})()})),c})()}),null),o(p,d(D,{get when(){return a()},get fallback(){return re()},children:l=>d(se,{get pgn_chapter(){return l()}})})),t})()},se=h=>{const E=O(),k=()=>!1,f=()=>"white",m=()=>h.pgn_chapter,b=C(()=>m().pgn),r=new W,a=C(()=>z.make(b().tree));S(y(()=>a().fen_last_move,e=>{if(e){let[n,p]=e;r.on_set_fen_uci(n,p)}else r.on_set_fen_uci(X)})),S(y(()=>r.on_wheel,e=>{e&&a().on_wheel(e)}));const t=e=>{e.key};S(y(()=>{var e;return(e=a().tree)==null?void 0:e.get_at(a().cursor_path)},e=>{e&&E.move(e)})),q(()=>{document.addEventListener("keypress",t)}),B(()=>{document.removeEventListener("keypress",t)});const v=Z(e=>{const n=e.target;n.tagName!=="PIECE"&&n.tagName!=="SQUARE"&&n.tagName!=="CG-BOARD"||(e.preventDefault(),r.set_on_wheel(Math.sign(e.deltaY)))});let u;return q(()=>{u.addEventListener("wheel",v,{passive:!1})}),B(()=>{u.removeEventListener("wheel",v)}),(()=>{var e=ne(),n=e.firstChild,p=n.nextSibling,l=p.firstChild,c=l.firstChild,i=l.nextSibling,$=i.firstChild,g=$.nextSibling,w=g.firstChild,L=w.nextSibling,I=L.nextSibling,N=I.nextSibling;return Q(s=>u=s,e),o(n,d(Y,{get orientation(){return f()},get movable(){return k()},get doPromotion(){return r.promotion},get onMoveAfter(){return r.on_move_after},get fen_uci(){return r.fen_uci},get color(){return r.turnColor},get dests(){return r.dests}})),o(c,()=>m().name),o($,d(H,{get lala(){return a()}})),w.$$click=()=>a().navigate_first(),L.$$click=()=>a().navigate_prev(),I.$$click=()=>a().navigate_next(),N.$$click=()=>a().navigate_last(),R(s=>{var T="fbt first"+(a().can_navigate_prev?"":" disabled"),P="fbt prev"+(a().can_navigate_prev?"":" disabled"),A="fbt next"+(a().can_navigate_next?"":" disabled"),F="fbt last"+(a().can_navigate_next?"":" disabled");return T!==s.e&&x(w,s.e=T),P!==s.t&&x(L,s.t=P),A!==s.a&&x(I,s.a=A),F!==s.o&&x(N,s.o=F),s},{e:void 0,t:void 0,a:void 0,o:void 0}),e})()};U(["click"]);export{ve as default};
