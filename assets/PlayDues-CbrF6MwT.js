import{k as V,H as L,c as s,S as p,N as X,f as n,i as _,l as Z,a as g,D as ee,I as te,n as E,r as re,u as ne,d as se,t as c,J as H,q as T,x as q,m as ae}from"./index-XVCA7pQm.js";import{a as oe,D as ie}from"./types-o6jPCrhR.js";import{S as ue,C as le}from"./Chessboard-MLe-dbZ0.js";import{C as ce,a as _e}from"./ChessTreeWithTools-BJYBnkan.js";import"./Chesstree2-9apf-j-g.js";var de=c("<div class=repeat-dues>"),he=c("<p>Completed All Due Moves."),pe=c("<div class=header><h3></h3><p></p><p> Due Moves"),me=c("<div class=board-wrap>"),ge=c("<div class=info>"),ve=c("<div class=replay-wrap><div class=replay-header><div class=title><h3></h3><h4>"),fe=c("<button>Hint: Show Previous Moves"),we=c("<button>Show Answer"),$e=c("<button>Next Due"),be=c("<span>Repeat Not Found");function ye(t){return t[Math.floor(Math.random()*t.length)]}const Fe=()=>{let t=V();const d=parseInt(t.id),a=L(H),u=oe(()=>a.repeat_by_id(d));return s(p,{get when(){return u()},get fallback(){return s(xe,{})},children:r=>s(Se,{get repeats(){return r()}})})},Se=t=>{const[d]=X(),a=n(()=>t.repeats),u=n(()=>new ie(a())),r=n(()=>{switch(d.filter){case"white":return u().due_white;case"black":return u().due_black;case"first-ten":return u().due_10;case"ten-twenty":return u().due_10_20;case"twenty-plus":return u().due_20plus;default:return u().due}}),M=n(()=>{switch(d.filter){case"white":return"White Only";case"black":return"Black Only";case"first-ten":return"First 10 moves";case"ten-twenty":return"10-20 moves";case"twenty-plus":return"20+ moves";default:return"All moves"}}),b=n(()=>ye(r()));return(()=>{var y=de();return _(y,s(p,{get when(){return b()},get fallback(){return he()},children:S=>[(()=>{var l=pe(),v=l.firstChild,f=v.nextSibling,C=f.nextSibling,N=C.firstChild;return _(v,()=>a().name),_(f,M),_(C,()=>r().length,N),l})(),s(Ce,{get repeats(){return a()},get due_move(){return S()}})]})),y})()},Ce=t=>{const[d]=Z(()=>t.due_move.ucis[0].section.study_id,a=>ae.read_section_study(a));return s(p,{get when(){return d()},children:a=>s(ke,{get on_wheel(){return t.on_wheel},get repeats(){return t.repeats},get due_move(){return t.due_move},get study(){return a()}})})},ke=t=>{const d=L(H),a=n(()=>t.study),u=n(()=>t.repeats),r=n(()=>t.due_move),M=n(()=>a().sections.find(e=>e.name===r().ucis[0].section.section_name)),b=n(()=>M().chapters.find(e=>e.name===r().ucis[0].section.chapter_name)),[y,S]=g(void 0),l=new ue;let[v,f]=g(void 0);const C=n(()=>ee(r()?.fen??te));E(T(r,()=>{q(()=>{w(void 0),k([]),F(r().ucis[0].path.slice(0,-1))})}));const[N,F]=g(r().ucis[0].path.slice(0,-1),{equals:!1}),[O,k]=g([]);E(T(()=>l.add_uci,e=>{if(!e)return;const o=r();let[m,x]=e;const P=o.ucis.map(U=>U.uci);let $="✓",i="✗";const A=h();let D=$;P.includes(m)?(D=$,A||w("easy")):(D=i,(!A||A==="hard")&&w("again")),S(_e(m,x,D)),D===i?k(void 0):f(setTimeout(I,600))}));const W=([e,o])=>{l.on_set_fen_uci(e,o)},B=()=>{if(h()==="again")return!1;w("hard"),k(r().ucis[0].path)},J=()=>{w("again"),k(void 0),F(r().ucis[0].path)},[h,w]=g(void 0),I=()=>{const e=u().id,o=r().fen,m=h();q(()=>{S(void 0),d.play_due_move(e,o,m??"again"),f(void 0)})},Q=n(()=>{const e=h();return!(!e||e==="hard")}),Y=n(()=>h()===void 0),j=n(()=>h()!=="again"),z=n(()=>{let e=v(),o=h();return e===void 0&&o!=="again"}),[G,K]=g(void 0,{equals:!1});let R;return re(()=>{R.addEventListener("wheel",e=>{K(Math.sign(e.deltaY))},{passive:!0})}),[(()=>{var e=me();return ne(o=>R=o,e),_(e,s(le,{get shapes(){return y()},get orientation(){return C()},get movable(){return z()},get doPromotion(){return l.promotion},get onMoveAfter(){return l.on_move_after},get fen_uci(){return l.fen_uci},get color(){return l.turnColor},get dests(){return l.dests}})),e})(),(()=>{var e=ve(),o=e.firstChild,m=o.firstChild,x=m.firstChild,P=x.nextSibling;return _(x,()=>a().name),_(P,()=>b().name),_(e,s(ce,{get hide_after_path(){return O()},get on_wheel(){return G()},get pgn(){return b().pgn},on_fen_last_move:W,get cursor_path(){return N()},get children(){var $=ge();return _($,s(p,{get when(){return v()},get fallback(){return[s(p,{get when(){return Y()},get children(){var i=fe();return i.$$click=B,i}}),s(p,{get when(){return j()},get children(){var i=we();return i.$$click=J,i}}),s(p,{get when(){return Q()},get children(){var i=$e();return i.$$click=I,i}})]},get children(){return[]}})),$}}),null),e})()]},xe=()=>be();se(["click"]);export{Fe as default};
