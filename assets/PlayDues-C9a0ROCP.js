import{k as J,H as L,c as u,S as F,N as Q,f as r,a as $,r as Y,u as j,i as _,l as z,D as G,I as K,n as E,d as U,t as h,J as q,q as T,x as V,m as X}from"./index-CxzPRMfd.js";import{a as Z,D as ee}from"./types-DJ4sTVAK.js";import{S as te,C as ne}from"./Chessboard-C6lZLH_L.js";import{C as re,a as se}from"./ChessTreeWithTools-Gflidrtn.js";import"./Chesstree2-DSYqaj_R.js";var ae=h("<div class=repeat-dues>"),oe=h("<p>Completed All Due Moves."),ie=h("<div class=header><h3></h3><p></p><p> Due Moves"),ue=h("<div class=board-wrap>"),le=h("<div class=info><button>Hint: Show Previous Moves</button><button>Show Answer</button><button>Next Due"),ce=h("<div class=replay-wrap><div class=replay-header><div class=title><h3></h3><h4>"),_e=h("<span>Repeat Not Found");function de(t){return t[Math.floor(Math.random()*t.length)]}const ye=()=>{let t=J();const l=parseInt(t.id),s=L(q),a=Z(()=>s.repeat_by_id(l));return u(F,{get when(){return a()},get fallback(){return u(ve,{})},children:n=>u(he,{get repeats(){return n()}})})},he=t=>{const[l]=Q(),s=r(()=>t.repeats),a=r(()=>new ee(s())),n=r(()=>{switch(l.filter){case"white":return a().due_white;case"black":return a().due_black;case"first-ten":return a().due_10;case"ten-twenty":return a().due_10_20;case"twenty-plus":return a().due_20plus;default:return a().due}}),P=r(()=>{switch(l.filter){case"white":return"White Only";case"black":return"Black Only";case"first-ten":return"First 10 moves";case"ten-twenty":return"10-20 moves";case"twenty-plus":return"20+ moves";default:return"All moves"}}),b=r(()=>de(n())),[y,S]=$(void 0,{equals:!1});let o;return Y(()=>{o.addEventListener("wheel",d=>{S(Math.sign(d.deltaY))},{passive:!0})}),(()=>{var d=ae();return j(p=>o=p,d),_(d,u(F,{get when(){return b()},get fallback(){return oe()},children:p=>[(()=>{var C=ie(),x=C.firstChild,k=x.nextSibling,D=k.nextSibling,m=D.firstChild;return _(x,()=>s().name),_(k,P),_(D,()=>n().length,m),C})(),u(pe,{get on_wheel(){return y()},get repeats(){return s()},get due_move(){return p()}})]})),d})()},pe=t=>{const[l]=z(()=>t.due_move.ucis[0].section.study_id,s=>X.read_section_study(s));return u(F,{get when(){return l()},children:s=>u(me,{get on_wheel(){return t.on_wheel},get repeats(){return t.repeats},get due_move(){return t.due_move},get study(){return s()}})})},me=t=>{const l=L(q),s=r(()=>t.study),a=r(()=>t.repeats),n=r(()=>t.due_move),P=r(()=>s().sections.find(e=>e.name===n().ucis[0].section.section_name)),b=r(()=>P().chapters.find(e=>e.name===n().ucis[0].section.chapter_name)),[y,S]=$(void 0),o=new te;let[d,p]=$(void 0);const C=r(()=>G(n()?.fen??K)),x=r(()=>{let e=d(),i=y();return e===void 0&&i===void 0});E(T(n,()=>{v(void 0),m([])}));const k=r(()=>n().ucis[0].path.slice(0,-1)),[D,m]=$([]);E(T(()=>o.add_uci,e=>{if(!e)return;const i=n();let[c,M]=e;const A=i.ucis.map(B=>B.uci);let f="✓",N="✗";const g=I();let w=f;A.includes(c)?(w=f,g||v("easy")):(w=N,g||v("again")),S(se(c,M,w)),p(setTimeout(R,600))}));const H=([e,i])=>{o.on_set_fen_uci(e,i)},O=()=>{v("hard"),m(n().ucis[0].path)},W=()=>{v("again"),m(void 0)},[I,v]=$(void 0),R=()=>{const e=a().id,i=n().fen,c=I();!c||c==="hard"||V(()=>{S(void 0),l.play_due_move(e,i,c??"again"),p(void 0)})};return[(()=>{var e=ue();return _(e,u(ne,{get shapes(){return y()},get orientation(){return C()},get movable(){return x()},get doPromotion(){return o.promotion},get onMoveAfter(){return o.on_move_after},get fen_uci(){return o.fen_uci},get color(){return o.turnColor},get dests(){return o.dests}})),e})(),(()=>{var e=ce(),i=e.firstChild,c=i.firstChild,M=c.firstChild,A=M.nextSibling;return _(M,()=>s().name),_(A,()=>b().name),_(e,u(re,{get hide_after_path(){return D()},get on_wheel(){return t.on_wheel},get pgn(){return b().pgn},on_fen_last_move:H,get cursor_path(){return k()},get children(){var f=le(),N=f.firstChild,g=N.nextSibling,w=g.nextSibling;return N.$$click=O,g.$$click=W,w.$$click=R,f}}),null),e})()]},ve=()=>_e();U(["click"]);export{ye as default};
