var P=Object.defineProperty;var k=(i,e,t)=>e in i?P(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var o=(i,e,t)=>(k(i,typeof e!="symbol"?e+"":e,t),t);import{P as w}from"./chess_pgn_logic-DI1SwVuy.js";import{y as p}from"./index-BVb4pj9V.js";const S=(i,e,t,s)=>{let a=w.make_many(i).map(n=>{var m;let l=(m=n.site)!=null&&m.includes("http")?n.site:`https://lichess.org/study/${e}`,r=n.event,c;if(r!=null&&r.includes(": "))[t,c]=r.split(": ");else if(n.white!=="?"){let d=n.white,b=n.black;c=`${d} vs ${b} at ${r}`}else c=r;return{name:c,site:l,pgn:n}});return{id:e,name:t,orientation:s,chapters:a}},y=(i,e,t,s,a)=>{let n=[];return w.make_many(i).map(l=>{let r,c;l.section?(r=l.section,c=l.chapter):[t,r,c]=l.event.split(":");let m=n.find(d=>d.name===r);m||n.push(m={name:r,chapters:[]}),m==null||m.chapters.push({name:c,pgn:l})}),{id:e,name:t,orientation:s,imported:a,sections:n}},v=(i,e,t)=>fetch(`pgns/${i}.pgn`).then(s=>s.text()).then(s=>S(s,i,e,t)),D=(i,e,t)=>fetch(`pgns/${i}.section.pgn`).then(s=>s.text()).then(s=>y(s,i,e,t)),$=(i,e)=>{let[t]=p("","pgn.imported."+i);return y(t(),i,e,"white",!0)},h=class h{read_section_study(e){let{study_name:t,orientation:s,imported:a}=_.study_by_id(e)||_.imported_by_id(e);return a?$(e,t):D(e,t,s)}read_study(e){let{study_name:t,orientation:s}=_.study_by_id(e);return v(e,t,s)}};o(h,"init",()=>new h);let f=h;const E=f.init(),z={Openings:[["Berlin Defence","berlin","white"],["Slav Defense","slav","black"],["London System","london-system","black"],["Caro-Kann Defense","caro-kann","white"],["Petroff Defense","petroff","white"],["Philidor Defence","philidor","white"],["Accelerated Dragon","accelerated-dragon","white"],["Caro Kann","","white"],["Four-Knights","","white"],["Sicilian Defense","","white"],["French Defense","","black"]],Masters:[["Bobby Fischer 60 Memorable Games","",60],["Magnus Carlsen 2023",""],["Tata Steel 2023",""]],Tactics:[["50 Puzzles 1600","",50],["50 Puzzles 2000","",50],["50 Puzzles 2200","",50]],Endgames:[["100 Endgames You Must Know",""],["King and Pawn Endgames",""]]},u=class u{constructor(){o(this,"all");o(this,"openings");o(this,"masters");o(this,"tactics");o(this,"endgames");o(this,"recent");o(this,"completed");o(this,"imported")}delete_imported_study(e){let t=this.imported[0]();t=t.filter(n=>n.study_link!==e),this.imported[1](t);let[s,a]=p("","pgn.imported."+e);a(""),Object.entries(localStorage).map(n=>n[0]).filter(n=>n.includes(`.openings.id.${e}`)).map(n=>localStorage.removeItem(n))}save_import_pgn(e,t){this.delete_imported_study(e);let s="";s=y(t,e,s,"white",!0).name;let n=this.imported[0]();n.push({category:"openings",study_name:s,study_link:e,imported:!0}),this.imported[1](n);let[l,r]=p("","pgn.imported."+e);r(t)}imported_by_id(e){return this.imported[0]().find(s=>s.study_link===e)}study_by_id(e){return this.all.find(s=>s.study_link===e)}};o(u,"init",()=>{function e(s){return z[s].map(a=>({category:s,study_name:a[0],study_link:a[1],orientation:a[3]}))}let t=new u;return t.openings=e("Openings"),t.masters=e("Masters"),t.tactics=e("Tactics"),t.endgames=e("Endgames"),t.all=[...t.openings,...t.masters,...t.tactics,...t.endgames],t.recent=[],t.completed=[],t.imported=p([],"fixture.imported"),t});let g=u;const _=g.init();export{_ as R,E as S};
