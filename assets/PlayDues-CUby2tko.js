import{k as G,H as L,c as a,S as $,N as K,f as r,a as w,r as U,u as V,i,l as X,D as Z,I as ee,n as E,d as te,t as c,J as H,q as T,x as q,m as ne}from"./index-DlyBWq7Z.js";import{a as re,D as se}from"./types-DOHBv6lA.js";import{S as ae,C as oe}from"./Chessboard-DYxF8dUn.js";import{C as ie,a as ue}from"./ChessTreeWithTools-DA3Apeq_.js";import"./Chesstree2-RdS3rkX9.js";var le=c("<div class=repeat-dues>"),ce=c("<p>Completed All Due Moves."),_e=c("<div class=header><h3></h3><p></p><p> Due Moves"),de=c("<div class=board-wrap>"),he=c("<button>Hint: Show Previous Moves"),pe=c("<button>Show Answer"),me=c("<button>Next Due"),ve=c("<div class=info>"),ge=c("<div class=replay-wrap><div class=replay-header><div class=title><h3></h3><h4>"),fe=c("<span>Repeat Not Found");function we(t){return t[Math.floor(Math.random()*t.length)]}const Ne=()=>{let t=G();const d=parseInt(t.id),s=L(H),u=re(()=>s.repeat_by_id(d));return a($,{get when(){return u()},get fallback(){return a(Se,{})},children:n=>a($e,{get repeats(){return n()}})})},$e=t=>{const[d]=K(),s=r(()=>t.repeats),u=r(()=>new se(s())),n=r(()=>{switch(d.filter){case"white":return u().due_white;case"black":return u().due_black;case"first-ten":return u().due_10;case"ten-twenty":return u().due_10_20;case"twenty-plus":return u().due_20plus;default:return u().due}}),P=r(()=>{switch(d.filter){case"white":return"White Only";case"black":return"Black Only";case"first-ten":return"First 10 moves";case"ten-twenty":return"10-20 moves";case"twenty-plus":return"20+ moves";default:return"All moves"}}),S=r(()=>we(n())),[A,C]=w(void 0,{equals:!1});let l;return U(()=>{l.addEventListener("wheel",p=>{C(Math.sign(p.deltaY))},{passive:!0})}),(()=>{var p=le();return V(g=>l=g,p),i(p,a($,{get when(){return S()},get fallback(){return ce()},children:g=>[(()=>{var k=_e(),x=k.firstChild,b=x.nextSibling,D=b.nextSibling,f=D.firstChild;return i(x,()=>s().name),i(b,P),i(D,()=>n().length,f),k})(),a(be,{get on_wheel(){return A()},get repeats(){return s()},get due_move(){return g()}})]})),p})()},be=t=>{const[d]=X(()=>t.due_move.ucis[0].section.study_id,s=>ne.read_section_study(s));return a($,{get when(){return d()},children:s=>a(ye,{get on_wheel(){return t.on_wheel},get repeats(){return t.repeats},get due_move(){return t.due_move},get study(){return s()}})})},ye=t=>{const d=L(H),s=r(()=>t.study),u=r(()=>t.repeats),n=r(()=>t.due_move),P=r(()=>s().sections.find(e=>e.name===n().ucis[0].section.section_name)),S=r(()=>P().chapters.find(e=>e.name===n().ucis[0].section.chapter_name)),[A,C]=w(void 0),l=new ae;let[p,g]=w(void 0);const k=r(()=>Z(n()?.fen??ee));E(T(n,()=>{q(()=>{y(void 0),f([]),b(n().ucis[0].path.slice(0,-1))})}));const[x,b]=w(n().ucis[0].path.slice(0,-1),{equals:!1}),[D,f]=w([]);E(T(()=>l.add_uci,e=>{if(!e)return;const _=n();let[h,M]=e;const F=_.ucis.map(z=>z.uci);let v="✓",o="✗";const R=m();let N=v;F.includes(h)?(N=v,R||y("easy")):(N=o,R||y("again")),C(ue(h,M,N)),N===o?f(void 0):g(setTimeout(I,600))}));const O=([e,_])=>{l.on_set_fen_uci(e,_)},W=()=>{if(m()==="again")return!1;y("hard"),f(n().ucis[0].path)},B=()=>{y("again"),f(void 0),b(n().ucis[0].path)},[m,y]=w(void 0),I=()=>{const e=u().id,_=n().fen,h=m();!h||h==="hard"||q(()=>{C(void 0),d.play_due_move(e,_,h??"again"),g(void 0)})},J=r(()=>{const e=m();return!(!e||e==="hard")}),Q=r(()=>m()===void 0),Y=r(()=>m()!=="again"),j=r(()=>{let e=p(),_=m();return e===void 0&&_!=="again"});return[(()=>{var e=de();return i(e,a(oe,{get shapes(){return A()},get orientation(){return k()},get movable(){return j()},get doPromotion(){return l.promotion},get onMoveAfter(){return l.on_move_after},get fen_uci(){return l.fen_uci},get color(){return l.turnColor},get dests(){return l.dests}})),e})(),(()=>{var e=ge(),_=e.firstChild,h=_.firstChild,M=h.firstChild,F=M.nextSibling;return i(M,()=>s().name),i(F,()=>S().name),i(e,a(ie,{get hide_after_path(){return D()},get on_wheel(){return t.on_wheel},get pgn(){return S().pgn},on_fen_last_move:O,get cursor_path(){return x()},get children(){var v=ve();return i(v,a($,{get when(){return Q()},get children(){var o=he();return o.$$click=W,o}}),null),i(v,a($,{get when(){return Y()},get children(){var o=pe();return o.$$click=B,o}}),null),i(v,a($,{get when(){return J()},get children(){var o=me();return o.$$click=I,o}}),null),v}}),null),e})()]},Se=()=>fe();te(["click"]);export{Ne as default};
