var k=Object.defineProperty;var P=(i,t,e)=>t in i?k(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var o=(i,t,e)=>(P(i,typeof t!="symbol"?t+"":t,e),e);import{P as y}from"./chess_pgn_logic-CSduvwdL.js";import{y as p}from"./index-2OljWAtc.js";const S=(i,t,e,n)=>{let r=y.make_many(i).map(s=>{var m;let l=(m=s.site)!=null&&m.includes("http")?s.site:`https://lichess.org/study/${t}`,a=s.event,c;if(a!=null&&a.includes(": "))[e,c]=a.split(": ");else if(s.white!=="?"){let d=s.white,b=s.black;c=`${d} vs ${b} at ${a}`}else c=a;return{name:c,site:l,pgn:s}});return{id:t,name:e,orientation:n,chapters:r}},w=(i,t,e,n,r)=>{let s=[];return y.make_many(i).map(l=>{let a,c;l.section?(a=l.section,c=l.chapter):[e,a,c]=l.event.split(":");let m=s.find(d=>d.name===a);m||s.push(m={name:a,chapters:[]}),m==null||m.chapters.push({name:c,pgn:l})}),{id:t,name:e,orientation:n,imported:r,sections:s}},v=(i,t,e)=>fetch(`pgns/${i}.pgn`).then(n=>n.text()).then(n=>S(n,i,t,e)),D=(i,t,e)=>fetch(`pgns/${i}.section.pgn`).then(n=>n.text()).then(n=>w(n,i,t,e)),$=(i,t)=>{let[e]=p("","pgn.imported."+i);return w(e(),i,t,"white",!0)},u=class u{read_section_study(t){let{study_name:e,orientation:n,imported:r}=_.study_by_id(t)||_.imported_by_id(t);return r?$(t,e):D(t,e,n)}read_study(t){let{study_name:e,orientation:n}=_.study_by_id(t);return v(t,e,n)}};o(u,"init",()=>new u);let f=u;const E=f.init(),z={Openings:[["Berlin Defence","berlin","white"],["Slav Defense","slav","black"],["London System","london-system","black"],["Caro-Kann Defense","caro-kann","white"],["Petroff Defense","petroff","white"],["Philidor Defence","philidor","white"],["Accelerated Dragon","accelerated-dragon","white"],["Caro Kann","","white"],["Four-Knights","","white"],["Sicilian Defense","","white"],["French Defense","","black"]],Masters:[["Bobby Fischer 60 Memorable Games","",60],["Magnus Carlsen 2023",""],["Tata Steel 2023",""]],Tactics:[["50 Puzzles 1600","",50],["50 Puzzles 2000","",50],["50 Puzzles 2200","",50]],Endgames:[["100 Endgames You Must Know",""],["King and Pawn Endgames",""]]},h=class h{constructor(){o(this,"all");o(this,"openings");o(this,"masters");o(this,"tactics");o(this,"endgames");o(this,"recent");o(this,"completed");o(this,"imported")}delete_imported_study(t){let e=this.imported[0]();e=e.filter(s=>s.study_link!==t),this.imported[1](e);let[n,r]=p("","pgn.imported."+t);r(""),Object.entries(localStorage).map(s=>s[0]).filter(s=>s.includes(`.openings.id.${t}`)).map(s=>localStorage.removeItem(s))}save_import_pgn(t,e,n){let r=this.imported[0]();r.push({category:"openings",study_name:t,study_link:e,imported:!0}),this.imported[1](r);let[s,l]=p("","pgn.imported."+e);l(n)}imported_by_id(t){return this.imported[0]().find(n=>n.study_link===t)}study_by_id(t){return this.all.find(n=>n.study_link===t)}};o(h,"init",()=>{function t(n){return z[n].map(r=>({category:n,study_name:r[0],study_link:r[1],orientation:r[3]}))}let e=new h;return e.openings=t("Openings"),e.masters=t("Masters"),e.tactics=t("Tactics"),e.endgames=t("Endgames"),e.all=[...e.openings,...e.masters,...e.tactics,...e.endgames],e.recent=[],e.completed=[],e.imported=p([],"fixture.imported"),e});let g=h;const _=g.init();export{_ as R,E as S};
