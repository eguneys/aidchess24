import{c as o,a as W,H as U,f as a,l as V,i as t,S as K,R as ne,u as ie,F as j,A as ae,h as T,j as X,s as O,K as re,L as Q,b as ce,d as de,t as $,J as Y,m as oe}from"./index-De1ZCzHq.js";import{c as _e,D as ue}from"./types-D4Q6yEPP.js";var he=$("<div class=repeat-show>"),$e=$("<div class=show>"),ve=$('<div class=new-repeat><h3>Create a New Repeat</h3><input type=text placeholder="Repeat Name"><div class=study-list><h3>Studies</h3><div class=list></div></div><div class=section-list><h3>Sections</h3><div class=controls><button>Select All</button></div><div class=list></div></div><button class=save> Save '),pe=$("<div class=none>"),Z=$("<div>"),be=$("<p>Select a Study"),ge=$("<div class=section><input type=checkbox><label>"),me=$("<div class=dialog><div class=overlay></div><div class=content>"),fe=$("<div class=list-wrap><h3>Repeats</h3><div class=list></div><button>Create a New Repeat"),Se=$("<div class=show><h2></h2><div class=content><div class=sections-wrap><h3>Sections</h3><div class=sections></div></div><div class=info><small>Total Positions: </small><p>Total Due: </p><div class=buttons><button>Play Due White <span></span></button><button>Play Due Black <span></span></button><button>Play Due First 10 moves<span></span></button><button>Play Due 10-20 moves <span></span></button><button>Play Due 20+ moves <span></span></button><button>Play All Due <span></span></button></div></div></div><a class=delete>Delete Repeat"),xe=$("<div class=section>");const Ae=()=>o(ye,{}),ye=()=>{const[i,s]=W(!1),e=()=>{s(!0)},l=U(Y),r=_e(()=>l.get_light_repeats()),[_,f]=W(0),c=a(()=>r[_()]),[v]=V(()=>c(),d=>l.get_repeat_with_moves_by_light(d)),p=()=>{const d=c();d&&l.remove_repeat(d.name)};return(()=>{var d=he();return t(d,o(Re,{repeats:r,set_i_selected_repeat:f,get i_selected_repeat(){return _()},on_open_create_repeat:e}),null),t(d,o(K,{get when(){return v()},get fallback(){return $e()},children:b=>o(De,{on_delete:p,get repeat(){return b()},on_open_create_repeat:e})}),null),t(d,o(K,{get when(){return i()},get children(){return o(ke,{onClose:()=>{s(!1)}})}}),null),d})()};class Ce{sections=[];add_section(s,e){this.sections=this.sections.filter(l=>!(l.study_id===s&&l.section_name===e)),this.sections.push({study_id:s,section_name:e})}remove_section(s,e){this.sections=this.sections.filter(l=>!(l.study_id===s&&l.section_name===e))}has(s,e){return!!this.sections.find(l=>l.study_id===s&&l.section_name===e)}}const ke=i=>{const s=a(ne.imported[0]),[e,l]=W(0),r=a(()=>s()[e()]),_=a(()=>r()?.study_id),[f]=V(()=>r()?.study_id,n=>oe.read_section_study(n)),c=new Ce,v=(n,x)=>{x?(c.add_section(_(),n),p.value===""&&(p.value=n)):(c.remove_section(_(),n),p.value===n&&(p.value=""))};let p;const d=()=>p.value,[b,S]=W(void 0,{equals:!1}),y=()=>{f()?.sections.map(n=>n.name).forEach(n=>c.add_section(_(),n)),S()},N=n=>(b(),c.has(_(),n)),A=U(Y),q=()=>{let n=d();if(!n||n.length<3)return;let x={id:-1,name:n,sections:c.sections};A.add_repeat(x),i.onClose()};return o(we,{get onClose(){return i.onClose},get children(){var n=ve(),x=n.firstChild,C=x.nextSibling,k=C.nextSibling,B=k.firstChild,D=B.nextSibling,E=k.nextSibling,H=E.firstChild,w=H.nextSibling,I=w.firstChild,J=w.nextSibling,P=E.nextSibling;return ie(g=>p=g,C),t(D,o(j,{get each(){return s()},get fallback(){return(()=>{var g=pe();return t(g,o(ae,{href:"/repertoires",children:"Import some studies first"})),g})()},children:(g,m)=>(()=>{var u=Z();return u.$$click=()=>l(m()),t(u,()=>g.study_name),T(()=>X(u,e()===m()?"study active":"study")),u})()})),I.$$click=()=>y(),t(J,o(K,{get when(){return f()},children:g=>o(j,{get each(){return g().sections},get fallback(){return be()},children:m=>(()=>{var u=ge(),R=u.firstChild,F=R.nextSibling;return R.addEventListener("change",h=>v(m.name,h.target.checked)),t(F,()=>m.name),T(h=>{var L=m.name,M=m.name;return L!==h.e&&O(R,"id",h.e=L),M!==h.t&&O(F,"for",h.t=M),h},{e:void 0,t:void 0}),T(()=>R.checked=N(m.name)),u})()})})),P.$$click=q,n}})},we=i=>{const s=re(()=>i.children);return(()=>{var e=me(),l=e.firstChild,r=l.nextSibling;return Q(l,"click",i.onClose,!0),t(r,s),e})()},Re=i=>{const s=a(()=>i.repeats);return(()=>{var e=fe(),l=e.firstChild,r=l.nextSibling,_=r.nextSibling;return t(r,o(j,{get each(){return s()},children:(f,c)=>(()=>{var v=Z();return v.$$click=()=>i.set_i_selected_repeat(c()),t(v,()=>f.name),T(()=>X(v,"repeat"+(c()===i.i_selected_repeat?" active":""))),v})()})),Q(_,"click",i.on_open_create_repeat,!0),e})()},De=i=>{const s=a(()=>i.repeat),e=a(()=>new ue(s())),l=a(()=>e().total.length),r=a(()=>e().due.length),_=a(()=>e().due_white.length),f=a(()=>e().due_black.length),c=a(()=>e().due_10.length),v=a(()=>e().due_10_20.length),p=a(()=>e().due_20plus.length),d=ce(),b=S=>{let y=s().id;d("/repeat/"+y+(S?`?filter=${S}`:""))};return(()=>{var S=Se(),y=S.firstChild,N=y.nextSibling,A=N.firstChild,q=A.firstChild,n=q.nextSibling,x=A.nextSibling,C=x.firstChild;C.firstChild;var k=C.nextSibling;k.firstChild;var B=k.nextSibling,D=B.firstChild,E=D.firstChild,H=E.nextSibling,w=D.nextSibling,I=w.firstChild,J=I.nextSibling,P=w.nextSibling,g=P.firstChild,m=g.nextSibling,u=P.nextSibling,R=u.firstChild,F=R.nextSibling,h=u.nextSibling,L=h.firstChild,M=L.nextSibling,z=h.nextSibling,ee=z.firstChild,te=ee.nextSibling,se=N.nextSibling;return t(y,()=>s().name),t(n,o(j,{get each(){return s().sections},children:le=>(()=>{var G=xe();return t(G,()=>le.section_name),G})()})),t(C,l,null),t(k,r,null),D.$$click=()=>b("white"),t(H,_),w.$$click=()=>b("black"),t(J,f),P.$$click=()=>b("first-ten"),t(m,c),u.$$click=()=>b("ten-twenty"),t(F,v),h.$$click=()=>b("twenty-plus"),t(M,p),z.$$click=()=>b(),t(te,r),Q(se,"click",i.on_delete,!0),S})()};de(["click"]);export{Ae as default};
