import{k as N,K as C,c as _,S as A,f as u,a as E,D as F,I as R,n as b,i as S,d as L,t as x,L as D,q as $,x as w}from"./index-D0kh0AZe.js";import{a as P}from"./solid-dexie-B1gXUA1y.js";import{S as q,C as K}from"./Chessboard-CS0QBQgb.js";import{a as Q}from"./annotationShapes-BCiyzDdu.js";var j=x("<div class=repeat-dues><div class=board-wrap></div><div class=info><h3> Due Moves</h3><button>Show Answer"),z=x("<span>Repeat Not Found");function B(s){return s[Math.floor(Math.random()*s.length)]}const W=()=>{let s=N();const d=parseInt(s.id),l=C(D),c=P(()=>l.repeat_by_id(d));return _(A,{get when(){return c()},get fallback(){return _(H,{})},children:a=>_(G,{get repeats(){return a()}})})},G=s=>{const d=C(D),l=u(()=>s.repeats),c=u(()=>l().moves.filter(e=>e.due.getTime()<=new Date().getTime())),a=u(()=>B(c())),[h,f]=E(void 0),t=new q;let i;const y=u(()=>F(a()?.fen??R)),I=u(()=>i===void 0&&h()===void 0);b($(a,e=>{e&&t.on_set_fen_uci(e.fen)})),b($(()=>t.add_uci,e=>{if(!e)return;const n=a();if(!n)return;let[o,r]=e;const p=l().id,m=n.fen,T=n.ucis;let g="✓",k="✗",v=g;T.includes(o)?v=g:v=k,f(Q(o,r,v)),i=setTimeout(()=>{w(()=>{f(void 0),d.play_due_move(p,m,o)}),i=void 0},600)}));const M=()=>{if(i!==void 0)return;let e=a();if(!e)return;let n=l().id,o=e.fen,r=e.ucis[e.ucis.length-1];t.on_play_uci(r),i=setTimeout(()=>{w(()=>{f(void 0),d.play_due_move(n,o,"")}),i=void 0},600)};return(()=>{var e=j(),n=e.firstChild,o=n.nextSibling,r=o.firstChild,p=r.firstChild,m=r.nextSibling;return S(n,_(K,{get shapes(){return h()},get orientation(){return y()},get movable(){return I()},get doPromotion(){return t.promotion},get onMoveAfter(){return t.on_move_after},get fen_uci(){return t.fen_uci},get color(){return t.turnColor},get dests(){return t.dests}})),S(r,()=>c().length,p),m.$$click=M,e})()},H=()=>z();L(["click"]);export{W as default};
