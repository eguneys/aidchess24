import{l as X,u as q,c as s,S as g,g as t,H as Z,q as T,i as c,m as ee,a as f,D as te,I as ne,n as F,r as re,b as se,d as ae,t as l,R as L,x as R}from"./index-B1vCCvLd.js";import{S as oe,C as ie}from"./Chessboard-Dy715VMy.js";import{C as le,a as ue}from"./ChessTreeWithTools-DJiDo-ZH.js";import{c as ce,P as _e,D as de}from"./Show2-BjwzWmiH.js";import"./Chesstree2-5bg2wnQx.js";var he=l("<div class=repeat-dues>"),me=l("<p>Completed All Due Moves."),ge=l("<div class=header><h3></h3><p></p><p> Due Moves"),fe=l("<div class=board-wrap>"),ve=l("<div class=info>"),pe=l("<div class=replay-wrap><div class=replay-header><div class=title><h3></h3><h4>"),we=l("<button>Hint: Show Previous Moves"),be=l("<button>Show Answer"),$e=l("<button>Next Due"),ye=l("<p> Study Not Found ");function Ce(r){return r[Math.floor(Math.random()*r.length)]}const Ne=()=>{let r=X();const _=parseInt(r.id),u=q(L),n=ce(()=>u.get_study_by_id(_));return s(g,{get when(){return n()},get fallback(){return s(O,{})},children:d=>s(Se,{get study(){return d()}})})},Se=r=>{const _=t(()=>r.study),[u]=Z(),n=t(()=>_e(r.study.id)),d=t(()=>n()[0]());let h=t(T(d,a=>de(a)));const v=t(()=>{switch(u.filter){case"white":return h().due_white;case"black":return h().due_black;case"first-ten":return h().due_10;case"ten-twenty":return h().due_10_20;case"twenty-plus":return h().due_20plus;default:return h().due}}),P=t(()=>{switch(u.filter){case"white":return"White Only";case"black":return"Black Only";case"first-ten":return"First 10 moves";case"ten-twenty":return"10-20 moves";case"twenty-plus":return"20+ moves";default:return"All moves"}}),C=t(()=>Ce(v()));return(()=>{var a=he();return c(a,s(g,{get when(){return C()},get fallback(){return me()},children:S=>[(()=>{var p=ge(),k=p.firstChild,x=k.nextSibling,w=x.nextSibling,A=w.firstChild;return c(k,()=>_().name),c(x,P),c(w,()=>v().length,A),p})(),s(ke,{get study(){return _()},get due_move(){return S()}})]})),a})()},ke=r=>{const _=q(L),[u]=ee(()=>r.study.id,n=>_.get_study_imported_by_id(n));return s(g,{get when(){return u()},get fallback(){return s(O,{})},children:n=>s(xe,{get on_wheel(){return r.on_wheel},get due_move(){return r.due_move},get study(){return n()}})})},xe=r=>{const _=q(L),u=t(()=>r.study),n=t(()=>r.due_move),d=t(()=>n().moves[0].data.path),h=t(()=>u().sections.find(e=>e.name===n().section.name)),v=t(()=>h().chapters.find(e=>e.name===n().moves[0].chapter.name)),[P,C]=f(void 0),a=new oe;let[S,p]=f(void 0);const k=t(()=>te(n()?.before_fen??ne));F(()=>{a.on_set_fen_uci(n().before_fen)}),F(T(n,()=>{R(()=>{b(void 0),D([]),w(d().slice(0,-1))})}));const[x,w]=f(d().slice(0,-1),{equals:!1}),[A,D]=f([]);F(T(()=>a.add_uci,e=>{if(!e)return;const o=n();let[I,$]=e;const N=o.moves.map(V=>V.data.san);let y="✓",i="✗";const E=m();let M=y;N.includes($)?(M=y,E||b("easy")):(M=i,(!E||E==="hard")&&b("again")),C(ue(I,$,M)),M===i?D(void 0):p(setTimeout(B,600))}));const W=([e,o])=>{a.on_set_fen_uci(e,o)},Q=()=>{if(m()==="again")return!1;b("hard"),D(d())},Y=()=>{R(()=>{b("again"),D(void 0),w(d())})},[m,b]=f(void 0),B=()=>{const e=n().before_fen,o=m();R(()=>{C(void 0),_.play_due_move(e,o??"again"),p(void 0)})},j=t(()=>{const e=m();return!(!e||e==="hard")}),z=t(()=>m()===void 0),G=t(()=>m()!=="again"),J=t(()=>{let e=S(),o=m();return e===void 0&&o!=="again"}),[K,U]=f(void 0,{equals:!1});let H;return re(()=>{H.addEventListener("wheel",e=>{U(Math.sign(e.deltaY))},{passive:!0})}),[(()=>{var e=fe();return se(o=>H=o,e),c(e,s(ie,{get shapes(){return P()},get orientation(){return k()},get movable(){return J()},get doPromotion(){return a.promotion},get onMoveAfter(){return a.on_move_after},get fen_uci(){return a.fen_uci},get color(){return a.turnColor},get dests(){return a.dests}})),e})(),(()=>{var e=pe(),o=e.firstChild,I=o.firstChild,$=I.firstChild,N=$.nextSibling;return c($,()=>u().name),c(N,()=>v().name),c(e,s(le,{get hide_after_path(){return A()},get on_wheel(){return K()},get pgn(){return v().pgn},on_fen_last_move:W,get cursor_path(){return x()},get children(){var y=ve();return c(y,s(g,{get when(){return S()},get fallback(){return[s(g,{get when(){return z()},get children(){var i=we();return i.$$click=Q,i}}),s(g,{get when(){return G()},get children(){var i=be();return i.$$click=Y,i}}),s(g,{get when(){return j()},get children(){var i=$e();return i.$$click=B,i}})]},get children(){return[]}})),y}}),null),e})()]},O=()=>ye();ae(["click"]);export{Ne as default};
