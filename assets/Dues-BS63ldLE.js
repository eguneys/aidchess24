import{k as E,K as D,c as _,S as F,f as l,a as S,D as R,I as L,n as $,i as w,d as P,t as y,L as I,q as C,x}from"./index-SvTvHK8i.js";import{a as q}from"./solid-dexie-B8ppFaRP.js";import{S as K,C as Q}from"./Chessboard-NFMdzZ6P.js";import{a as j}from"./annotationShapes-BqCM9tpQ.js";var z=y("<div class=repeat-dues><div class=board-wrap></div><div class=info><h3> Due Moves</h3><button>Show Answer"),B=y("<span>Repeat Not Found");function G(s){return s[Math.floor(Math.random()*s.length)]}const X=()=>{let s=E();const u=parseInt(s.id),i=D(I),d=q(()=>i.repeat_by_id(u));return _(F,{get when(){return d()},get fallback(){return _(J,{})},children:a=>_(H,{get repeats(){return a()}})})},H=s=>{const u=D(I),i=l(()=>s.repeats),d=l(()=>i().moves.filter(e=>e.due.getTime()<=new Date().getTime())),a=l(()=>G(d())),[h,f]=S(void 0),n=new K;let[g,c]=S(void 0);const M=l(()=>R(a()?.fen??L)),T=l(()=>{let e=g(),t=h();return e!==void 0&&t!==void 0});$(C(a,e=>{e&&n.on_set_fen_uci(e.fen)})),$(C(()=>n.add_uci,e=>{if(!e)return;const t=a();if(!t)return;let[r,o]=e;const p=i().id,m=t.fen,N=t.ucis;let b="✓",A="✗",v=b;N.includes(r)?v=b:v=A,f(j(r,o,v)),c(setTimeout(()=>{x(()=>{f(void 0),u.play_due_move(p,m,r),c(void 0)})},600))}));const k=()=>{if(g()!==void 0)return;let e=a();if(!e)return;let t=i().id,r=e.fen,o=e.ucis[e.ucis.length-1];n.on_play_uci(o),c(setTimeout(()=>{x(()=>{f(void 0),u.play_due_move(t,r,""),c(void 0)})},600))};return(()=>{var e=z(),t=e.firstChild,r=t.nextSibling,o=r.firstChild,p=o.firstChild,m=o.nextSibling;return w(t,_(Q,{get shapes(){return h()},get orientation(){return M()},get movable(){return T()},get doPromotion(){return n.promotion},get onMoveAfter(){return n.on_move_after},get fen_uci(){return n.fen_uci},get color(){return n.turnColor},get dests(){return n.dests}})),w(o,()=>d().length,p),m.$$click=k,e})()},J=()=>B();P(["click"]);export{X as default};
