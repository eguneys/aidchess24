const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Home-cu90zK64.js","./Home-BLMJkKn9.css","./Repertoires-Df534WIS.js","./Repertoires-DWvCi8rB.css","./Contact-JLyDr-a8.js","./Contact-CZAgTrI1.css","./Repertoire-BgySM0k5.js","./Chessboard-BALN8MJ7.js","./Chessboard-BcbhaTgn.css","./Chesstree2-CKGTZ7m2.js","./Chesstree2-hnAkSfi1.css","./SessionStore-B3vK9VyL.js","./scroll-DnAhRpRC.js","./annotationShapes-BBmIaIoK.js","./Repertoire-BXenQugU.css","./Repertoire-DQkaKCJ0.css","./Masters-BPjtha3X.js","./Repertoire-BwdbYVG2.css","./Tactics-Sue91Onm.js","./Endgames-CFTGTknd.js","./Dashboard-o35f0tNZ.js","./Dashboard-DFMve4ou.css","./Explorer-oKncb6Bc.js","./Explorer-7UPtkKX5.css","./Challenges-DTa4Prfo.js","./Challenges-d6-F_Iqx.css","./Widen-BwXa_oxk.js","./Widen-YoxJCWfM.css","./SixthDraw-CvsitdiI.js","./SixthDraw-BTc45pjQ.css","./Beta-CfUl9bID.js","./Beta-C7YtZcI6.css","./Show-Co6K_oNu.js","./types-DqmV88Zc.js","./Show-feBwHTo8.css","./Dues-m7rhSnPJ.js","./Dues-m3qB_tgM.css"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function n(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(o){if(o.ep)return;o.ep=!0;const a=n(o);fetch(o.href,a)}})();const te={context:void 0,registry:void 0,effects:void 0,done:!1,getContextId(){return io(this.context.count)},getNextContextId(){return io(this.context.count++)}};function io(t){const e=String(t),n=e.length-1;return te.context.id+(n?String.fromCharCode(96+n):"")+e}function $n(t){te.context=t}const nu=(t,e)=>t===e,rt=Symbol("solid-proxy"),Ko=typeof Proxy=="function",zi=Symbol("solid-track"),Mr={equals:nu};let Fn=null,jo=zo;const lt=1,Dr=2,Bo={owned:null,cleanups:null,context:null,owner:null},Mi={};var ue=null;let Di=null,ru=null,me=null,$e=null,nt=null,Fr=0;function Un(t,e){const n=me,i=ue,o=t.length===0,a=e===void 0?i:e,l=o?Bo:{owned:null,cleanups:null,context:a?a.context:null,owner:a},f=o?t:()=>t(()=>Pe(()=>Vn(l)));ue=l,me=null;try{return ct(f,!0)}finally{me=n,ue=i}}function Ke(t,e){e=e?Object.assign({},Mr,e):Mr;const n={value:t,observers:null,observerSlots:null,comparator:e.equals||void 0},i=o=>(typeof o=="function"&&(o=o(n.value)),Uo(n,o));return[Fo.bind(n),i]}function so(t,e,n){const i=Jn(t,e,!0,lt);wn(i)}function ut(t,e,n){const i=Jn(t,e,!1,lt);wn(i)}function iu(t,e,n){jo=hu;const i=Jn(t,e,!1,lt);i.user=!0,nt?nt.push(i):wn(i)}function ge(t,e,n){n=n?Object.assign({},Mr,n):Mr;const i=Jn(t,e,!0,0);return i.observers=null,i.observerSlots=null,i.comparator=n.equals||void 0,wn(i),Fo.bind(i)}function su(t){return t&&typeof t=="object"&&"then"in t}function ou(t,e,n){let i,o,a;arguments.length===2&&typeof e=="object"||arguments.length===1?(i=!0,o=t,a=e||{}):(i=t,o=e,a={});let l=null,f=Mi,p=null,g=!1,w="initialValue"in a,S=typeof i=="function"&&ge(i);const D=new Set,[I,V]=(a.storage||Ke)(a.initialValue),[L,H]=Ke(void 0),[Y,W]=Ke(void 0,{equals:!1}),[fe,oe]=Ke(w?"ready":"unresolved");te.context&&(p=te.getNextContextId(),a.ssrLoadFrom==="initial"?f=a.initialValue:te.load&&te.has(p)&&(f=te.load(p)));function pe(ve,ke,xe,Ge){return l===ve&&(l=null,Ge!==void 0&&(w=!0),(ve===f||ke===f)&&a.onHydrated&&queueMicrotask(()=>a.onHydrated(Ge,{value:ke})),f=Mi,_e(ke,xe)),ke}function _e(ve,ke){ct(()=>{ke===void 0&&V(()=>ve),oe(ke!==void 0?"errored":w?"ready":"unresolved"),H(ke);for(const xe of D.keys())xe.decrement();D.clear()},!1)}function Ae(){const ve=cu,ke=I(),xe=L();if(xe!==void 0&&!l)throw xe;return me&&!me.user&&ve&&so(()=>{Y(),l&&(ve.resolved||D.has(ve)||(ve.increment(),D.add(ve)))}),ke}function Xe(ve=!0){if(ve!==!1&&g)return;g=!1;const ke=S?S():i;if(ke==null||ke===!1){pe(l,Pe(I));return}const xe=f!==Mi?f:Pe(()=>o(ke,{value:I(),refetching:ve}));return su(xe)?(l=xe,"value"in xe?(xe.status==="success"?pe(l,xe.value,void 0,ke):pe(l,void 0,Gi(xe.value),ke),xe):(g=!0,queueMicrotask(()=>g=!1),ct(()=>{oe(w?"refreshing":"pending"),W()},!1),xe.then(Ge=>pe(xe,Ge,void 0,ke),Ge=>pe(xe,void 0,Gi(Ge),ke)))):(pe(l,xe,void 0,ke),xe)}return Object.defineProperties(Ae,{state:{get:()=>fe()},error:{get:()=>L()},loading:{get(){const ve=fe();return ve==="pending"||ve==="refreshing"}},latest:{get(){if(!w)return Ae();const ve=L();if(ve&&!l)throw ve;return I()}}}),S?so(()=>Xe(!1)):Xe(!1),[Ae,{refetch:Xe,mutate:V}]}function Lo(t){return ct(t,!1)}function Pe(t){if(me===null)return t();const e=me;me=null;try{return t()}finally{me=e}}function fs(t,e,n){const i=Array.isArray(t);let o,a=n&&n.defer;return l=>{let f;if(i){f=Array(t.length);for(let g=0;g<t.length;g++)f[g]=t[g]()}else f=t();if(a)return a=!1,l;const p=Pe(()=>e(f,o,l));return o=f,p}}function Sf(t){iu(()=>Pe(t))}function zt(t){return ue===null||(ue.cleanups===null?ue.cleanups=[t]:ue.cleanups.push(t)),t}function au(t,e){Fn||(Fn=Symbol("error")),ue=Jn(void 0,void 0,!0),ue.context={...ue.context,[Fn]:[e]};try{return t()}catch(n){Zn(n)}finally{ue=ue.owner}}function Vi(){return me}function $o(){return ue}function qo(t,e){const n=ue,i=me;ue=t,me=null;try{return ct(e,!0)}catch(o){Zn(o)}finally{ue=n,me=i}}function uu(t){const e=me,n=ue;return Promise.resolve().then(()=>{me=e,ue=n;let i;return ct(t,!1),me=ue=null,i?i.done:void 0})}function Xn(t,e){const n=Symbol("context");return{id:n,Provider:du(n),defaultValue:t}}function Ur(t){let e;return ue&&ue.context&&(e=ue.context[t.id])!==void 0?e:t.defaultValue}function zr(t){const e=ge(t),n=ge(()=>Hi(e()));return n.toArray=()=>{const i=n();return Array.isArray(i)?i:i!=null?[i]:[]},n}let cu;function Fo(){if(this.sources&&this.state)if(this.state===lt)wn(this);else{const t=$e;$e=null,ct(()=>Kr(this),!1),$e=t}if(me){const t=this.observers?this.observers.length:0;me.sources?(me.sources.push(this),me.sourceSlots.push(t)):(me.sources=[this],me.sourceSlots=[t]),this.observers?(this.observers.push(me),this.observerSlots.push(me.sources.length-1)):(this.observers=[me],this.observerSlots=[me.sources.length-1])}return this.value}function Uo(t,e,n){let i=t.value;return(!t.comparator||!t.comparator(i,e))&&(t.value=e,t.observers&&t.observers.length&&ct(()=>{for(let o=0;o<t.observers.length;o+=1){const a=t.observers[o],l=Di&&Di.running;l&&Di.disposed.has(a),(l?!a.tState:!a.state)&&(a.pure?$e.push(a):nt.push(a),a.observers&&Vo(a)),l||(a.state=lt)}if($e.length>1e6)throw $e=[],new Error},!1)),e}function wn(t){if(!t.fn)return;Vn(t);const e=Fr;lu(t,t.value,e)}function lu(t,e,n){let i;const o=ue,a=me;me=ue=t;try{i=t.fn(e)}catch(l){return t.pure&&(t.state=lt,t.owned&&t.owned.forEach(Vn),t.owned=null),t.updatedAt=n+1,Zn(l)}finally{me=a,ue=o}(!t.updatedAt||t.updatedAt<=n)&&(t.updatedAt!=null&&"observers"in t?Uo(t,i):t.value=i,t.updatedAt=n)}function Jn(t,e,n,i=lt,o){const a={fn:t,state:i,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:ue,context:ue?ue.context:null,pure:n};return ue===null||ue!==Bo&&(ue.owned?ue.owned.push(a):ue.owned=[a]),a}function Ir(t){if(t.state===0)return;if(t.state===Dr)return Kr(t);if(t.suspense&&Pe(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<Fr);)t.state&&e.push(t);for(let n=e.length-1;n>=0;n--)if(t=e[n],t.state===lt)wn(t);else if(t.state===Dr){const i=$e;$e=null,ct(()=>Kr(t,e[0]),!1),$e=i}}function ct(t,e){if($e)return t();let n=!1;e||($e=[]),nt?n=!0:nt=[],Fr++;try{const i=t();return fu(n),i}catch(i){n||(nt=null),$e=null,Zn(i)}}function fu(t){if($e&&(zo($e),$e=null),t)return;const e=nt;nt=null,e.length&&ct(()=>jo(e),!1)}function zo(t){for(let e=0;e<t.length;e++)Ir(t[e])}function hu(t){let e,n=0;for(e=0;e<t.length;e++){const i=t[e];i.user?t[n++]=i:Ir(i)}if(te.context){if(te.count){te.effects||(te.effects=[]),te.effects.push(...t.slice(0,n));return}$n()}for(te.effects&&(te.done||!te.count)&&(t=[...te.effects,...t],n+=te.effects.length,delete te.effects),e=0;e<n;e++)Ir(t[e])}function Kr(t,e){t.state=0;for(let n=0;n<t.sources.length;n+=1){const i=t.sources[n];if(i.sources){const o=i.state;o===lt?i!==e&&(!i.updatedAt||i.updatedAt<Fr)&&Ir(i):o===Dr&&Kr(i,e)}}}function Vo(t){for(let e=0;e<t.observers.length;e+=1){const n=t.observers[e];n.state||(n.state=Dr,n.pure?$e.push(n):nt.push(n),n.observers&&Vo(n))}}function Vn(t){let e;if(t.sources)for(;t.sources.length;){const n=t.sources.pop(),i=t.sourceSlots.pop(),o=n.observers;if(o&&o.length){const a=o.pop(),l=n.observerSlots.pop();i<o.length&&(a.sourceSlots[l]=i,o[i]=a,n.observerSlots[i]=l)}}if(t.tOwned){for(e=t.tOwned.length-1;e>=0;e--)Vn(t.tOwned[e]);delete t.tOwned}if(t.owned){for(e=t.owned.length-1;e>=0;e--)Vn(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0}function Gi(t){return t instanceof Error?t:new Error(typeof t=="string"?t:"Unknown error",{cause:t})}function oo(t,e,n){try{for(const i of e)i(t)}catch(i){Zn(i,n&&n.owner||null)}}function Zn(t,e=ue){const n=Fn&&e&&e.context&&e.context[Fn],i=Gi(t);if(!n)throw i;nt?nt.push({fn(){oo(i,n,e)},state:lt}):oo(i,n,e)}function Hi(t){if(typeof t=="function"&&!t.length)return Hi(t());if(Array.isArray(t)){const e=[];for(let n=0;n<t.length;n++){const i=Hi(t[n]);Array.isArray(i)?e.push.apply(e,i):e.push(i)}return e}return t}function du(t,e){return function(i){let o;return ut(()=>o=Pe(()=>(ue.context={...ue.context,[t]:i.value},zr(()=>i.children))),void 0),o}}function Cf(t){const[e,n]=Ke(void 0,{equals:!1});if("subscribe"in t){const i=t.subscribe(o=>n(()=>o));zt(()=>"unsubscribe"in i?i.unsubscribe():i())}else{const i=t(n);zt(i)}return e}const pu=Symbol("fallback");function ao(t){for(let e=0;e<t.length;e++)t[e]()}function mu(t,e,n={}){let i=[],o=[],a=[],l=0,f=e.length>1?[]:null;return zt(()=>ao(a)),()=>{let p=t()||[],g=p.length,w,S;return p[zi],Pe(()=>{let I,V,L,H,Y,W,fe,oe,pe;if(g===0)l!==0&&(ao(a),a=[],i=[],o=[],l=0,f&&(f=[])),n.fallback&&(i=[pu],o[0]=Un(_e=>(a[0]=_e,n.fallback())),l=1);else if(l===0){for(o=new Array(g),S=0;S<g;S++)i[S]=p[S],o[S]=Un(D);l=g}else{for(L=new Array(g),H=new Array(g),f&&(Y=new Array(g)),W=0,fe=Math.min(l,g);W<fe&&i[W]===p[W];W++);for(fe=l-1,oe=g-1;fe>=W&&oe>=W&&i[fe]===p[oe];fe--,oe--)L[oe]=o[fe],H[oe]=a[fe],f&&(Y[oe]=f[fe]);for(I=new Map,V=new Array(oe+1),S=oe;S>=W;S--)pe=p[S],w=I.get(pe),V[S]=w===void 0?-1:w,I.set(pe,S);for(w=W;w<=fe;w++)pe=i[w],S=I.get(pe),S!==void 0&&S!==-1?(L[S]=o[w],H[S]=a[w],f&&(Y[S]=f[w]),S=V[S],I.set(pe,S)):a[w]();for(S=W;S<g;S++)S in L?(o[S]=L[S],a[S]=H[S],f&&(f[S]=Y[S],f[S](S))):o[S]=Un(D);o=o.slice(0,l=g),i=p.slice(0)}return o});function D(I){if(a[S]=I,f){const[V,L]=Ke(S);return f[S]=L,e(p[S],V)}return e(p[S])}}}function J(t,e){return Pe(()=>t(e||{}))}function Rr(){return!0}const Wi={get(t,e,n){return e===rt?n:t.get(e)},has(t,e){return e===rt?!0:t.has(e)},set:Rr,deleteProperty:Rr,getOwnPropertyDescriptor(t,e){return{configurable:!0,enumerable:!0,get(){return t.get(e)},set:Rr,deleteProperty:Rr}},ownKeys(t){return t.keys()}};function Ii(t){return(t=typeof t=="function"?t():t)?t:{}}function yu(){for(let t=0,e=this.length;t<e;++t){const n=this[t]();if(n!==void 0)return n}}function Qi(...t){let e=!1;for(let l=0;l<t.length;l++){const f=t[l];e=e||!!f&&rt in f,t[l]=typeof f=="function"?(e=!0,ge(f)):f}if(Ko&&e)return new Proxy({get(l){for(let f=t.length-1;f>=0;f--){const p=Ii(t[f])[l];if(p!==void 0)return p}},has(l){for(let f=t.length-1;f>=0;f--)if(l in Ii(t[f]))return!0;return!1},keys(){const l=[];for(let f=0;f<t.length;f++)l.push(...Object.keys(Ii(t[f])));return[...new Set(l)]}},Wi);const n={},i=Object.create(null);for(let l=t.length-1;l>=0;l--){const f=t[l];if(!f)continue;const p=Object.getOwnPropertyNames(f);for(let g=p.length-1;g>=0;g--){const w=p[g];if(w==="__proto__"||w==="constructor")continue;const S=Object.getOwnPropertyDescriptor(f,w);if(!i[w])i[w]=S.get?{enumerable:!0,configurable:!0,get:yu.bind(n[w]=[S.get.bind(f)])}:S.value!==void 0?S:void 0;else{const D=n[w];D&&(S.get?D.push(S.get.bind(f)):S.value!==void 0&&D.push(()=>S.value))}}}const o={},a=Object.keys(i);for(let l=a.length-1;l>=0;l--){const f=a[l],p=i[f];p&&p.get?Object.defineProperty(o,f,p):o[f]=p?p.value:void 0}return o}function gu(t,...e){if(Ko&&rt in t){const o=new Set(e.length>1?e.flat():e[0]),a=e.map(l=>new Proxy({get(f){return l.includes(f)?t[f]:void 0},has(f){return l.includes(f)&&f in t},keys(){return l.filter(f=>f in t)}},Wi));return a.push(new Proxy({get(l){return o.has(l)?void 0:t[l]},has(l){return o.has(l)?!1:l in t},keys(){return Object.keys(t).filter(l=>!o.has(l))}},Wi)),a}const n={},i=e.map(()=>({}));for(const o of Object.getOwnPropertyNames(t)){const a=Object.getOwnPropertyDescriptor(t,o),l=!a.get&&!a.set&&a.enumerable&&a.writable&&a.configurable;let f=!1,p=0;for(const g of e)g.includes(o)&&(f=!0,l?i[p][o]=a.value:Object.defineProperty(i[p],o,a)),++p;f||(l?n[o]=a.value:Object.defineProperty(n,o,a))}return[...i,n]}function ze(t){let e,n;const i=o=>{const a=te.context;if(a){const[f,p]=Ke();te.count||(te.count=0),te.count++,(n||(n=t())).then(g=>{!te.done&&$n(a),te.count--,p(()=>g.default),$n()}),e=f}else if(!e){const[f]=ou(()=>(n||(n=t())).then(p=>p.default));e=f}let l;return ge(()=>(l=e())?Pe(()=>{if(!a||te.done)return l(o);const f=te.context;$n(a);const p=l(o);return $n(f),p}):"")};return i.preload=()=>n||((n=t()).then(o=>e=()=>o.default),n),i}let vu=0;function bu(){return te.context?te.getNextContextId():`cl-${vu++}`}const Go=t=>`Stale read from <${t}>.`;function Rf(t){const e="fallback"in t&&{fallback:()=>t.fallback};return ge(mu(()=>t.each,t.children,e||void 0))}function Ho(t){const e=t.keyed,n=ge(()=>t.when,void 0,{equals:(i,o)=>e?i===o:!i==!o});return ge(()=>{const i=n();if(i){const o=t.children;return typeof o=="function"&&o.length>0?Pe(()=>o(e?i:()=>{if(!Pe(n))throw Go("Show");return t.when})):o}return t.fallback},void 0,void 0)}function Tf(t){let e=!1;const n=(a,l)=>(e?a[1]===l[1]:!a[1]==!l[1])&&a[2]===l[2],i=zr(()=>t.children),o=ge(()=>{let a=i();Array.isArray(a)||(a=[a]);for(let l=0;l<a.length;l++){const f=a[l].when;if(f)return e=!!a[l].keyed,[l,f,a[l]]}return[-1]},void 0,{equals:n});return ge(()=>{const[a,l,f]=o();if(a<0)return t.fallback;const p=f.children;return typeof p=="function"&&p.length>0?Pe(()=>p(e?l:()=>{if(Pe(o)[0]!==a)throw Go("Match");return f.when})):p},void 0,void 0)}function Nf(t){return t}let ln;function wu(){ln&&[...ln].forEach(t=>t())}function _u(t){let e;te.context&&te.load&&(e=te.load(te.getContextId()));const[n,i]=Ke(e,void 0);return ln||(ln=new Set),ln.add(i),zt(()=>ln.delete(i)),ge(()=>{let o;if(o=n()){const a=t.fallback;return typeof a=="function"&&a.length?Pe(()=>a(o,()=>i())):a}return au(()=>t.children,i)},void 0,void 0)}const ku=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"],xu=new Set(["className","value","readOnly","formNoValidate","isMap","noModule","playsInline",...ku]),Eu=new Set(["innerHTML","textContent","innerText","children"]),Au=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),Pu=Object.assign(Object.create(null),{class:"className",formnovalidate:{$:"formNoValidate",BUTTON:1,INPUT:1},ismap:{$:"isMap",IMG:1},nomodule:{$:"noModule",SCRIPT:1},playsinline:{$:"playsInline",VIDEO:1},readonly:{$:"readOnly",INPUT:1,TEXTAREA:1}});function Ou(t,e){const n=Pu[t];return typeof n=="object"?n[e]?n.$:void 0:n}const Su=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),Cu={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"};function Ru(t,e,n){let i=n.length,o=e.length,a=i,l=0,f=0,p=e[o-1].nextSibling,g=null;for(;l<o||f<a;){if(e[l]===n[f]){l++,f++;continue}for(;e[o-1]===n[a-1];)o--,a--;if(o===l){const w=a<i?f?n[f-1].nextSibling:n[a-f]:p;for(;f<a;)t.insertBefore(n[f++],w)}else if(a===f)for(;l<o;)(!g||!g.has(e[l]))&&e[l].remove(),l++;else if(e[l]===n[a-1]&&n[f]===e[o-1]){const w=e[--o].nextSibling;t.insertBefore(n[f++],e[l++].nextSibling),t.insertBefore(n[--a],w),e[o]=n[a]}else{if(!g){g=new Map;let S=f;for(;S<a;)g.set(n[S],S++)}const w=g.get(e[l]);if(w!=null)if(f<w&&w<a){let S=l,D=1,I;for(;++S<o&&S<a&&!((I=g.get(e[S]))==null||I!==w+D);)D++;if(D>w-f){const V=e[l];for(;f<w;)t.insertBefore(n[f++],V)}else t.replaceChild(n[f++],e[l++])}else l++;else e[l++].remove()}}}const uo="_$DX_DELEGATE";function Tu(t,e,n,i={}){let o;return Un(a=>{o=a,e===document?t():et(e,t(),e.firstChild?null:void 0,n)},i.owner),()=>{o(),e.textContent=""}}function hs(t,e,n){let i;const o=()=>{const l=document.createElement("template");return l.innerHTML=t,l.content.firstChild},a=()=>(i||(i=o())).cloneNode(!0);return a.cloneNode=a,a}function Wo(t,e=window.document){const n=e[uo]||(e[uo]=new Set);for(let i=0,o=t.length;i<o;i++){const a=t[i];n.has(a)||(n.add(a),e.addEventListener(a,$u))}}function Yi(t,e,n){_n(t)||(n==null?t.removeAttribute(e):t.setAttribute(e,n))}function Nu(t,e,n,i){_n(t)||(i==null?t.removeAttributeNS(e,n):t.setAttributeNS(e,n,i))}function Mu(t,e,n){_n(t)||(n?t.setAttribute(e,""):t.removeAttribute(e))}function Qo(t,e){_n(t)||(e==null?t.removeAttribute("class"):t.className=e)}function Du(t,e,n,i){if(i)Array.isArray(n)?(t[`$$${e}`]=n[0],t[`$$${e}Data`]=n[1]):t[`$$${e}`]=n;else if(Array.isArray(n)){const o=n[0];t.addEventListener(e,n[0]=a=>o.call(t,n[1],a))}else t.addEventListener(e,n,typeof n!="function"&&n)}function Iu(t,e,n={}){const i=Object.keys(e||{}),o=Object.keys(n);let a,l;for(a=0,l=o.length;a<l;a++){const f=o[a];!f||f==="undefined"||e[f]||(co(t,f,!1),delete n[f])}for(a=0,l=i.length;a<l;a++){const f=i[a],p=!!e[f];!f||f==="undefined"||n[f]===p||!p||(co(t,f,!0),n[f]=p)}return n}function Ku(t,e,n){if(!e)return n?Yi(t,"style"):e;const i=t.style;if(typeof e=="string")return i.cssText=e;typeof n=="string"&&(i.cssText=n=void 0),n||(n={}),e||(e={});let o,a;for(a in n)e[a]==null&&i.removeProperty(a),delete n[a];for(a in e)o=e[a],o!==n[a]&&(i.setProperty(a,o),n[a]=o);return n}function Xi(t,e={},n,i){const o={};return i||ut(()=>o.children=Gn(t,e.children,o.children)),ut(()=>typeof e.ref=="function"&&ju(e.ref,t)),ut(()=>Bu(t,e,n,!0,o,!0)),o}function ju(t,e,n){return Pe(()=>t(e,n))}function et(t,e,n,i){if(n!==void 0&&!i&&(i=[]),typeof e!="function")return Gn(t,e,i,n);ut(o=>Gn(t,e(),o,n),i)}function Bu(t,e,n,i,o={},a=!1){e||(e={});for(const l in o)if(!(l in e)){if(l==="children")continue;o[l]=lo(t,l,null,o[l],n,a,e)}for(const l in e){if(l==="children")continue;const f=e[l];o[l]=lo(t,l,f,o[l],n,a,e)}}function _n(t){return!!te.context&&!te.done&&(!t||t.isConnected)}function Lu(t){return t.toLowerCase().replace(/-([a-z])/g,(e,n)=>n.toUpperCase())}function co(t,e,n){const i=e.trim().split(/\s+/);for(let o=0,a=i.length;o<a;o++)t.classList.toggle(i[o],n)}function lo(t,e,n,i,o,a,l){let f,p,g,w,S;if(e==="style")return Ku(t,n,i);if(e==="classList")return Iu(t,n,i);if(n===i)return i;if(e==="ref")a||n(t);else if(e.slice(0,3)==="on:"){const D=e.slice(3);i&&t.removeEventListener(D,i,typeof i!="function"&&i),n&&t.addEventListener(D,n,typeof n!="function"&&n)}else if(e.slice(0,10)==="oncapture:"){const D=e.slice(10);i&&t.removeEventListener(D,i,!0),n&&t.addEventListener(D,n,!0)}else if(e.slice(0,2)==="on"){const D=e.slice(2).toLowerCase(),I=Su.has(D);if(!I&&i){const V=Array.isArray(i)?i[0]:i;t.removeEventListener(D,V)}(I||n)&&(Du(t,D,n,I),I&&Wo([D]))}else if(e.slice(0,5)==="attr:")Yi(t,e.slice(5),n);else if(e.slice(0,5)==="bool:")Mu(t,e.slice(5),n);else if((S=e.slice(0,5)==="prop:")||(g=Eu.has(e))||!o&&((w=Ou(e,t.tagName))||(p=xu.has(e)))||(f=t.nodeName.includes("-")||"is"in l)){if(S)e=e.slice(5),p=!0;else if(_n(t))return n;e==="class"||e==="className"?Qo(t,n):f&&!p&&!g?t[Lu(e)]=n:t[w||e]=n}else{const D=o&&e.indexOf(":")>-1&&Cu[e.split(":")[0]];D?Nu(t,D,e,n):Yi(t,Au[e]||e,n)}return n}function $u(t){if(te.registry&&te.events&&te.events.find(([p,g])=>g===t))return;let e=t.target;const n=`$$${t.type}`,i=t.target,o=t.currentTarget,a=p=>Object.defineProperty(t,"target",{configurable:!0,value:p}),l=()=>{const p=e[n];if(p&&!e.disabled){const g=e[`${n}Data`];if(g!==void 0?p.call(e,g,t):p.call(e,t),t.cancelBubble)return}return e.host&&typeof e.host!="string"&&!e.host._$host&&e.contains(t.target)&&a(e.host),!0},f=()=>{for(;l()&&(e=e._$host||e.parentNode||e.host););};if(Object.defineProperty(t,"currentTarget",{configurable:!0,get(){return e||document}}),te.registry&&!te.done&&(te.done=_$HY.done=!0),t.composedPath){const p=t.composedPath();a(p[0]);for(let g=0;g<p.length-2&&(e=p[g],!!l());g++){if(e._$host){e=e._$host,f();break}if(e.parentNode===o)break}}else f();a(i)}function Gn(t,e,n,i,o){const a=_n(t);if(a){!n&&(n=[...t.childNodes]);let p=[];for(let g=0;g<n.length;g++){const w=n[g];w.nodeType===8&&w.data.slice(0,2)==="!$"?w.remove():p.push(w)}n=p}for(;typeof n=="function";)n=n();if(e===n)return n;const l=typeof e,f=i!==void 0;if(t=f&&n[0]&&n[0].parentNode||t,l==="string"||l==="number"){if(a||l==="number"&&(e=e.toString(),e===n))return n;if(f){let p=n[0];p&&p.nodeType===3?p.data!==e&&(p.data=e):p=document.createTextNode(e),n=sn(t,n,i,p)}else n!==""&&typeof n=="string"?n=t.firstChild.data=e:n=t.textContent=e}else if(e==null||l==="boolean"){if(a)return n;n=sn(t,n,i)}else{if(l==="function")return ut(()=>{let p=e();for(;typeof p=="function";)p=p();n=Gn(t,p,n,i)}),()=>n;if(Array.isArray(e)){const p=[],g=n&&Array.isArray(n);if(Ji(p,e,n,o))return ut(()=>n=Gn(t,p,n,i,!0)),()=>n;if(a){if(!p.length)return n;if(i===void 0)return n=[...t.childNodes];let w=p[0];if(w.parentNode!==t)return n;const S=[w];for(;(w=w.nextSibling)!==i;)S.push(w);return n=S}if(p.length===0){if(n=sn(t,n,i),f)return n}else g?n.length===0?fo(t,p,i):Ru(t,n,p):(n&&sn(t),fo(t,p));n=p}else if(e.nodeType){if(a&&e.parentNode)return n=f?[e]:e;if(Array.isArray(n)){if(f)return n=sn(t,n,i,e);sn(t,n,null,e)}else n==null||n===""||!t.firstChild?t.appendChild(e):t.replaceChild(e,t.firstChild);n=e}}return n}function Ji(t,e,n,i){let o=!1;for(let a=0,l=e.length;a<l;a++){let f=e[a],p=n&&n[t.length],g;if(!(f==null||f===!0||f===!1))if((g=typeof f)=="object"&&f.nodeType)t.push(f);else if(Array.isArray(f))o=Ji(t,f,p)||o;else if(g==="function")if(i){for(;typeof f=="function";)f=f();o=Ji(t,Array.isArray(f)?f:[f],Array.isArray(p)?p:[p])||o}else t.push(f),o=!0;else{const w=String(f);p&&p.nodeType===3&&p.data===w?t.push(p):t.push(document.createTextNode(w))}}return o}function fo(t,e,n=null){for(let i=0,o=e.length;i<o;i++)t.insertBefore(e[i],n)}function sn(t,e,n,i){if(n===void 0)return t.textContent="";const o=i||document.createTextNode("");if(e.length){let a=!1;for(let l=e.length-1;l>=0;l--){const f=e[l];if(o!==f){const p=f.parentNode===t;!a&&!l?p?t.replaceChild(o,f):t.insertBefore(o,n):p&&f.remove()}else a=!0}}else t.insertBefore(o,n);return[o]}const qu=!1,Fu="modulepreload",Uu=function(t,e){return new URL(t,e).href},ho={},Ve=function(e,n,i){let o=Promise.resolve();if(n&&n.length>0){const l=document.getElementsByTagName("link"),f=document.querySelector("meta[property=csp-nonce]"),p=f?.nonce||f?.getAttribute("nonce");o=Promise.allSettled(n.map(g=>{if(g=Uu(g,i),g in ho)return;ho[g]=!0;const w=g.endsWith(".css"),S=w?'[rel="stylesheet"]':"";if(!!i)for(let V=l.length-1;V>=0;V--){const L=l[V];if(L.href===g&&(!w||L.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${g}"]${S}`))return;const I=document.createElement("link");if(I.rel=w?"stylesheet":Fu,w||(I.as="script"),I.crossOrigin="",I.href=g,p&&I.setAttribute("nonce",p),document.head.appendChild(I),w)return new Promise((V,L)=>{I.addEventListener("load",V),I.addEventListener("error",()=>L(new Error(`Unable to preload CSS for ${g}`)))})}))}function a(l){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=l,window.dispatchEvent(f),!f.defaultPrevented)throw l}return o.then(l=>{for(const f of l||[])f.status==="rejected"&&a(f.reason);return e().catch(a)})};function Yo(){let t=new Set;function e(o){return t.add(o),()=>t.delete(o)}let n=!1;function i(o,a){if(n)return!(n=!1);const l={to:o,options:a,defaultPrevented:!1,preventDefault:()=>l.defaultPrevented=!0};for(const f of t)f.listener({...l,from:f.location,retry:p=>{p&&(n=!0),f.navigate(o,{...a,resolve:!1})}});return!l.defaultPrevented}return{subscribe:e,confirm:i}}let Zi;function ds(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),Zi=window.history.state._depth}ds();function zu(t){return{...t,_depth:window.history.state&&window.history.state._depth}}function Vu(t,e){let n=!1;return()=>{const i=Zi;ds();const o=i==null?null:Zi-i;if(n){n=!1;return}o&&e(o)?(n=!0,window.history.go(-o)):t()}}const Gu=/^(?:[a-z0-9]+:)?\/\//i,Hu=/^\/+|(\/)\/+$/g,Xo="http://sr";function qt(t,e=!1){const n=t.replace(Hu,"$1");return n?e||/^[?#]/.test(n)?n:"/"+n:""}function Tr(t,e,n){if(Gu.test(e))return;const i=qt(t),o=n&&qt(n);let a="";return!o||e.startsWith("/")?a=i:o.toLowerCase().indexOf(i.toLowerCase())!==0?a=i+o:a=o,(a||"/")+qt(e,!a)}function Wu(t,e){if(t==null)throw new Error(e);return t}function Qu(t,e){return qt(t).replace(/\/*(\*.*)?$/g,"")+qt(e)}function Jo(t){const e={};return t.searchParams.forEach((n,i)=>{e[i]=n}),e}function Yu(t,e,n){const[i,o]=t.split("/*",2),a=i.split("/").filter(Boolean),l=a.length;return f=>{const p=f.split("/").filter(Boolean),g=p.length-l;if(g<0||g>0&&o===void 0&&!e)return null;const w={path:l?"":"/",params:{}},S=D=>n===void 0?void 0:n[D];for(let D=0;D<l;D++){const I=a[D],V=p[D],L=I[0]===":",H=L?I.slice(1):I;if(L&&Ki(V,S(H)))w.params[H]=V;else if(L||!Ki(V,I))return null;w.path+=`/${V}`}if(o){const D=g?p.slice(-g).join("/"):"";if(Ki(D,S(o)))w.params[o]=D;else return null}return w}}function Ki(t,e){const n=i=>i.localeCompare(t,void 0,{sensitivity:"base"})===0;return e===void 0?!0:typeof e=="string"?n(e):typeof e=="function"?e(t):Array.isArray(e)?e.some(n):e instanceof RegExp?e.test(t):!1}function Xu(t){const[e,n]=t.pattern.split("/*",2),i=e.split("/").filter(Boolean);return i.reduce((o,a)=>o+(a.startsWith(":")?2:3),i.length-(n===void 0?0:1))}function Zo(t){const e=new Map,n=$o();return new Proxy({},{get(i,o){return e.has(o)||qo(n,()=>e.set(o,ge(()=>t()[o]))),e.get(o)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(t())}})}function Ju(t,e){const n=new URLSearchParams(t);Object.entries(e).forEach(([o,a])=>{a==null||a===""?n.delete(o):n.set(o,String(a))});const i=n.toString();return i?`?${i}`:""}function ea(t){let e=/(\/?\:[^\/]+)\?/.exec(t);if(!e)return[t];let n=t.slice(0,e.index),i=t.slice(e.index+e[0].length);const o=[n,n+=e[1]];for(;e=/^(\/\:[^\/]+)\?/.exec(i);)o.push(n+=e[1]),i=i.slice(e[0].length);return ea(i).reduce((a,l)=>[...a,...o.map(f=>f+l)],[])}const Zu=100,ta=Xn(),ps=Xn(),kn=()=>Wu(Ur(ta),"<A> and 'use' router primitives can be only used inside a Route."),ec=()=>Ur(ps)||kn().base,tc=t=>{const e=ec();return ge(()=>e.resolvePath(t()))},nc=t=>{const e=kn();return ge(()=>{const n=t();return n!==void 0?e.renderPath(n):n})},na=()=>kn().navigatorFactory(),Vr=()=>kn().location,Mf=()=>kn().params,Df=()=>{const t=Vr(),e=na(),n=(i,o)=>{const a=Pe(()=>t.pathname+Ju(t.search,i)+t.hash);e(a,{scroll:!1,resolve:!1,...o})};return[t.query,n]},rc=t=>{const e=kn().beforeLeave.subscribe({listener:t,location:Vr(),navigate:na()});zt(e)};function ic(t,e=""){const{component:n,load:i,children:o,info:a}=t,l=!o||Array.isArray(o)&&!o.length,f={key:t,component:n,load:i,info:a};return ra(t.path).reduce((p,g)=>{for(const w of ea(g)){const S=Qu(e,w);let D=l?S:S.split("/*",1)[0];D=D.split("/").map(I=>I.startsWith(":")||I.startsWith("*")?I:encodeURIComponent(I)).join("/"),p.push({...f,originalPath:g,pattern:D,matcher:Yu(D,!l,t.matchFilters)})}return p},[])}function sc(t,e=0){return{routes:t,score:Xu(t[t.length-1])*1e4-e,matcher(n){const i=[];for(let o=t.length-1;o>=0;o--){const a=t[o],l=a.matcher(n);if(!l)return null;i.unshift({...l,route:a})}return i}}}function ra(t){return Array.isArray(t)?t:[t]}function ia(t,e="",n=[],i=[]){const o=ra(t);for(let a=0,l=o.length;a<l;a++){const f=o[a];if(f&&typeof f=="object"){f.hasOwnProperty("path")||(f.path="");const p=ic(f,e);for(const g of p){n.push(g);const w=Array.isArray(f.children)&&f.children.length===0;if(f.children&&!w)ia(f.children,g.pattern,n,i);else{const S=sc([...n],i.length);i.push(S)}n.pop()}}}return n.length?i:i.sort((a,l)=>l.score-a.score)}function ji(t,e){for(let n=0,i=t.length;n<i;n++){const o=t[n].matcher(e);if(o)return o}return[]}function oc(t,e){const n=new URL(Xo),i=ge(p=>{const g=t();try{return new URL(g,n)}catch{return console.error(`Invalid path ${g}`),p}},n,{equals:(p,g)=>p.href===g.href}),o=ge(()=>i().pathname),a=ge(()=>i().search,!0),l=ge(()=>i().hash),f=()=>"";return{get pathname(){return o()},get search(){return a()},get hash(){return l()},get state(){return e()},get key(){return f()},query:Zo(fs(a,()=>Jo(i())))}}let Bt;function ac(){return Bt}function uc(t,e,n,i={}){const{signal:[o,a],utils:l={}}=t,f=l.parsePath||(ce=>ce),p=l.renderPath||(ce=>ce),g=l.beforeLeave||Yo(),w=Tr("",i.base||"");if(w===void 0)throw new Error(`${w} is not a valid base path`);w&&!o().value&&a({value:w,replace:!0,scroll:!1});const[S,D]=Ke(!1);let I;const V=(ce,be)=>{be.value===L()&&be.state===Y()||(I===void 0&&D(!0),Bt=ce,I=be,uu(()=>{I===be&&(H(I.value),W(I.state),wu(),pe[1]([]))}).finally(()=>{I===be&&Lo(()=>{Bt=void 0,ce==="navigate"&&xe(I),D(!1),I=void 0})}))},[L,H]=Ke(o().value),[Y,W]=Ke(o().state),fe=oc(L,Y),oe=[],pe=Ke([]),_e=ge(()=>typeof i.transformUrl=="function"?ji(e(),i.transformUrl(fe.pathname)):ji(e(),fe.pathname)),Ae=Zo(()=>{const ce=_e(),be={};for(let qe=0;qe<ce.length;qe++)Object.assign(be,ce[qe].params);return be}),Xe={pattern:w,path:()=>w,outlet:()=>null,resolvePath(ce){return Tr(w,ce)}};return ut(fs(o,ce=>V("native",ce),{defer:!0})),{base:Xe,location:fe,params:Ae,isRouting:S,renderPath:p,parsePath:f,navigatorFactory:ke,matches:_e,beforeLeave:g,preloadRoute:Ge,singleFlight:i.singleFlight===void 0?!0:i.singleFlight,submissions:pe};function ve(ce,be,qe){Pe(()=>{if(typeof be=="number"){be&&(l.go?l.go(be):console.warn("Router integration does not support relative routing"));return}const{replace:Ot,resolve:En,scroll:He,state:Je}={replace:!1,resolve:!0,scroll:!0,...qe},Me=En?ce.resolvePath(be):Tr("",be);if(Me===void 0)throw new Error(`Path '${be}' is not a routable path`);if(oe.length>=Zu)throw new Error("Too many redirects");const Wt=L();(Me!==Wt||Je!==Y())&&(qu||g.confirm(Me,qe)&&(oe.push({value:Wt,replace:Ot,scroll:He,state:Y()}),V("navigate",{value:Me,state:Je})))})}function ke(ce){return ce=ce||Ur(ps)||Xe,(be,qe)=>ve(ce,be,qe)}function xe(ce){const be=oe[0];be&&(a({...ce,replace:be.replace,scroll:be.scroll}),oe.length=0)}function Ge(ce,be={}){const qe=ji(e(),ce.pathname),Ot=Bt;Bt="preload";for(let En in qe){const{route:He,params:Je}=qe[En];He.component&&He.component.preload&&He.component.preload();const{load:Me}=He;be.preloadData&&Me&&qo(n(),()=>Me({params:Je,location:{pathname:ce.pathname,search:ce.search,hash:ce.hash,query:Jo(ce),state:null,key:""},intent:"preload"}))}Bt=Ot}}function cc(t,e,n,i){const{base:o,location:a,params:l}=t,{pattern:f,component:p,load:g}=i().route,w=ge(()=>i().path);p&&p.preload&&p.preload();const S=g?g({params:l,location:a,intent:Bt||"initial"}):void 0;return{parent:e,pattern:f,path:w,outlet:()=>p?J(p,{params:l,location:a,data:S,get children(){return n()}}):n(),resolvePath(I){return Tr(o.path(),I,w())}}}const lc=t=>e=>{const{base:n}=e,i=zr(()=>e.children),o=ge(()=>ia(i(),e.base||""));let a;const l=uc(t,o,()=>a,{base:n,singleFlight:e.singleFlight,transformUrl:e.transformUrl});return t.create&&t.create(l),J(ta.Provider,{value:l,get children(){return J(fc,{routerState:l,get root(){return e.root},get load(){return e.rootLoad},get children(){return[ge(()=>(a=$o())&&null),J(hc,{routerState:l,get branches(){return o()}})]}})}})};function fc(t){const e=t.routerState.location,n=t.routerState.params,i=ge(()=>t.load&&Pe(()=>{t.load({params:n,location:e,intent:ac()||"initial"})}));return J(Ho,{get when(){return t.root},keyed:!0,get fallback(){return t.children},children:o=>J(o,{params:n,location:e,get data(){return i()},get children(){return t.children}})})}function hc(t){const e=[];let n;const i=ge(fs(t.routerState.matches,(o,a,l)=>{let f=a&&o.length===a.length;const p=[];for(let g=0,w=o.length;g<w;g++){const S=a&&a[g],D=o[g];l&&S&&D.route.key===S.route.key?p[g]=l[g]:(f=!1,e[g]&&e[g](),Un(I=>{e[g]=I,p[g]=cc(t.routerState,p[g-1]||t.routerState.base,po(()=>i()[g+1]),()=>t.routerState.matches()[g])}))}return e.splice(o.length).forEach(g=>g()),l&&f?l:(n=p[0],p)}));return po(()=>i()&&n)()}const po=t=>()=>J(Ho,{get when(){return t()},keyed:!0,children:e=>J(ps.Provider,{value:e,get children(){return e.outlet()}})}),Ce=t=>{const e=zr(()=>t.children);return Qi(t,{get children(){return e()}})};function dc([t,e],n,i){return[t,i?o=>e(i(o)):e]}function pc(t){if(t==="#")return null;try{return document.querySelector(t)}catch{return null}}function mc(t){let e=!1;const n=o=>typeof o=="string"?{value:o}:o,i=dc(Ke(n(t.get()),{equals:(o,a)=>o.value===a.value&&o.state===a.state}),void 0,o=>(!e&&t.set(o),o));return t.init&&zt(t.init((o=t.get())=>{e=!0,i[1](n(o)),e=!1})),lc({signal:i,create:t.create,utils:t.utils})}function yc(t,e,n){return t.addEventListener(e,n),()=>t.removeEventListener(e,n)}function gc(t,e){const n=pc(`#${t}`);n?n.scrollIntoView():e&&window.scrollTo(0,0)}const vc=new Map;function bc(t=!0,e=!1,n="/_server",i){return o=>{const a=o.base.path(),l=o.navigatorFactory(o.base);let f={};function p(L){return L.namespaceURI==="http://www.w3.org/2000/svg"}function g(L){if(L.defaultPrevented||L.button!==0||L.metaKey||L.altKey||L.ctrlKey||L.shiftKey)return;const H=L.composedPath().find(_e=>_e instanceof Node&&_e.nodeName.toUpperCase()==="A");if(!H||e&&!H.hasAttribute("link"))return;const Y=p(H),W=Y?H.href.baseVal:H.href;if((Y?H.target.baseVal:H.target)||!W&&!H.hasAttribute("state"))return;const oe=(H.getAttribute("rel")||"").split(/\s+/);if(H.hasAttribute("download")||oe&&oe.includes("external"))return;const pe=Y?new URL(W,document.baseURI):new URL(W);if(!(pe.origin!==window.location.origin||a&&pe.pathname&&!pe.pathname.toLowerCase().startsWith(a.toLowerCase())))return[H,pe]}function w(L){const H=g(L);if(!H)return;const[Y,W]=H,fe=o.parsePath(W.pathname+W.search+W.hash),oe=Y.getAttribute("state");L.preventDefault(),l(fe,{resolve:!1,replace:Y.hasAttribute("replace"),scroll:!Y.hasAttribute("noscroll"),state:oe&&JSON.parse(oe)})}function S(L){const H=g(L);if(!H)return;const[Y,W]=H;f[W.pathname]||o.preloadRoute(W,{preloadData:Y.getAttribute("preload")!=="false"})}function D(L){const H=g(L);if(!H)return;const[Y,W]=H;f[W.pathname]||(f[W.pathname]=setTimeout(()=>{o.preloadRoute(W,{preloadData:Y.getAttribute("preload")!=="false"}),delete f[W.pathname]},200))}function I(L){const H=g(L);if(!H)return;const[,Y]=H;f[Y.pathname]&&(clearTimeout(f[Y.pathname]),delete f[Y.pathname])}function V(L){if(L.defaultPrevented)return;let H=L.submitter&&L.submitter.hasAttribute("formaction")?L.submitter.getAttribute("formaction"):L.target.getAttribute("action");if(!H)return;if(!H.startsWith("https://action/")){const W=new URL(H,Xo);if(H=o.parsePath(W.pathname+W.search),!H.startsWith(n))return}if(L.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const Y=vc.get(H);if(Y){L.preventDefault();const W=new FormData(L.target);L.submitter&&L.submitter.name&&W.append(L.submitter.name,L.submitter.value),Y.call({r:o,f:L.target},W)}}Wo(["click","submit"]),document.addEventListener("click",w),t&&(document.addEventListener("mouseover",D),document.addEventListener("mouseout",I),document.addEventListener("focusin",S),document.addEventListener("touchstart",S)),document.addEventListener("submit",V),zt(()=>{document.removeEventListener("click",w),t&&(document.removeEventListener("mouseover",D),document.removeEventListener("mouseout",I),document.removeEventListener("focusin",S),document.removeEventListener("touchstart",S)),document.removeEventListener("submit",V)})}}function wc(t){const e=t.replace(/^.*?#/,"");if(!e.startsWith("/")){const[,n="/"]=window.location.hash.split("#",2);return`${n}#${e}`}return e}function _c(t){const e=()=>window.location.hash.slice(1),n=Yo();return mc({get:e,set({value:i,replace:o,scroll:a,state:l}){o?window.history.replaceState(zu(l),"","#"+i):window.history.pushState(l,"","#"+i);const f=i.indexOf("#"),p=f>=0?i.slice(f+1):"";gc(p,a),ds()},init:i=>yc(window,"hashchange",Vu(i,o=>!n.confirm(o&&o<0?o:e()))),create:bc(t.preload,t.explicitLinks,t.actionBase),utils:{go:i=>window.history.go(i),renderPath:i=>`#${i}`,parsePath:wc,beforeLeave:n}})(t)}var kc=hs("<a>");function pt(t){t=Qi({inactiveClass:"inactive",activeClass:"active"},t);const[,e]=gu(t,["href","state","class","activeClass","inactiveClass","end"]),n=tc(()=>t.href),i=nc(n),o=Vr(),a=ge(()=>{const l=n();if(l===void 0)return[!1,!1];const f=qt(l.split(/[?#]/,1)[0]).toLowerCase(),p=qt(o.pathname).toLowerCase();return[t.end?f===p:p.startsWith(f+"/")||p===f,f===p]});return(()=>{var l=kc();return Xi(l,Qi(e,{get href(){return i()||t.href},get state(){return JSON.stringify(t.state)},get classList(){return{...t.class&&{[t.class]:!0},[t.inactiveClass]:!a()[0],[t.activeClass]:a()[0],...e.classList}},link:"",get"aria-current"(){return a()[1]?"page":void 0}}),!1,!1),l})()}const es=Symbol("store-raw"),dn=Symbol("store-node"),mt=Symbol("store-has"),sa=Symbol("store-self");function oa(t){let e=t[rt];if(!e&&(Object.defineProperty(t,rt,{value:e=new Proxy(t,Ac)}),!Array.isArray(t))){const n=Object.keys(t),i=Object.getOwnPropertyDescriptors(t);for(let o=0,a=n.length;o<a;o++){const l=n[o];i[l].get&&Object.defineProperty(t,l,{enumerable:i[l].enumerable,get:i[l].get.bind(e)})}}return e}function At(t){let e;return t!=null&&typeof t=="object"&&(t[rt]||!(e=Object.getPrototypeOf(t))||e===Object.prototype||Array.isArray(t))}function gn(t,e=new Set){let n,i,o,a;if(n=t!=null&&t[es])return n;if(!At(t)||e.has(t))return t;if(Array.isArray(t)){Object.isFrozen(t)?t=t.slice(0):e.add(t);for(let l=0,f=t.length;l<f;l++)o=t[l],(i=gn(o,e))!==o&&(t[l]=i)}else{Object.isFrozen(t)?t=Object.assign({},t):e.add(t);const l=Object.keys(t),f=Object.getOwnPropertyDescriptors(t);for(let p=0,g=l.length;p<g;p++)a=l[p],!f[a].get&&(o=t[a],(i=gn(o,e))!==o&&(t[a]=i))}return t}function jr(t,e){let n=t[e];return n||Object.defineProperty(t,e,{value:n=Object.create(null)}),n}function Hn(t,e,n){if(t[e])return t[e];const[i,o]=Ke(n,{equals:!1,internal:!0});return i.$=o,t[e]=i}function xc(t,e){const n=Reflect.getOwnPropertyDescriptor(t,e);return!n||n.get||!n.configurable||e===rt||e===dn||(delete n.value,delete n.writable,n.get=()=>t[rt][e]),n}function aa(t){Vi()&&Hn(jr(t,dn),sa)()}function Ec(t){return aa(t),Reflect.ownKeys(t)}const Ac={get(t,e,n){if(e===es)return t;if(e===rt)return n;if(e===zi)return aa(t),n;const i=jr(t,dn),o=i[e];let a=o?o():t[e];if(e===dn||e===mt||e==="__proto__")return a;if(!o){const l=Object.getOwnPropertyDescriptor(t,e);Vi()&&(typeof a!="function"||t.hasOwnProperty(e))&&!(l&&l.get)&&(a=Hn(i,e,a)())}return At(a)?oa(a):a},has(t,e){return e===es||e===rt||e===zi||e===dn||e===mt||e==="__proto__"?!0:(Vi()&&Hn(jr(t,mt),e)(),e in t)},set(){return!0},deleteProperty(){return!0},ownKeys:Ec,getOwnPropertyDescriptor:xc};function Ye(t,e,n,i=!1){if(!i&&t[e]===n)return;const o=t[e],a=t.length;n===void 0?(delete t[e],t[mt]&&t[mt][e]&&o!==void 0&&t[mt][e].$()):(t[e]=n,t[mt]&&t[mt][e]&&o===void 0&&t[mt][e].$());let l=jr(t,dn),f;if((f=Hn(l,e,o))&&f.$(()=>n),Array.isArray(t)&&t.length!==a){for(let p=t.length;p<a;p++)(f=l[p])&&f.$();(f=Hn(l,"length",a))&&f.$(t.length)}(f=l[sa])&&f.$()}function ua(t,e){const n=Object.keys(e);for(let i=0;i<n.length;i+=1){const o=n[i];Ye(t,o,e[o])}}function Pc(t,e){if(typeof e=="function"&&(e=e(t)),e=gn(e),Array.isArray(e)){if(t===e)return;let n=0,i=e.length;for(;n<i;n++){const o=e[n];t[n]!==o&&Ye(t,n,o)}Ye(t,"length",i)}else ua(t,e)}function qn(t,e,n=[]){let i,o=t;if(e.length>1){i=e.shift();const l=typeof i,f=Array.isArray(t);if(Array.isArray(i)){for(let p=0;p<i.length;p++)qn(t,[i[p]].concat(e),n);return}else if(f&&l==="function"){for(let p=0;p<t.length;p++)i(t[p],p)&&qn(t,[p].concat(e),n);return}else if(f&&l==="object"){const{from:p=0,to:g=t.length-1,by:w=1}=i;for(let S=p;S<=g;S+=w)qn(t,[S].concat(e),n);return}else if(e.length>1){qn(t[i],e,[i].concat(n));return}o=t[i],n=[i].concat(n)}let a=e[0];typeof a=="function"&&(a=a(o,n),a===o)||i===void 0&&a==null||(a=gn(a),i===void 0||At(o)&&At(a)&&!Array.isArray(a)?ua(o,a):Ye(t,i,a))}function If(...[t,e]){const n=gn(t||{}),i=Array.isArray(n),o=oa(n);function a(...l){Lo(()=>{i&&l.length===1?Pc(n,l[0]):qn(n,l)})}return[o,a]}const ts=Symbol("store-root");function cn(t,e,n,i,o){const a=e[n];if(t===a)return;const l=Array.isArray(t);if(n!==ts&&(!At(t)||!At(a)||l!==Array.isArray(a)||o&&t[o]!==a[o])){Ye(e,n,t);return}if(l){if(t.length&&a.length&&(!i||o&&t[0]&&t[0][o]!=null)){let g,w,S,D,I,V,L,H;for(S=0,D=Math.min(a.length,t.length);S<D&&(a[S]===t[S]||o&&a[S]&&t[S]&&a[S][o]===t[S][o]);S++)cn(t[S],a,S,i,o);const Y=new Array(t.length),W=new Map;for(D=a.length-1,I=t.length-1;D>=S&&I>=S&&(a[D]===t[I]||o&&a[S]&&t[S]&&a[D][o]===t[I][o]);D--,I--)Y[I]=a[D];if(S>I||S>D){for(w=S;w<=I;w++)Ye(a,w,t[w]);for(;w<t.length;w++)Ye(a,w,Y[w]),cn(t[w],a,w,i,o);a.length>t.length&&Ye(a,"length",t.length);return}for(L=new Array(I+1),w=I;w>=S;w--)V=t[w],H=o&&V?V[o]:V,g=W.get(H),L[w]=g===void 0?-1:g,W.set(H,w);for(g=S;g<=D;g++)V=a[g],H=o&&V?V[o]:V,w=W.get(H),w!==void 0&&w!==-1&&(Y[w]=a[g],w=L[w],W.set(H,w));for(w=S;w<t.length;w++)w in Y?(Ye(a,w,Y[w]),cn(t[w],a,w,i,o)):Ye(a,w,t[w])}else for(let g=0,w=t.length;g<w;g++)cn(t[g],a,g,i,o);a.length>t.length&&Ye(a,"length",t.length);return}const f=Object.keys(t);for(let g=0,w=f.length;g<w;g++)cn(t[f[g]],a,f[g],i,o);const p=Object.keys(a);for(let g=0,w=p.length;g<w;g++)t[p[g]]===void 0&&Ye(a,p[g],void 0)}function Oc(t,e={}){const{merge:n,key:i="id"}=e,o=gn(t);return a=>{if(!At(a)||!At(o))return o;const l=cn(o,{[ts]:a},ts,n,i);return l===void 0?a:l}}const Sc=Xn(),Cc=["title","meta"],mo=[],yo=["name","http-equiv","content","charset","media"].concat(["property"]),go=(t,e)=>{const n=Object.fromEntries(Object.entries(t.props).filter(([i])=>e.includes(i)).sort());return(Object.hasOwn(n,"name")||Object.hasOwn(n,"property"))&&(n.name=n.name||n.property,delete n.property),t.tag+JSON.stringify(n)};function Rc(){if(!te.context){const n=document.head.querySelectorAll("[data-sm]");Array.prototype.forEach.call(n,i=>i.parentNode.removeChild(i))}const t=new Map;function e(n){if(n.ref)return n.ref;let i=document.querySelector(`[data-sm="${n.id}"]`);return i?(i.tagName.toLowerCase()!==n.tag&&(i.parentNode&&i.parentNode.removeChild(i),i=document.createElement(n.tag)),i.removeAttribute("data-sm")):i=document.createElement(n.tag),i}return{addTag(n){if(Cc.indexOf(n.tag)!==-1){const a=n.tag==="title"?mo:yo,l=go(n,a);t.has(l)||t.set(l,[]);let f=t.get(l),p=f.length;f=[...f,n],t.set(l,f);let g=e(n);n.ref=g,Xi(g,n.props);let w=null;for(var i=p-1;i>=0;i--)if(f[i]!=null){w=f[i];break}return g.parentNode!=document.head&&document.head.appendChild(g),w&&w.ref&&w.ref.parentNode&&document.head.removeChild(w.ref),p}let o=e(n);return n.ref=o,Xi(o,n.props),o.parentNode!=document.head&&document.head.appendChild(o),-1},removeTag(n,i){const o=n.tag==="title"?mo:yo,a=go(n,o);if(n.ref){const l=t.get(a);if(l){if(n.ref.parentNode){n.ref.parentNode.removeChild(n.ref);for(let f=i-1;f>=0;f--)l[f]!=null&&document.head.appendChild(l[f].ref)}l[i]=null,t.set(a,l)}else n.ref.parentNode&&n.ref.parentNode.removeChild(n.ref)}}}}const Tc=t=>{const e=Rc();return J(Sc.Provider,{value:e,get children(){return t.children}})};function Nc(t){let e,n;return function(...i){const o=this,a=()=>{n=void 0,e=t.apply(o,i).finally(()=>{e=void 0,n&&n()})};e?n=a:a()}}function Mc(t,e){return Nc(function(...n){return e.apply(this,n),new Promise(i=>setTimeout(i,t))})}var Dc=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,n)=>(typeof require<"u"?require:e)[n]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')}),Ic=t=>(typeof t.clear=="function"||(t.clear=()=>{let e;for(;e=t.key(0);)t.removeItem(e)}),t),Kc=["domain","expires","path","secure","httpOnly","maxAge","sameSite"];function jc(t){if(!t)return"";let e="";for(const n in t){if(!Kc.includes(n))continue;const i=t[n];e+=i instanceof Date?`; ${n}=${i.toUTCString()}`:typeof i=="boolean"?`; ${n}`:`; ${n}=${i}`}return e}function Bc(t,e){return t.match(`(^|;)\\s*${e}\\s*=\\s*([^;]+)`)?.pop()??null}var vo;try{vo=Dc("solid-start/server").useRequest}catch{vo=()=>(console.warn("It seems you attempt to use cookieStorage on the server without having solid-start installed or use vite."),{request:{headers:{get:()=>""}}})}var on=Ic({_read:()=>document.cookie,_write:(t,e,n)=>{document.cookie=`${t}=${e}${jc(n)}`},getItem:(t,e)=>Bc(on._read(e),t),setItem:(t,e,n)=>{on._write(t,e,n);{const o=Object.assign(new Event("storage"),{key:t,oldValue:null,newValue:e,url:globalThis.document.URL,storageArea:on});window.dispatchEvent(o)}},removeItem:(t,e)=>{on._write(t,"deleted",{...e,expires:new Date(0)})},key:(t,e)=>{let n=null,i=0;return on._read(e).replace(/(?:^|;)\s*(.+?)\s*=\s*[^;]+/g,(o,a)=>(!n&&a&&i++===t&&(n=a),"")),n},getLength:t=>{let e=0;return on._read(t).replace(/(?:^|;)\s*.+?\s*=\s*[^;]+/g,n=>(e+=n?1:0,"")),e},get length(){return this.getLength()}});function Lc(t,e={}){const n=e.storage||globalThis.localStorage;if(!n)return t;const i=e.storageOptions,o=e.name||`storage-${bu()}`,a=e.serialize||JSON.stringify.bind(JSON),l=e.deserialize||JSON.parse.bind(JSON),f=n.getItem(o,i),p=typeof t[0]=="function"?w=>t[1](()=>l(w)):w=>t[1](Oc(l(w)));let g=!0;return f instanceof Promise?f.then(w=>g&&w&&p(w)):f&&p(f),[t[0],typeof t[0]=="function"?w=>{const S=t[1](w);return w?n.setItem(o,a(S),i):n.removeItem(o,i),g=!1,S}:(...w)=>{t[1](...w);const S=a(Pe(()=>t[0]));n.setItem(o,S,i),g=!1}]}const zn=(t,e,n)=>Lc(Ke(t),{name:`.aidchess.v1.${e}`});class ca{ctx=qc();sounds=new Map;paths=new Map;theme="standard";volumeStorage=zn("1","sound.volume");enabled=()=>this.theme!=="silent";resolvePath(e){return this.enabled()?`sound/${this.theme}/${e[0].toUpperCase()+e.slice(1)}`:void 0}getVolume=()=>{const e=parseFloat(this.volumeStorage[0]());return e>=0?e:.7};async play(e,n=1){if(!this.enabled())return;const i=await this.load(e);i&&await i.play(this.getVolume()*n)}async load(e,n){if(!this.ctx||(n?this.paths.set(e,n):n=this.paths.get(e)??this.resolvePath(e),!n))return;if(this.sounds.has(n))return this.sounds.get(n);const i=await fetch(`${n}.mp3`);if(!i.ok)throw new Error(`${n}.mp3 failed ${i.status}`);const o=await i.arrayBuffer(),a=await new Promise((f,p)=>{this.ctx?.decodeAudioData.length===1?this.ctx?.decodeAudioData(o).then(f).catch(p):this.ctx?.decodeAudioData(o,f,p)}),l=new $c(this.ctx,a);return this.sounds.set(n,l),l}preloadBoardSounds(){for(const e of["move","capture","check","genericNotify"])this.load(e)}throttled=Mc(200,e=>this.play(e));setVolume=e=>this.volumeStorage[1](e.toString());async move(e){e?.name?this.throttled(e.name):(e?.san?.includes("x")?this.throttled("capture"):this.throttled("move"),(e?.san?.includes("#")||e?.san?.includes("+"))&&this.throttled("check"))}}class $c{constructor(e,n){this.buffer=n,this.rewire(e)}node;ctx;play(e=1){this.node.gain.setValueAtTime(e,this.ctx.currentTime);const n=this.ctx.createBufferSource();return n.buffer=this.buffer,n.connect(this.node),new Promise(i=>{n.onended=()=>{n.disconnect(),i()},n.start(0)})}rewire(e){this.node?.disconnect(),this.ctx=e,this.node=this.ctx.createGain(),this.node.connect(this.ctx.destination)}}function qc(){return new AudioContext}const la=Xn(new ca);function Fc(t){return J(la.Provider,{value:new ca,get children(){return t.children}})}function Kf(){return Ur(la)}var bo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Uc(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var fa={exports:{}};(function(t,e){(function(n,i){t.exports=i()})(bo,function(){var n=function(r,s){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,c){u.__proto__=c}||function(u,c){for(var h in c)Object.prototype.hasOwnProperty.call(c,h)&&(u[h]=c[h])})(r,s)},i=function(){return(i=Object.assign||function(r){for(var s,u=1,c=arguments.length;u<c;u++)for(var h in s=arguments[u])Object.prototype.hasOwnProperty.call(s,h)&&(r[h]=s[h]);return r}).apply(this,arguments)};function o(r,s,u){for(var c,h=0,d=s.length;h<d;h++)!c&&h in s||((c=c||Array.prototype.slice.call(s,0,h))[h]=s[h]);return r.concat(c||Array.prototype.slice.call(s))}var a=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:bo,l=Object.keys,f=Array.isArray;function p(r,s){return typeof s!="object"||l(s).forEach(function(u){r[u]=s[u]}),r}typeof Promise>"u"||a.Promise||(a.Promise=Promise);var g=Object.getPrototypeOf,w={}.hasOwnProperty;function S(r,s){return w.call(r,s)}function D(r,s){typeof s=="function"&&(s=s(g(r))),(typeof Reflect>"u"?l:Reflect.ownKeys)(s).forEach(function(u){V(r,u,s[u])})}var I=Object.defineProperty;function V(r,s,u,c){I(r,s,p(u&&S(u,"get")&&typeof u.get=="function"?{get:u.get,set:u.set,configurable:!0}:{value:u,configurable:!0,writable:!0},c))}function L(r){return{from:function(s){return r.prototype=Object.create(s.prototype),V(r.prototype,"constructor",r),{extend:D.bind(null,r.prototype)}}}}var H=Object.getOwnPropertyDescriptor,Y=[].slice;function W(r,s,u){return Y.call(r,s,u)}function fe(r,s){return s(r)}function oe(r){if(!r)throw new Error("Assertion Failed")}function pe(r){a.setImmediate?setImmediate(r):setTimeout(r,0)}function _e(r,s){if(typeof s=="string"&&S(r,s))return r[s];if(!s)return r;if(typeof s!="string"){for(var u=[],c=0,h=s.length;c<h;++c){var d=_e(r,s[c]);u.push(d)}return u}var m=s.indexOf(".");if(m!==-1){var y=r[s.substr(0,m)];return y==null?void 0:_e(y,s.substr(m+1))}}function Ae(r,s,u){if(r&&s!==void 0&&!("isFrozen"in Object&&Object.isFrozen(r)))if(typeof s!="string"&&"length"in s){oe(typeof u!="string"&&"length"in u);for(var c=0,h=s.length;c<h;++c)Ae(r,s[c],u[c])}else{var d,m,y=s.indexOf(".");y!==-1?(d=s.substr(0,y),(m=s.substr(y+1))===""?u===void 0?f(r)&&!isNaN(parseInt(d))?r.splice(d,1):delete r[d]:r[d]=u:Ae(y=!(y=r[d])||!S(r,d)?r[d]={}:y,m,u)):u===void 0?f(r)&&!isNaN(parseInt(s))?r.splice(s,1):delete r[s]:r[s]=u}}function Xe(r){var s,u={};for(s in r)S(r,s)&&(u[s]=r[s]);return u}var ve=[].concat;function ke(r){return ve.apply([],r)}var ht="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(ke([8,16,32,64].map(function(r){return["Int","Uint","Float"].map(function(s){return s+r+"Array"})}))).filter(function(r){return a[r]}),xe=new Set(ht.map(function(r){return a[r]})),Ge=null;function ce(r){return Ge=new WeakMap,r=function s(u){if(!u||typeof u!="object")return u;var c=Ge.get(u);if(c)return c;if(f(u)){c=[],Ge.set(u,c);for(var h=0,d=u.length;h<d;++h)c.push(s(u[h]))}else if(xe.has(u.constructor))c=u;else{var m,y=g(u);for(m in c=y===Object.prototype?{}:Object.create(y),Ge.set(u,c),u)S(u,m)&&(c[m]=s(u[m]))}return c}(r),Ge=null,r}var be={}.toString;function qe(r){return be.call(r).slice(8,-1)}var Ot=typeof Symbol<"u"?Symbol.iterator:"@@iterator",En=typeof Ot=="symbol"?function(r){var s;return r!=null&&(s=r[Ot])&&s.apply(r)}:function(){return null};function He(r,s){return s=r.indexOf(s),0<=s&&r.splice(s,1),0<=s}var Je={};function Me(r){var s,u,c,h;if(arguments.length===1){if(f(r))return r.slice();if(this===Je&&typeof r=="string")return[r];if(h=En(r)){for(u=[];!(c=h.next()).done;)u.push(c.value);return u}if(r==null)return[r];if(typeof(s=r.length)!="number")return[r];for(u=new Array(s);s--;)u[s]=r[s];return u}for(s=arguments.length,u=new Array(s);s--;)u[s]=arguments[s];return u}var Wt=typeof Symbol<"u"?function(r){return r[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},On=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Qe=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(On),Ea={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Qt(r,s){this.name=r,this.message=s}function xs(r,s){return r+". Errors: "+Object.keys(s).map(function(u){return s[u].toString()}).filter(function(u,c,h){return h.indexOf(u)===c}).join(`
`)}function nr(r,s,u,c){this.failures=s,this.failedKeys=c,this.successCount=u,this.message=xs(r,s)}function Yt(r,s){this.name="BulkError",this.failures=Object.keys(s).map(function(u){return s[u]}),this.failuresByPos=s,this.message=xs(r,this.failures)}L(Qt).from(Error).extend({toString:function(){return this.name+": "+this.message}}),L(nr).from(Qt),L(Yt).from(Qt);var Yr=Qe.reduce(function(r,s){return r[s]=s+"Error",r},{}),Aa=Qt,X=Qe.reduce(function(r,s){var u=s+"Error";function c(h,d){this.name=u,h?typeof h=="string"?(this.message="".concat(h).concat(d?`
 `+d:""),this.inner=d||null):typeof h=="object"&&(this.message="".concat(h.name," ").concat(h.message),this.inner=h):(this.message=Ea[s]||u,this.inner=null)}return L(c).from(Aa),r[s]=c,r},{});X.Syntax=SyntaxError,X.Type=TypeError,X.Range=RangeError;var Es=On.reduce(function(r,s){return r[s+"Error"]=X[s],r},{}),rr=Qe.reduce(function(r,s){return["Syntax","Type","Range"].indexOf(s)===-1&&(r[s+"Error"]=X[s]),r},{});function ye(){}function An(r){return r}function Pa(r,s){return r==null||r===An?s:function(u){return s(r(u))}}function St(r,s){return function(){r.apply(this,arguments),s.apply(this,arguments)}}function Oa(r,s){return r===ye?s:function(){var u=r.apply(this,arguments);u!==void 0&&(arguments[0]=u);var c=this.onsuccess,h=this.onerror;this.onsuccess=null,this.onerror=null;var d=s.apply(this,arguments);return c&&(this.onsuccess=this.onsuccess?St(c,this.onsuccess):c),h&&(this.onerror=this.onerror?St(h,this.onerror):h),d!==void 0?d:u}}function Sa(r,s){return r===ye?s:function(){r.apply(this,arguments);var u=this.onsuccess,c=this.onerror;this.onsuccess=this.onerror=null,s.apply(this,arguments),u&&(this.onsuccess=this.onsuccess?St(u,this.onsuccess):u),c&&(this.onerror=this.onerror?St(c,this.onerror):c)}}function Ca(r,s){return r===ye?s:function(u){var c=r.apply(this,arguments);p(u,c);var h=this.onsuccess,d=this.onerror;return this.onsuccess=null,this.onerror=null,u=s.apply(this,arguments),h&&(this.onsuccess=this.onsuccess?St(h,this.onsuccess):h),d&&(this.onerror=this.onerror?St(d,this.onerror):d),c===void 0?u===void 0?void 0:u:p(c,u)}}function Ra(r,s){return r===ye?s:function(){return s.apply(this,arguments)!==!1&&r.apply(this,arguments)}}function Xr(r,s){return r===ye?s:function(){var u=r.apply(this,arguments);if(u&&typeof u.then=="function"){for(var c=this,h=arguments.length,d=new Array(h);h--;)d[h]=arguments[h];return u.then(function(){return s.apply(c,d)})}return s.apply(this,arguments)}}rr.ModifyError=nr,rr.DexieError=Qt,rr.BulkError=Yt;var it=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function As(r){it=r}var Pn={},Ps=100,ht=typeof Promise>"u"?[]:function(){var r=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[r,g(r),r];var s=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[s,g(s),r]}(),On=ht[0],Qe=ht[1],ht=ht[2],Qe=Qe&&Qe.then,Ct=On&&On.constructor,Jr=!!ht,Sn=function(r,s){Cn.push([r,s]),ir&&(queueMicrotask(Na),ir=!1)},Zr=!0,ir=!0,Rt=[],sr=[],ei=An,yt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ye,pgp:!1,env:{},finalize:ye},Q=yt,Cn=[],Tt=0,or=[];function z(r){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var s=this._PSD=Q;if(typeof r!="function"){if(r!==Pn)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&ni(this,this._value))}this._state=null,this._value=null,++s.ref,function u(c,h){try{h(function(d){if(c._state===null){if(d===c)throw new TypeError("A promise cannot be resolved with itself.");var m=c._lib&&Xt();d&&typeof d.then=="function"?u(c,function(y,b){d instanceof z?d._then(y,b):d.then(y,b)}):(c._state=!0,c._value=d,Ss(c)),m&&Jt()}},ni.bind(null,c))}catch(d){ni(c,d)}}(this,r)}var ti={get:function(){var r=Q,s=lr;function u(c,h){var d=this,m=!r.global&&(r!==Q||s!==lr),y=m&&!vt(),b=new z(function(k,A){ri(d,new Os(Rs(c,r,m,y),Rs(h,r,m,y),k,A,r))});return this._consoleTask&&(b._consoleTask=this._consoleTask),b}return u.prototype=Pn,u},set:function(r){V(this,"then",r&&r.prototype===Pn?ti:{get:function(){return r},set:ti.set})}};function Os(r,s,u,c,h){this.onFulfilled=typeof r=="function"?r:null,this.onRejected=typeof s=="function"?s:null,this.resolve=u,this.reject=c,this.psd=h}function ni(r,s){var u,c;sr.push(s),r._state===null&&(u=r._lib&&Xt(),s=ei(s),r._state=!1,r._value=s,c=r,Rt.some(function(h){return h._value===c._value})||Rt.push(c),Ss(r),u&&Jt())}function Ss(r){var s=r._listeners;r._listeners=[];for(var u=0,c=s.length;u<c;++u)ri(r,s[u]);var h=r._PSD;--h.ref||h.finalize(),Tt===0&&(++Tt,Sn(function(){--Tt==0&&ii()},[]))}function ri(r,s){if(r._state!==null){var u=r._state?s.onFulfilled:s.onRejected;if(u===null)return(r._state?s.resolve:s.reject)(r._value);++s.psd.ref,++Tt,Sn(Ta,[u,r,s])}else r._listeners.push(s)}function Ta(r,s,u){try{var c,h=s._value;!s._state&&sr.length&&(sr=[]),c=it&&s._consoleTask?s._consoleTask.run(function(){return r(h)}):r(h),s._state||sr.indexOf(h)!==-1||function(d){for(var m=Rt.length;m;)if(Rt[--m]._value===d._value)return Rt.splice(m,1)}(s),u.resolve(c)}catch(d){u.reject(d)}finally{--Tt==0&&ii(),--u.psd.ref||u.psd.finalize()}}function Na(){Nt(yt,function(){Xt()&&Jt()})}function Xt(){var r=Zr;return ir=Zr=!1,r}function Jt(){var r,s,u;do for(;0<Cn.length;)for(r=Cn,Cn=[],u=r.length,s=0;s<u;++s){var c=r[s];c[0].apply(null,c[1])}while(0<Cn.length);ir=Zr=!0}function ii(){var r=Rt;Rt=[],r.forEach(function(c){c._PSD.onunhandled.call(null,c._value,c)});for(var s=or.slice(0),u=s.length;u;)s[--u]()}function ar(r){return new z(Pn,!1,r)}function Ee(r,s){var u=Q;return function(){var c=Xt(),h=Q;try{return bt(u,!0),r.apply(this,arguments)}catch(d){s&&s(d)}finally{bt(h,!1),c&&Jt()}}}D(z.prototype,{then:ti,_then:function(r,s){ri(this,new Os(null,null,r,s,Q))},catch:function(r){if(arguments.length===1)return this.then(null,r);var s=r,u=arguments[1];return typeof s=="function"?this.then(null,function(c){return(c instanceof s?u:ar)(c)}):this.then(null,function(c){return(c&&c.name===s?u:ar)(c)})},finally:function(r){return this.then(function(s){return z.resolve(r()).then(function(){return s})},function(s){return z.resolve(r()).then(function(){return ar(s)})})},timeout:function(r,s){var u=this;return r<1/0?new z(function(c,h){var d=setTimeout(function(){return h(new X.Timeout(s))},r);u.then(c,h).finally(clearTimeout.bind(null,d))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&V(z.prototype,Symbol.toStringTag,"Dexie.Promise"),yt.env=Cs(),D(z,{all:function(){var r=Me.apply(null,arguments).map(fr);return new z(function(s,u){r.length===0&&s([]);var c=r.length;r.forEach(function(h,d){return z.resolve(h).then(function(m){r[d]=m,--c||s(r)},u)})})},resolve:function(r){return r instanceof z?r:r&&typeof r.then=="function"?new z(function(s,u){r.then(s,u)}):new z(Pn,!0,r)},reject:ar,race:function(){var r=Me.apply(null,arguments).map(fr);return new z(function(s,u){r.map(function(c){return z.resolve(c).then(s,u)})})},PSD:{get:function(){return Q},set:function(r){return Q=r}},totalEchoes:{get:function(){return lr}},newPSD:gt,usePSD:Nt,scheduler:{get:function(){return Sn},set:function(r){Sn=r}},rejectionMapper:{get:function(){return ei},set:function(r){ei=r}},follow:function(r,s){return new z(function(u,c){return gt(function(h,d){var m=Q;m.unhandleds=[],m.onunhandled=d,m.finalize=St(function(){var y,b=this;y=function(){b.unhandleds.length===0?h():d(b.unhandleds[0])},or.push(function k(){y(),or.splice(or.indexOf(k),1)}),++Tt,Sn(function(){--Tt==0&&ii()},[])},m.finalize),r()},s,u,c)})}}),Ct&&(Ct.allSettled&&V(z,"allSettled",function(){var r=Me.apply(null,arguments).map(fr);return new z(function(s){r.length===0&&s([]);var u=r.length,c=new Array(u);r.forEach(function(h,d){return z.resolve(h).then(function(m){return c[d]={status:"fulfilled",value:m}},function(m){return c[d]={status:"rejected",reason:m}}).then(function(){return--u||s(c)})})})}),Ct.any&&typeof AggregateError<"u"&&V(z,"any",function(){var r=Me.apply(null,arguments).map(fr);return new z(function(s,u){r.length===0&&u(new AggregateError([]));var c=r.length,h=new Array(c);r.forEach(function(d,m){return z.resolve(d).then(function(y){return s(y)},function(y){h[m]=y,--c||u(new AggregateError(h))})})})}),Ct.withResolvers&&(z.withResolvers=Ct.withResolvers));var Te={awaits:0,echoes:0,id:0},Ma=0,ur=[],cr=0,lr=0,Da=0;function gt(r,s,u,c){var h=Q,d=Object.create(h);return d.parent=h,d.ref=0,d.global=!1,d.id=++Da,yt.env,d.env=Jr?{Promise:z,PromiseProp:{value:z,configurable:!0,writable:!0},all:z.all,race:z.race,allSettled:z.allSettled,any:z.any,resolve:z.resolve,reject:z.reject}:{},s&&p(d,s),++h.ref,d.finalize=function(){--this.parent.ref||this.parent.finalize()},c=Nt(d,r,u,c),d.ref===0&&d.finalize(),c}function Zt(){return Te.id||(Te.id=++Ma),++Te.awaits,Te.echoes+=Ps,Te.id}function vt(){return!!Te.awaits&&(--Te.awaits==0&&(Te.id=0),Te.echoes=Te.awaits*Ps,!0)}function fr(r){return Te.echoes&&r&&r.constructor===Ct?(Zt(),r.then(function(s){return vt(),s},function(s){return vt(),Oe(s)})):r}function Ia(){var r=ur[ur.length-1];ur.pop(),bt(r,!1)}function bt(r,s){var u,c=Q;(s?!Te.echoes||cr++&&r===Q:!cr||--cr&&r===Q)||queueMicrotask(s?function(h){++lr,Te.echoes&&--Te.echoes!=0||(Te.echoes=Te.awaits=Te.id=0),ur.push(Q),bt(h,!0)}.bind(null,r):Ia),r!==Q&&(Q=r,c===yt&&(yt.env=Cs()),Jr&&(u=yt.env.Promise,s=r.env,(c.global||r.global)&&(Object.defineProperty(a,"Promise",s.PromiseProp),u.all=s.all,u.race=s.race,u.resolve=s.resolve,u.reject=s.reject,s.allSettled&&(u.allSettled=s.allSettled),s.any&&(u.any=s.any))))}function Cs(){var r=a.Promise;return Jr?{Promise:r,PromiseProp:Object.getOwnPropertyDescriptor(a,"Promise"),all:r.all,race:r.race,allSettled:r.allSettled,any:r.any,resolve:r.resolve,reject:r.reject}:{}}function Nt(r,s,u,c,h){var d=Q;try{return bt(r,!0),s(u,c,h)}finally{bt(d,!1)}}function Rs(r,s,u,c){return typeof r!="function"?r:function(){var h=Q;u&&Zt(),bt(s,!0);try{return r.apply(this,arguments)}finally{bt(h,!1),c&&queueMicrotask(vt)}}}function si(r){Promise===Ct&&Te.echoes===0?cr===0?r():enqueueNativeMicroTask(r):setTimeout(r,0)}(""+Qe).indexOf("[native code]")===-1&&(Zt=vt=ye);var Oe=z.reject,Mt="",ft="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Ts="String expected.",en=[],hr="__dbnames",oi="readonly",ai="readwrite";function Dt(r,s){return r?s?function(){return r.apply(this,arguments)&&s.apply(this,arguments)}:r:s}var Ns={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function dr(r){return typeof r!="string"||/\./.test(r)?function(s){return s}:function(s){return s[r]===void 0&&r in s&&delete(s=ce(s))[r],s}}function Ms(){throw X.Type()}function le(r,s){try{var u=Ds(r),c=Ds(s);if(u!==c)return u==="Array"?1:c==="Array"?-1:u==="binary"?1:c==="binary"?-1:u==="string"?1:c==="string"?-1:u==="Date"?1:c!=="Date"?NaN:-1;switch(u){case"number":case"Date":case"string":return s<r?1:r<s?-1:0;case"binary":return function(h,d){for(var m=h.length,y=d.length,b=m<y?m:y,k=0;k<b;++k)if(h[k]!==d[k])return h[k]<d[k]?-1:1;return m===y?0:m<y?-1:1}(Is(r),Is(s));case"Array":return function(h,d){for(var m=h.length,y=d.length,b=m<y?m:y,k=0;k<b;++k){var A=le(h[k],d[k]);if(A!==0)return A}return m===y?0:m<y?-1:1}(r,s)}}catch{}return NaN}function Ds(r){var s=typeof r;return s!="object"?s:ArrayBuffer.isView(r)?"binary":(r=qe(r),r==="ArrayBuffer"?"binary":r)}function Is(r){return r instanceof Uint8Array?r:ArrayBuffer.isView(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):new Uint8Array(r)}var Ks=(we.prototype._trans=function(r,s,u){var c=this._tx||Q.trans,h=this.name,d=it&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(r==="readonly"?"read":"write"," ").concat(this.name));function m(k,A,v){if(!v.schema[h])throw new X.NotFound("Table "+h+" not part of transaction");return s(v.idbtrans,v)}var y=Xt();try{var b=c&&c.db._novip===this.db._novip?c===Q.trans?c._promise(r,m,u):gt(function(){return c._promise(r,m,u)},{trans:c,transless:Q.transless||Q}):function k(A,v,O,_){if(A.idbdb&&(A._state.openComplete||Q.letThrough||A._vip)){var E=A._createTransaction(v,O,A._dbSchema);try{E.create(),A._state.PR1398_maxLoop=3}catch(P){return P.name===Yr.InvalidState&&A.isOpen()&&0<--A._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),A.close({disableAutoOpen:!1}),A.open().then(function(){return k(A,v,O,_)})):Oe(P)}return E._promise(v,function(P,x){return gt(function(){return Q.trans=E,_(P,x,E)})}).then(function(P){if(v==="readwrite")try{E.idbtrans.commit()}catch{}return v==="readonly"?P:E._completion.then(function(){return P})})}if(A._state.openComplete)return Oe(new X.DatabaseClosed(A._state.dbOpenError));if(!A._state.isBeingOpened){if(!A._state.autoOpen)return Oe(new X.DatabaseClosed);A.open().catch(ye)}return A._state.dbReadyPromise.then(function(){return k(A,v,O,_)})}(this.db,r,[this.name],m);return d&&(b._consoleTask=d,b=b.catch(function(k){return console.trace(k),Oe(k)})),b}finally{y&&Jt()}},we.prototype.get=function(r,s){var u=this;return r&&r.constructor===Object?this.where(r).first(s):r==null?Oe(new X.Type("Invalid argument to Table.get()")):this._trans("readonly",function(c){return u.core.get({trans:c,key:r}).then(function(h){return u.hook.reading.fire(h)})}).then(s)},we.prototype.where=function(r){if(typeof r=="string")return new this.db.WhereClause(this,r);if(f(r))return new this.db.WhereClause(this,"[".concat(r.join("+"),"]"));var s=l(r);if(s.length===1)return this.where(s[0]).equals(r[s[0]]);var u=this.schema.indexes.concat(this.schema.primKey).filter(function(y){if(y.compound&&s.every(function(k){return 0<=y.keyPath.indexOf(k)})){for(var b=0;b<s.length;++b)if(s.indexOf(y.keyPath[b])===-1)return!1;return!0}return!1}).sort(function(y,b){return y.keyPath.length-b.keyPath.length})[0];if(u&&this.db._maxKey!==Mt){var d=u.keyPath.slice(0,s.length);return this.where(d).equals(d.map(function(b){return r[b]}))}!u&&it&&console.warn("The query ".concat(JSON.stringify(r)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(s.join("+"),"]"));var c=this.schema.idxByName;function h(y,b){return le(y,b)===0}var m=s.reduce(function(v,b){var k=v[0],A=v[1],v=c[b],O=r[b];return[k||v,k||!v?Dt(A,v&&v.multi?function(_){return _=_e(_,b),f(_)&&_.some(function(E){return h(O,E)})}:function(_){return h(O,_e(_,b))}):A]},[null,null]),d=m[0],m=m[1];return d?this.where(d.name).equals(r[d.keyPath]).filter(m):u?this.filter(m):this.where(s).equals("")},we.prototype.filter=function(r){return this.toCollection().and(r)},we.prototype.count=function(r){return this.toCollection().count(r)},we.prototype.offset=function(r){return this.toCollection().offset(r)},we.prototype.limit=function(r){return this.toCollection().limit(r)},we.prototype.each=function(r){return this.toCollection().each(r)},we.prototype.toArray=function(r){return this.toCollection().toArray(r)},we.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},we.prototype.orderBy=function(r){return new this.db.Collection(new this.db.WhereClause(this,f(r)?"[".concat(r.join("+"),"]"):r))},we.prototype.reverse=function(){return this.toCollection().reverse()},we.prototype.mapToClass=function(r){var s,u=this.db,c=this.name;function h(){return s!==null&&s.apply(this,arguments)||this}(this.schema.mappedClass=r).prototype instanceof Ms&&(function(b,k){if(typeof k!="function"&&k!==null)throw new TypeError("Class extends value "+String(k)+" is not a constructor or null");function A(){this.constructor=b}n(b,k),b.prototype=k===null?Object.create(k):(A.prototype=k.prototype,new A)}(h,s=r),Object.defineProperty(h.prototype,"db",{get:function(){return u},enumerable:!1,configurable:!0}),h.prototype.table=function(){return c},r=h);for(var d=new Set,m=r.prototype;m;m=g(m))Object.getOwnPropertyNames(m).forEach(function(b){return d.add(b)});function y(b){if(!b)return b;var k,A=Object.create(r.prototype);for(k in b)if(!d.has(k))try{A[k]=b[k]}catch{}return A}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=y,this.hook("reading",y),r},we.prototype.defineClass=function(){return this.mapToClass(function(r){p(this,r)})},we.prototype.add=function(r,s){var u=this,c=this.schema.primKey,h=c.auto,d=c.keyPath,m=r;return d&&h&&(m=dr(d)(r)),this._trans("readwrite",function(y){return u.core.mutate({trans:y,type:"add",keys:s!=null?[s]:null,values:[m]})}).then(function(y){return y.numFailures?z.reject(y.failures[0]):y.lastResult}).then(function(y){if(d)try{Ae(r,d,y)}catch{}return y})},we.prototype.update=function(r,s){return typeof r!="object"||f(r)?this.where(":id").equals(r).modify(s):(r=_e(r,this.schema.primKey.keyPath),r===void 0?Oe(new X.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(r).modify(s))},we.prototype.put=function(r,s){var u=this,c=this.schema.primKey,h=c.auto,d=c.keyPath,m=r;return d&&h&&(m=dr(d)(r)),this._trans("readwrite",function(y){return u.core.mutate({trans:y,type:"put",values:[m],keys:s!=null?[s]:null})}).then(function(y){return y.numFailures?z.reject(y.failures[0]):y.lastResult}).then(function(y){if(d)try{Ae(r,d,y)}catch{}return y})},we.prototype.delete=function(r){var s=this;return this._trans("readwrite",function(u){return s.core.mutate({trans:u,type:"delete",keys:[r]})}).then(function(u){return u.numFailures?z.reject(u.failures[0]):void 0})},we.prototype.clear=function(){var r=this;return this._trans("readwrite",function(s){return r.core.mutate({trans:s,type:"deleteRange",range:Ns})}).then(function(s){return s.numFailures?z.reject(s.failures[0]):void 0})},we.prototype.bulkGet=function(r){var s=this;return this._trans("readonly",function(u){return s.core.getMany({keys:r,trans:u}).then(function(c){return c.map(function(h){return s.hook.reading.fire(h)})})})},we.prototype.bulkAdd=function(r,s,u){var c=this,h=Array.isArray(s)?s:void 0,d=(u=u||(h?void 0:s))?u.allKeys:void 0;return this._trans("readwrite",function(m){var k=c.schema.primKey,y=k.auto,k=k.keyPath;if(k&&h)throw new X.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(h&&h.length!==r.length)throw new X.InvalidArgument("Arguments objects and keys must have the same length");var b=r.length,k=k&&y?r.map(dr(k)):r;return c.core.mutate({trans:m,type:"add",keys:h,values:k,wantResults:d}).then(function(E){var v=E.numFailures,O=E.results,_=E.lastResult,E=E.failures;if(v===0)return d?O:_;throw new Yt("".concat(c.name,".bulkAdd(): ").concat(v," of ").concat(b," operations failed"),E)})})},we.prototype.bulkPut=function(r,s,u){var c=this,h=Array.isArray(s)?s:void 0,d=(u=u||(h?void 0:s))?u.allKeys:void 0;return this._trans("readwrite",function(m){var k=c.schema.primKey,y=k.auto,k=k.keyPath;if(k&&h)throw new X.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(h&&h.length!==r.length)throw new X.InvalidArgument("Arguments objects and keys must have the same length");var b=r.length,k=k&&y?r.map(dr(k)):r;return c.core.mutate({trans:m,type:"put",keys:h,values:k,wantResults:d}).then(function(E){var v=E.numFailures,O=E.results,_=E.lastResult,E=E.failures;if(v===0)return d?O:_;throw new Yt("".concat(c.name,".bulkPut(): ").concat(v," of ").concat(b," operations failed"),E)})})},we.prototype.bulkUpdate=function(r){var s=this,u=this.core,c=r.map(function(m){return m.key}),h=r.map(function(m){return m.changes}),d=[];return this._trans("readwrite",function(m){return u.getMany({trans:m,keys:c,cache:"clone"}).then(function(y){var b=[],k=[];r.forEach(function(v,O){var _=v.key,E=v.changes,P=y[O];if(P){for(var x=0,C=Object.keys(E);x<C.length;x++){var R=C[x],T=E[R];if(R===s.schema.primKey.keyPath){if(le(T,_)!==0)throw new X.Constraint("Cannot update primary key in bulkUpdate()")}else Ae(P,R,T)}d.push(O),b.push(_),k.push(P)}});var A=b.length;return u.mutate({trans:m,type:"put",keys:b,values:k,updates:{keys:c,changeSpecs:h}}).then(function(v){var O=v.numFailures,_=v.failures;if(O===0)return A;for(var E=0,P=Object.keys(_);E<P.length;E++){var x,C=P[E],R=d[Number(C)];R!=null&&(x=_[C],delete _[C],_[R]=x)}throw new Yt("".concat(s.name,".bulkUpdate(): ").concat(O," of ").concat(A," operations failed"),_)})})})},we.prototype.bulkDelete=function(r){var s=this,u=r.length;return this._trans("readwrite",function(c){return s.core.mutate({trans:c,type:"delete",keys:r})}).then(function(m){var h=m.numFailures,d=m.lastResult,m=m.failures;if(h===0)return d;throw new Yt("".concat(s.name,".bulkDelete(): ").concat(h," of ").concat(u," operations failed"),m)})},we);function we(){}function Rn(r){function s(m,y){if(y){for(var b=arguments.length,k=new Array(b-1);--b;)k[b-1]=arguments[b];return u[m].subscribe.apply(null,k),r}if(typeof m=="string")return u[m]}var u={};s.addEventType=d;for(var c=1,h=arguments.length;c<h;++c)d(arguments[c]);return s;function d(m,y,b){if(typeof m!="object"){var k;y=y||Ra;var A={subscribers:[],fire:b=b||ye,subscribe:function(v){A.subscribers.indexOf(v)===-1&&(A.subscribers.push(v),A.fire=y(A.fire,v))},unsubscribe:function(v){A.subscribers=A.subscribers.filter(function(O){return O!==v}),A.fire=A.subscribers.reduce(y,b)}};return u[m]=s[m]=A}l(k=m).forEach(function(v){var O=k[v];if(f(O))d(v,k[v][0],k[v][1]);else{if(O!=="asap")throw new X.InvalidArgument("Invalid event config");var _=d(v,An,function(){for(var E=arguments.length,P=new Array(E);E--;)P[E]=arguments[E];_.subscribers.forEach(function(x){pe(function(){x.apply(null,P)})})})}})}}function Tn(r,s){return L(s).from({prototype:r}),s}function tn(r,s){return!(r.filter||r.algorithm||r.or)&&(s?r.justLimit:!r.replayFilter)}function ui(r,s){r.filter=Dt(r.filter,s)}function ci(r,s,u){var c=r.replayFilter;r.replayFilter=c?function(){return Dt(c(),s())}:s,r.justLimit=u&&!c}function pr(r,s){if(r.isPrimKey)return s.primaryKey;var u=s.getIndexByKeyPath(r.index);if(!u)throw new X.Schema("KeyPath "+r.index+" on object store "+s.name+" is not indexed");return u}function js(r,s,u){var c=pr(r,s.schema);return s.openCursor({trans:u,values:!r.keysOnly,reverse:r.dir==="prev",unique:!!r.unique,query:{index:c,range:r.range}})}function mr(r,s,u,c){var h=r.replayFilter?Dt(r.filter,r.replayFilter()):r.filter;if(r.or){var d={},m=function(y,b,k){var A,v;h&&!h(b,k,function(O){return b.stop(O)},function(O){return b.fail(O)})||((v=""+(A=b.primaryKey))=="[object ArrayBuffer]"&&(v=""+new Uint8Array(A)),S(d,v)||(d[v]=!0,s(y,b,k)))};return Promise.all([r.or._iterate(m,u),Bs(js(r,c,u),r.algorithm,m,!r.keysOnly&&r.valueMapper)])}return Bs(js(r,c,u),Dt(r.algorithm,h),s,!r.keysOnly&&r.valueMapper)}function Bs(r,s,u,c){var h=Ee(c?function(d,m,y){return u(c(d),m,y)}:u);return r.then(function(d){if(d)return d.start(function(){var m=function(){return d.continue()};s&&!s(d,function(y){return m=y},function(y){d.stop(y),m=ye},function(y){d.fail(y),m=ye})||h(d.value,d,function(y){return m=y}),m()})})}var ht=Symbol(),Nn=(Ls.prototype.execute=function(r){if(this.add!==void 0){var s=this.add;if(f(s))return o(o([],f(r)?r:[],!0),s).sort();if(typeof s=="number")return(Number(r)||0)+s;if(typeof s=="bigint")try{return BigInt(r)+s}catch{return BigInt(0)+s}throw new TypeError("Invalid term ".concat(s))}if(this.remove!==void 0){var u=this.remove;if(f(u))return f(r)?r.filter(function(c){return!u.includes(c)}).sort():[];if(typeof u=="number")return Number(r)-u;if(typeof u=="bigint")try{return BigInt(r)-u}catch{return BigInt(0)-u}throw new TypeError("Invalid subtrahend ".concat(u))}return s=(s=this.replacePrefix)===null||s===void 0?void 0:s[0],s&&typeof r=="string"&&r.startsWith(s)?this.replacePrefix[1]+r.substring(s.length):r},Ls);function Ls(r){Object.assign(this,r)}var Ka=(de.prototype._read=function(r,s){var u=this._ctx;return u.error?u.table._trans(null,Oe.bind(null,u.error)):u.table._trans("readonly",r).then(s)},de.prototype._write=function(r){var s=this._ctx;return s.error?s.table._trans(null,Oe.bind(null,s.error)):s.table._trans("readwrite",r,"locked")},de.prototype._addAlgorithm=function(r){var s=this._ctx;s.algorithm=Dt(s.algorithm,r)},de.prototype._iterate=function(r,s){return mr(this._ctx,r,s,this._ctx.table.core)},de.prototype.clone=function(r){var s=Object.create(this.constructor.prototype),u=Object.create(this._ctx);return r&&p(u,r),s._ctx=u,s},de.prototype.raw=function(){return this._ctx.valueMapper=null,this},de.prototype.each=function(r){var s=this._ctx;return this._read(function(u){return mr(s,r,u,s.table.core)})},de.prototype.count=function(r){var s=this;return this._read(function(u){var c=s._ctx,h=c.table.core;if(tn(c,!0))return h.count({trans:u,query:{index:pr(c,h.schema),range:c.range}}).then(function(m){return Math.min(m,c.limit)});var d=0;return mr(c,function(){return++d,!1},u,h).then(function(){return d})}).then(r)},de.prototype.sortBy=function(r,s){var u=r.split(".").reverse(),c=u[0],h=u.length-1;function d(b,k){return k?d(b[u[k]],k-1):b[c]}var m=this._ctx.dir==="next"?1:-1;function y(b,k){return le(d(b,h),d(k,h))*m}return this.toArray(function(b){return b.sort(y)}).then(s)},de.prototype.toArray=function(r){var s=this;return this._read(function(u){var c=s._ctx;if(c.dir==="next"&&tn(c,!0)&&0<c.limit){var h=c.valueMapper,d=pr(c,c.table.core.schema);return c.table.core.query({trans:u,limit:c.limit,values:!0,query:{index:d,range:c.range}}).then(function(y){return y=y.result,h?y.map(h):y})}var m=[];return mr(c,function(y){return m.push(y)},u,c.table.core).then(function(){return m})},r)},de.prototype.offset=function(r){var s=this._ctx;return r<=0||(s.offset+=r,tn(s)?ci(s,function(){var u=r;return function(c,h){return u===0||(u===1?--u:h(function(){c.advance(u),u=0}),!1)}}):ci(s,function(){var u=r;return function(){return--u<0}})),this},de.prototype.limit=function(r){return this._ctx.limit=Math.min(this._ctx.limit,r),ci(this._ctx,function(){var s=r;return function(u,c,h){return--s<=0&&c(h),0<=s}},!0),this},de.prototype.until=function(r,s){return ui(this._ctx,function(u,c,h){return!r(u.value)||(c(h),s)}),this},de.prototype.first=function(r){return this.limit(1).toArray(function(s){return s[0]}).then(r)},de.prototype.last=function(r){return this.reverse().first(r)},de.prototype.filter=function(r){var s;return ui(this._ctx,function(u){return r(u.value)}),(s=this._ctx).isMatch=Dt(s.isMatch,r),this},de.prototype.and=function(r){return this.filter(r)},de.prototype.or=function(r){return new this.db.WhereClause(this._ctx.table,r,this)},de.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},de.prototype.desc=function(){return this.reverse()},de.prototype.eachKey=function(r){var s=this._ctx;return s.keysOnly=!s.isMatch,this.each(function(u,c){r(c.key,c)})},de.prototype.eachUniqueKey=function(r){return this._ctx.unique="unique",this.eachKey(r)},de.prototype.eachPrimaryKey=function(r){var s=this._ctx;return s.keysOnly=!s.isMatch,this.each(function(u,c){r(c.primaryKey,c)})},de.prototype.keys=function(r){var s=this._ctx;s.keysOnly=!s.isMatch;var u=[];return this.each(function(c,h){u.push(h.key)}).then(function(){return u}).then(r)},de.prototype.primaryKeys=function(r){var s=this._ctx;if(s.dir==="next"&&tn(s,!0)&&0<s.limit)return this._read(function(c){var h=pr(s,s.table.core.schema);return s.table.core.query({trans:c,values:!1,limit:s.limit,query:{index:h,range:s.range}})}).then(function(c){return c.result}).then(r);s.keysOnly=!s.isMatch;var u=[];return this.each(function(c,h){u.push(h.primaryKey)}).then(function(){return u}).then(r)},de.prototype.uniqueKeys=function(r){return this._ctx.unique="unique",this.keys(r)},de.prototype.firstKey=function(r){return this.limit(1).keys(function(s){return s[0]}).then(r)},de.prototype.lastKey=function(r){return this.reverse().firstKey(r)},de.prototype.distinct=function(){var r=this._ctx,r=r.index&&r.table.schema.idxByName[r.index];if(!r||!r.multi)return this;var s={};return ui(this._ctx,function(h){var c=h.primaryKey.toString(),h=S(s,c);return s[c]=!0,!h}),this},de.prototype.modify=function(r){var s=this,u=this._ctx;return this._write(function(c){var h,d,m;m=typeof r=="function"?r:(h=l(r),d=h.length,function(x){for(var C=!1,R=0;R<d;++R){var T=h[R],N=r[T],K=_e(x,T);N instanceof Nn?(Ae(x,T,N.execute(K)),C=!0):K!==N&&(Ae(x,T,N),C=!0)}return C});function y(x,T){var R=T.failures,T=T.numFailures;E+=x-T;for(var N=0,K=l(R);N<K.length;N++){var $=K[N];_.push(R[$])}}var b=u.table.core,k=b.schema.primaryKey,A=k.outbound,v=k.extractKey,O=s.db._options.modifyChunkSize||200,_=[],E=0,P=[];return s.clone().primaryKeys().then(function(x){function C(T){var N=Math.min(O,x.length-T);return b.getMany({trans:c,keys:x.slice(T,T+N),cache:"immutable"}).then(function(K){for(var $=[],j=[],B=A?[]:null,F=[],q=0;q<N;++q){var G=K[q],ee={value:ce(G),primKey:x[T+q]};m.call(ee,ee.value,ee)!==!1&&(ee.value==null?F.push(x[T+q]):A||le(v(G),v(ee.value))===0?(j.push(ee.value),A&&B.push(x[T+q])):(F.push(x[T+q]),$.push(ee.value)))}return Promise.resolve(0<$.length&&b.mutate({trans:c,type:"add",values:$}).then(function(ae){for(var re in ae.failures)F.splice(parseInt(re),1);y($.length,ae)})).then(function(){return(0<j.length||R&&typeof r=="object")&&b.mutate({trans:c,type:"put",keys:B,values:j,criteria:R,changeSpec:typeof r!="function"&&r,isAdditionalChunk:0<T}).then(function(ae){return y(j.length,ae)})}).then(function(){return(0<F.length||R&&r===li)&&b.mutate({trans:c,type:"delete",keys:F,criteria:R,isAdditionalChunk:0<T}).then(function(ae){return y(F.length,ae)})}).then(function(){return x.length>T+N&&C(T+O)})})}var R=tn(u)&&u.limit===1/0&&(typeof r!="function"||r===li)&&{index:u.index,range:u.range};return C(0).then(function(){if(0<_.length)throw new nr("Error modifying one or more objects",_,E,P);return x.length})})})},de.prototype.delete=function(){var r=this._ctx,s=r.range;return tn(r)&&(r.isPrimKey||s.type===3)?this._write(function(u){var c=r.table.core.schema.primaryKey,h=s;return r.table.core.count({trans:u,query:{index:c,range:h}}).then(function(d){return r.table.core.mutate({trans:u,type:"deleteRange",range:h}).then(function(m){var y=m.failures;if(m.lastResult,m.results,m=m.numFailures,m)throw new nr("Could not delete some values",Object.keys(y).map(function(b){return y[b]}),d-m);return d-m})})}):this.modify(li)},de);function de(){}var li=function(r,s){return s.value=null};function ja(r,s){return r<s?-1:r===s?0:1}function Ba(r,s){return s<r?-1:r===s?0:1}function We(r,s,u){return r=r instanceof qs?new r.Collection(r):r,r._ctx.error=new(u||TypeError)(s),r}function nn(r){return new r.Collection(r,function(){return $s("")}).limit(0)}function yr(r,s,u,c){var h,d,m,y,b,k,A,v=u.length;if(!u.every(function(E){return typeof E=="string"}))return We(r,Ts);function O(E){h=E==="next"?function(x){return x.toUpperCase()}:function(x){return x.toLowerCase()},d=E==="next"?function(x){return x.toLowerCase()}:function(x){return x.toUpperCase()},m=E==="next"?ja:Ba;var P=u.map(function(x){return{lower:d(x),upper:h(x)}}).sort(function(x,C){return m(x.lower,C.lower)});y=P.map(function(x){return x.upper}),b=P.map(function(x){return x.lower}),A=(k=E)==="next"?"":c}O("next"),r=new r.Collection(r,function(){return wt(y[0],b[v-1]+c)}),r._ondirectionchange=function(E){O(E)};var _=0;return r._addAlgorithm(function(E,P,x){var C=E.key;if(typeof C!="string")return!1;var R=d(C);if(s(R,b,_))return!0;for(var T=null,N=_;N<v;++N){var K=function($,j,B,F,q,G){for(var ee=Math.min($.length,F.length),ae=-1,re=0;re<ee;++re){var Ze=j[re];if(Ze!==F[re])return q($[re],B[re])<0?$.substr(0,re)+B[re]+B.substr(re+1):q($[re],F[re])<0?$.substr(0,re)+F[re]+B.substr(re+1):0<=ae?$.substr(0,ae)+j[ae]+B.substr(ae+1):null;q($[re],Ze)<0&&(ae=re)}return ee<F.length&&G==="next"?$+B.substr($.length):ee<$.length&&G==="prev"?$.substr(0,B.length):ae<0?null:$.substr(0,ae)+F[ae]+B.substr(ae+1)}(C,R,y[N],b[N],m,k);K===null&&T===null?_=N+1:(T===null||0<m(T,K))&&(T=K)}return P(T!==null?function(){E.continue(T+A)}:x),!1}),r}function wt(r,s,u,c){return{type:2,lower:r,upper:s,lowerOpen:u,upperOpen:c}}function $s(r){return{type:1,lower:r,upper:r}}var qs=(Object.defineProperty(Ne.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Ne.prototype.between=function(r,s,u,c){u=u!==!1,c=c===!0;try{return 0<this._cmp(r,s)||this._cmp(r,s)===0&&(u||c)&&(!u||!c)?nn(this):new this.Collection(this,function(){return wt(r,s,!u,!c)})}catch{return We(this,ft)}},Ne.prototype.equals=function(r){return r==null?We(this,ft):new this.Collection(this,function(){return $s(r)})},Ne.prototype.above=function(r){return r==null?We(this,ft):new this.Collection(this,function(){return wt(r,void 0,!0)})},Ne.prototype.aboveOrEqual=function(r){return r==null?We(this,ft):new this.Collection(this,function(){return wt(r,void 0,!1)})},Ne.prototype.below=function(r){return r==null?We(this,ft):new this.Collection(this,function(){return wt(void 0,r,!1,!0)})},Ne.prototype.belowOrEqual=function(r){return r==null?We(this,ft):new this.Collection(this,function(){return wt(void 0,r)})},Ne.prototype.startsWith=function(r){return typeof r!="string"?We(this,Ts):this.between(r,r+Mt,!0,!0)},Ne.prototype.startsWithIgnoreCase=function(r){return r===""?this.startsWith(r):yr(this,function(s,u){return s.indexOf(u[0])===0},[r],Mt)},Ne.prototype.equalsIgnoreCase=function(r){return yr(this,function(s,u){return s===u[0]},[r],"")},Ne.prototype.anyOfIgnoreCase=function(){var r=Me.apply(Je,arguments);return r.length===0?nn(this):yr(this,function(s,u){return u.indexOf(s)!==-1},r,"")},Ne.prototype.startsWithAnyOfIgnoreCase=function(){var r=Me.apply(Je,arguments);return r.length===0?nn(this):yr(this,function(s,u){return u.some(function(c){return s.indexOf(c)===0})},r,Mt)},Ne.prototype.anyOf=function(){var r=this,s=Me.apply(Je,arguments),u=this._cmp;try{s.sort(u)}catch{return We(this,ft)}if(s.length===0)return nn(this);var c=new this.Collection(this,function(){return wt(s[0],s[s.length-1])});c._ondirectionchange=function(d){u=d==="next"?r._ascending:r._descending,s.sort(u)};var h=0;return c._addAlgorithm(function(d,m,y){for(var b=d.key;0<u(b,s[h]);)if(++h===s.length)return m(y),!1;return u(b,s[h])===0||(m(function(){d.continue(s[h])}),!1)}),c},Ne.prototype.notEqual=function(r){return this.inAnyRange([[-1/0,r],[r,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Ne.prototype.noneOf=function(){var r=Me.apply(Je,arguments);if(r.length===0)return new this.Collection(this);try{r.sort(this._ascending)}catch{return We(this,ft)}var s=r.reduce(function(u,c){return u?u.concat([[u[u.length-1][1],c]]):[[-1/0,c]]},null);return s.push([r[r.length-1],this.db._maxKey]),this.inAnyRange(s,{includeLowers:!1,includeUppers:!1})},Ne.prototype.inAnyRange=function(C,s){var u=this,c=this._cmp,h=this._ascending,d=this._descending,m=this._min,y=this._max;if(C.length===0)return nn(this);if(!C.every(function(R){return R[0]!==void 0&&R[1]!==void 0&&h(R[0],R[1])<=0}))return We(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",X.InvalidArgument);var b=!s||s.includeLowers!==!1,k=s&&s.includeUppers===!0,A,v=h;function O(R,T){return v(R[0],T[0])}try{(A=C.reduce(function(R,T){for(var N=0,K=R.length;N<K;++N){var $=R[N];if(c(T[0],$[1])<0&&0<c(T[1],$[0])){$[0]=m($[0],T[0]),$[1]=y($[1],T[1]);break}}return N===K&&R.push(T),R},[])).sort(O)}catch{return We(this,ft)}var _=0,E=k?function(R){return 0<h(R,A[_][1])}:function(R){return 0<=h(R,A[_][1])},P=b?function(R){return 0<d(R,A[_][0])}:function(R){return 0<=d(R,A[_][0])},x=E,C=new this.Collection(this,function(){return wt(A[0][0],A[A.length-1][1],!b,!k)});return C._ondirectionchange=function(R){v=R==="next"?(x=E,h):(x=P,d),A.sort(O)},C._addAlgorithm(function(R,T,N){for(var K,$=R.key;x($);)if(++_===A.length)return T(N),!1;return!E(K=$)&&!P(K)||(u._cmp($,A[_][1])===0||u._cmp($,A[_][0])===0||T(function(){v===h?R.continue(A[_][0]):R.continue(A[_][1])}),!1)}),C},Ne.prototype.startsWithAnyOf=function(){var r=Me.apply(Je,arguments);return r.every(function(s){return typeof s=="string"})?r.length===0?nn(this):this.inAnyRange(r.map(function(s){return[s,s+Mt]})):We(this,"startsWithAnyOf() only works with strings")},Ne);function Ne(){}function st(r){return Ee(function(s){return Mn(s),r(s.target.error),!1})}function Mn(r){r.stopPropagation&&r.stopPropagation(),r.preventDefault&&r.preventDefault()}var Dn="storagemutated",fi="x-storagemutated-1",_t=Rn(null,Dn),La=(ot.prototype._lock=function(){return oe(!Q.global),++this._reculock,this._reculock!==1||Q.global||(Q.lockOwnerFor=this),this},ot.prototype._unlock=function(){if(oe(!Q.global),--this._reculock==0)for(Q.global||(Q.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var r=this._blockedFuncs.shift();try{Nt(r[1],r[0])}catch{}}return this},ot.prototype._locked=function(){return this._reculock&&Q.lockOwnerFor!==this},ot.prototype.create=function(r){var s=this;if(!this.mode)return this;var u=this.db.idbdb,c=this.db._state.dbOpenError;if(oe(!this.idbtrans),!r&&!u)switch(c&&c.name){case"DatabaseClosedError":throw new X.DatabaseClosed(c);case"MissingAPIError":throw new X.MissingAPI(c.message,c);default:throw new X.OpenFailed(c)}if(!this.active)throw new X.TransactionInactive;return oe(this._completion._state===null),(r=this.idbtrans=r||(this.db.core||u).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Ee(function(h){Mn(h),s._reject(r.error)}),r.onabort=Ee(function(h){Mn(h),s.active&&s._reject(new X.Abort(r.error)),s.active=!1,s.on("abort").fire(h)}),r.oncomplete=Ee(function(){s.active=!1,s._resolve(),"mutatedParts"in r&&_t.storagemutated.fire(r.mutatedParts)}),this},ot.prototype._promise=function(r,s,u){var c=this;if(r==="readwrite"&&this.mode!=="readwrite")return Oe(new X.ReadOnly("Transaction is readonly"));if(!this.active)return Oe(new X.TransactionInactive);if(this._locked())return new z(function(d,m){c._blockedFuncs.push([function(){c._promise(r,s,u).then(d,m)},Q])});if(u)return gt(function(){var d=new z(function(m,y){c._lock();var b=s(m,y,c);b&&b.then&&b.then(m,y)});return d.finally(function(){return c._unlock()}),d._lib=!0,d});var h=new z(function(d,m){var y=s(d,m,c);y&&y.then&&y.then(d,m)});return h._lib=!0,h},ot.prototype._root=function(){return this.parent?this.parent._root():this},ot.prototype.waitFor=function(r){var s,u=this._root(),c=z.resolve(r);u._waitingFor?u._waitingFor=u._waitingFor.then(function(){return c}):(u._waitingFor=c,u._waitingQueue=[],s=u.idbtrans.objectStore(u.storeNames[0]),function d(){for(++u._spinCount;u._waitingQueue.length;)u._waitingQueue.shift()();u._waitingFor&&(s.get(-1/0).onsuccess=d)}());var h=u._waitingFor;return new z(function(d,m){c.then(function(y){return u._waitingQueue.push(Ee(d.bind(null,y)))},function(y){return u._waitingQueue.push(Ee(m.bind(null,y)))}).finally(function(){u._waitingFor===h&&(u._waitingFor=null)})})},ot.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new X.Abort))},ot.prototype.table=function(r){var s=this._memoizedTables||(this._memoizedTables={});if(S(s,r))return s[r];var u=this.schema[r];if(!u)throw new X.NotFound("Table "+r+" not part of transaction");return u=new this.db.Table(r,u,this),u.core=this.db.core.table(r),s[r]=u},ot);function ot(){}function hi(r,s,u,c,h,d,m){return{name:r,keyPath:s,unique:u,multi:c,auto:h,compound:d,src:(u&&!m?"&":"")+(c?"*":"")+(h?"++":"")+Fs(s)}}function Fs(r){return typeof r=="string"?r:r?"["+[].join.call(r,"+")+"]":""}function di(r,s,u){return{name:r,primKey:s,indexes:u,mappedClass:null,idxByName:(c=function(h){return[h.name,h]},u.reduce(function(h,d,m){return m=c(d,m),m&&(h[m[0]]=m[1]),h},{}))};var c}var In=function(r){try{return r.only([[]]),In=function(){return[[]]},[[]]}catch{return In=function(){return Mt},Mt}};function pi(r){return r==null?function(){}:typeof r=="string"?(s=r).split(".").length===1?function(u){return u[s]}:function(u){return _e(u,s)}:function(u){return _e(u,r)};var s}function Us(r){return[].slice.call(r)}var $a=0;function Kn(r){return r==null?":id":typeof r=="string"?r:"[".concat(r.join("+"),"]")}function qa(r,s,b){function c(x){if(x.type===3)return null;if(x.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var _=x.lower,E=x.upper,P=x.lowerOpen,x=x.upperOpen;return _===void 0?E===void 0?null:s.upperBound(E,!!x):E===void 0?s.lowerBound(_,!!P):s.bound(_,E,!!P,!!x)}function h(O){var _,E=O.name;return{name:E,schema:O,mutate:function(P){var x=P.trans,C=P.type,R=P.keys,T=P.values,N=P.range;return new Promise(function(K,$){K=Ee(K);var j=x.objectStore(E),B=j.keyPath==null,F=C==="put"||C==="add";if(!F&&C!=="delete"&&C!=="deleteRange")throw new Error("Invalid operation type: "+C);var q,G=(R||T||{length:1}).length;if(R&&T&&R.length!==T.length)throw new Error("Given keys array must have same length as given values array.");if(G===0)return K({numFailures:0,failures:{},results:[],lastResult:void 0});function ee(Fe){++Ze,Mn(Fe)}var ae=[],re=[],Ze=0;if(C==="deleteRange"){if(N.type===4)return K({numFailures:Ze,failures:re,results:[],lastResult:void 0});N.type===3?ae.push(q=j.clear()):ae.push(q=j.delete(c(N)))}else{var B=F?B?[T,R]:[T,null]:[R,null],ie=B[0],Be=B[1];if(F)for(var Le=0;Le<G;++Le)ae.push(q=Be&&Be[Le]!==void 0?j[C](ie[Le],Be[Le]):j[C](ie[Le])),q.onerror=ee;else for(Le=0;Le<G;++Le)ae.push(q=j[C](ie[Le])),q.onerror=ee}function Cr(Fe){Fe=Fe.target.result,ae.forEach(function(jt,Ni){return jt.error!=null&&(re[Ni]=jt.error)}),K({numFailures:Ze,failures:re,results:C==="delete"?R:ae.map(function(jt){return jt.result}),lastResult:Fe})}q.onerror=function(Fe){ee(Fe),Cr(Fe)},q.onsuccess=Cr})},getMany:function(P){var x=P.trans,C=P.keys;return new Promise(function(R,T){R=Ee(R);for(var N,K=x.objectStore(E),$=C.length,j=new Array($),B=0,F=0,q=function(ae){ae=ae.target,j[ae._pos]=ae.result,++F===B&&R(j)},G=st(T),ee=0;ee<$;++ee)C[ee]!=null&&((N=K.get(C[ee]))._pos=ee,N.onsuccess=q,N.onerror=G,++B);B===0&&R(j)})},get:function(P){var x=P.trans,C=P.key;return new Promise(function(R,T){R=Ee(R);var N=x.objectStore(E).get(C);N.onsuccess=function(K){return R(K.target.result)},N.onerror=st(T)})},query:(_=k,function(P){return new Promise(function(x,C){x=Ee(x);var R,T,N,B=P.trans,K=P.values,$=P.limit,q=P.query,j=$===1/0?void 0:$,F=q.index,q=q.range,B=B.objectStore(E),F=F.isPrimaryKey?B:B.index(F.name),q=c(q);if($===0)return x({result:[]});_?((j=K?F.getAll(q,j):F.getAllKeys(q,j)).onsuccess=function(G){return x({result:G.target.result})},j.onerror=st(C)):(R=0,T=!K&&"openKeyCursor"in F?F.openKeyCursor(q):F.openCursor(q),N=[],T.onsuccess=function(G){var ee=T.result;return ee?(N.push(K?ee.value:ee.primaryKey),++R===$?x({result:N}):void ee.continue()):x({result:N})},T.onerror=st(C))})}),openCursor:function(P){var x=P.trans,C=P.values,R=P.query,T=P.reverse,N=P.unique;return new Promise(function(K,$){K=Ee(K);var F=R.index,j=R.range,B=x.objectStore(E),B=F.isPrimaryKey?B:B.index(F.name),F=T?N?"prevunique":"prev":N?"nextunique":"next",q=!C&&"openKeyCursor"in B?B.openKeyCursor(c(j),F):B.openCursor(c(j),F);q.onerror=st($),q.onsuccess=Ee(function(G){var ee,ae,re,Ze,ie=q.result;ie?(ie.___id=++$a,ie.done=!1,ee=ie.continue.bind(ie),ae=(ae=ie.continuePrimaryKey)&&ae.bind(ie),re=ie.advance.bind(ie),Ze=function(){throw new Error("Cursor not stopped")},ie.trans=x,ie.stop=ie.continue=ie.continuePrimaryKey=ie.advance=function(){throw new Error("Cursor not started")},ie.fail=Ee($),ie.next=function(){var Be=this,Le=1;return this.start(function(){return Le--?Be.continue():Be.stop()}).then(function(){return Be})},ie.start=function(Be){function Le(){if(q.result)try{Be()}catch(Fe){ie.fail(Fe)}else ie.done=!0,ie.start=function(){throw new Error("Cursor behind last entry")},ie.stop()}var Cr=new Promise(function(Fe,jt){Fe=Ee(Fe),q.onerror=st(jt),ie.fail=jt,ie.stop=function(Ni){ie.stop=ie.continue=ie.continuePrimaryKey=ie.advance=Ze,Fe(Ni)}});return q.onsuccess=Ee(function(Fe){q.onsuccess=Le,Le()}),ie.continue=ee,ie.continuePrimaryKey=ae,ie.advance=re,Le(),Cr},K(ie)):K(null)},$)})},count:function(P){var x=P.query,C=P.trans,R=x.index,T=x.range;return new Promise(function(N,K){var $=C.objectStore(E),j=R.isPrimaryKey?$:$.index(R.name),$=c(T),j=$?j.count($):j.count();j.onsuccess=Ee(function(B){return N(B.target.result)}),j.onerror=st(K)})}}}var d,m,y,A=(m=b,y=Us((d=r).objectStoreNames),{schema:{name:d.name,tables:y.map(function(O){return m.objectStore(O)}).map(function(O){var _=O.keyPath,x=O.autoIncrement,E=f(_),P={},x={name:O.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:_==null,compound:E,keyPath:_,autoIncrement:x,unique:!0,extractKey:pi(_)},indexes:Us(O.indexNames).map(function(C){return O.index(C)}).map(function(N){var R=N.name,T=N.unique,K=N.multiEntry,N=N.keyPath,K={name:R,compound:f(N),keyPath:N,unique:T,multiEntry:K,extractKey:pi(N)};return P[Kn(N)]=K}),getIndexByKeyPath:function(C){return P[Kn(C)]}};return P[":id"]=x.primaryKey,_!=null&&(P[Kn(_)]=x.primaryKey),x})},hasGetAll:0<y.length&&"getAll"in m.objectStore(y[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),b=A.schema,k=A.hasGetAll,A=b.tables.map(h),v={};return A.forEach(function(O){return v[O.name]=O}),{stack:"dbcore",transaction:r.transaction.bind(r),table:function(O){if(!v[O])throw new Error("Table '".concat(O,"' not found"));return v[O]},MIN_KEY:-1/0,MAX_KEY:In(s),schema:b}}function Fa(r,s,u,c){var h=u.IDBKeyRange;return u.indexedDB,{dbcore:(c=qa(s,h,c),r.dbcore.reduce(function(d,m){return m=m.create,i(i({},d),m(d))},c))}}function gr(r,c){var u=c.db,c=Fa(r._middlewares,u,r._deps,c);r.core=c.dbcore,r.tables.forEach(function(h){var d=h.name;r.core.schema.tables.some(function(m){return m.name===d})&&(h.core=r.core.table(d),r[d]instanceof r.Table&&(r[d].core=h.core))})}function vr(r,s,u,c){u.forEach(function(h){var d=c[h];s.forEach(function(m){var y=function b(k,A){return H(k,A)||(k=g(k))&&b(k,A)}(m,h);(!y||"value"in y&&y.value===void 0)&&(m===r.Transaction.prototype||m instanceof r.Transaction?V(m,h,{get:function(){return this.table(h)},set:function(b){I(this,h,{value:b,writable:!0,configurable:!0,enumerable:!0})}}):m[h]=new r.Table(h,d))})})}function mi(r,s){s.forEach(function(u){for(var c in u)u[c]instanceof r.Table&&delete u[c]})}function Ua(r,s){return r._cfg.version-s._cfg.version}function za(r,s,u,c){var h=r._dbSchema;u.objectStoreNames.contains("$meta")&&!h.$meta&&(h.$meta=di("$meta",Vs("")[0],[]),r._storeNames.push("$meta"));var d=r._createTransaction("readwrite",r._storeNames,h);d.create(u),d._completion.catch(c);var m=d._reject.bind(d),y=Q.transless||Q;gt(function(){return Q.trans=d,Q.transless=y,s!==0?(gr(r,u),k=s,((b=d).storeNames.includes("$meta")?b.table("$meta").get("version").then(function(A){return A??k}):z.resolve(k)).then(function(A){return O=A,_=d,E=u,P=[],A=(v=r)._versions,x=v._dbSchema=wr(0,v.idbdb,E),(A=A.filter(function(C){return C._cfg.version>=O})).length!==0?(A.forEach(function(C){P.push(function(){var R=x,T=C._cfg.dbschema;_r(v,R,E),_r(v,T,E),x=v._dbSchema=T;var N=yi(R,T);N.add.forEach(function(F){gi(E,F[0],F[1].primKey,F[1].indexes)}),N.change.forEach(function(F){if(F.recreate)throw new X.Upgrade("Not yet support for changing primary key");var q=E.objectStore(F.name);F.add.forEach(function(G){return br(q,G)}),F.change.forEach(function(G){q.deleteIndex(G.name),br(q,G)}),F.del.forEach(function(G){return q.deleteIndex(G)})});var K=C._cfg.contentUpgrade;if(K&&C._cfg.version>O){gr(v,E),_._memoizedTables={};var $=Xe(T);N.del.forEach(function(F){$[F]=R[F]}),mi(v,[v.Transaction.prototype]),vr(v,[v.Transaction.prototype],l($),$),_.schema=$;var j,B=Wt(K);return B&&Zt(),N=z.follow(function(){var F;(j=K(_))&&B&&(F=vt.bind(null,null),j.then(F,F))}),j&&typeof j.then=="function"?z.resolve(j):N.then(function(){return j})}}),P.push(function(R){var T,N,K=C._cfg.dbschema;T=K,N=R,[].slice.call(N.db.objectStoreNames).forEach(function($){return T[$]==null&&N.db.deleteObjectStore($)}),mi(v,[v.Transaction.prototype]),vr(v,[v.Transaction.prototype],v._storeNames,v._dbSchema),_.schema=v._dbSchema}),P.push(function(R){v.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(v.idbdb.version/10)===C._cfg.version?(v.idbdb.deleteObjectStore("$meta"),delete v._dbSchema.$meta,v._storeNames=v._storeNames.filter(function(T){return T!=="$meta"})):R.objectStore("$meta").put(C._cfg.version,"version"))})}),function C(){return P.length?z.resolve(P.shift()(_.idbtrans)).then(C):z.resolve()}().then(function(){zs(x,E)})):z.resolve();var v,O,_,E,P,x}).catch(m)):(l(h).forEach(function(A){gi(u,A,h[A].primKey,h[A].indexes)}),gr(r,u),void z.follow(function(){return r.on.populate.fire(d)}).catch(m));var b,k})}function Va(r,s){zs(r._dbSchema,s),s.db.version%10!=0||s.objectStoreNames.contains("$meta")||s.db.createObjectStore("$meta").add(Math.ceil(s.db.version/10-1),"version");var u=wr(0,r.idbdb,s);_r(r,r._dbSchema,s);for(var c=0,h=yi(u,r._dbSchema).change;c<h.length;c++){var d=function(m){if(m.change.length||m.recreate)return console.warn("Unable to patch indexes of table ".concat(m.name," because it has changes on the type of index or primary key.")),{value:void 0};var y=s.objectStore(m.name);m.add.forEach(function(b){it&&console.debug("Dexie upgrade patch: Creating missing index ".concat(m.name,".").concat(b.src)),br(y,b)})}(h[c]);if(typeof d=="object")return d.value}}function yi(r,s){var u,c={del:[],add:[],change:[]};for(u in r)s[u]||c.del.push(u);for(u in s){var h=r[u],d=s[u];if(h){var m={name:u,def:d,recreate:!1,del:[],add:[],change:[]};if(""+(h.primKey.keyPath||"")!=""+(d.primKey.keyPath||"")||h.primKey.auto!==d.primKey.auto)m.recreate=!0,c.change.push(m);else{var y=h.idxByName,b=d.idxByName,k=void 0;for(k in y)b[k]||m.del.push(k);for(k in b){var A=y[k],v=b[k];A?A.src!==v.src&&m.change.push(v):m.add.push(v)}(0<m.del.length||0<m.add.length||0<m.change.length)&&c.change.push(m)}}else c.add.push([u,d])}return c}function gi(r,s,u,c){var h=r.db.createObjectStore(s,u.keyPath?{keyPath:u.keyPath,autoIncrement:u.auto}:{autoIncrement:u.auto});return c.forEach(function(d){return br(h,d)}),h}function zs(r,s){l(r).forEach(function(u){s.db.objectStoreNames.contains(u)||(it&&console.debug("Dexie: Creating missing table",u),gi(s,u,r[u].primKey,r[u].indexes))})}function br(r,s){r.createIndex(s.name,s.keyPath,{unique:s.unique,multiEntry:s.multi})}function wr(r,s,u){var c={};return W(s.objectStoreNames,0).forEach(function(h){for(var d=u.objectStore(h),m=hi(Fs(k=d.keyPath),k||"",!0,!1,!!d.autoIncrement,k&&typeof k!="string",!0),y=[],b=0;b<d.indexNames.length;++b){var A=d.index(d.indexNames[b]),k=A.keyPath,A=hi(A.name,k,!!A.unique,!!A.multiEntry,!1,k&&typeof k!="string",!1);y.push(A)}c[h]=di(h,m,y)}),c}function _r(r,s,u){for(var c=u.db.objectStoreNames,h=0;h<c.length;++h){var d=c[h],m=u.objectStore(d);r._hasGetAll="getAll"in m;for(var y=0;y<m.indexNames.length;++y){var b=m.indexNames[y],k=m.index(b).keyPath,A=typeof k=="string"?k:"["+W(k).join("+")+"]";!s[d]||(k=s[d].idxByName[A])&&(k.name=b,delete s[d].idxByName[A],s[d].idxByName[b]=k)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&a.WorkerGlobalScope&&a instanceof a.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(r._hasGetAll=!1)}function Vs(r){return r.split(",").map(function(s,u){var c=(s=s.trim()).replace(/([&*]|\+\+)/g,""),h=/^\[/.test(c)?c.match(/^\[(.*)\]$/)[1].split("+"):c;return hi(c,h||null,/\&/.test(s),/\*/.test(s),/\+\+/.test(s),f(h),u===0)})}var Ga=(kr.prototype._parseStoresSpec=function(r,s){l(r).forEach(function(u){if(r[u]!==null){var c=Vs(r[u]),h=c.shift();if(h.unique=!0,h.multi)throw new X.Schema("Primary key cannot be multi-valued");c.forEach(function(d){if(d.auto)throw new X.Schema("Only primary key can be marked as autoIncrement (++)");if(!d.keyPath)throw new X.Schema("Index must have a name and cannot be an empty string")}),s[u]=di(u,h,c)}})},kr.prototype.stores=function(u){var s=this.db;this._cfg.storesSource=this._cfg.storesSource?p(this._cfg.storesSource,u):u;var u=s._versions,c={},h={};return u.forEach(function(d){p(c,d._cfg.storesSource),h=d._cfg.dbschema={},d._parseStoresSpec(c,h)}),s._dbSchema=h,mi(s,[s._allTables,s,s.Transaction.prototype]),vr(s,[s._allTables,s,s.Transaction.prototype,this._cfg.tables],l(h),h),s._storeNames=l(h),this},kr.prototype.upgrade=function(r){return this._cfg.contentUpgrade=Xr(this._cfg.contentUpgrade||ye,r),this},kr);function kr(){}function vi(r,s){var u=r._dbNamesDB;return u||(u=r._dbNamesDB=new dt(hr,{addons:[],indexedDB:r,IDBKeyRange:s})).version(1).stores({dbnames:"name"}),u.table("dbnames")}function bi(r){return r&&typeof r.databases=="function"}function wi(r){return gt(function(){return Q.letThrough=!0,r()})}function _i(r){return!("from"in r)}var je=function(r,s){if(!this){var u=new je;return r&&"d"in r&&p(u,r),u}p(this,arguments.length?{d:1,from:r,to:1<arguments.length?s:r}:{d:0})};function jn(r,s,u){var c=le(s,u);if(!isNaN(c)){if(0<c)throw RangeError();if(_i(r))return p(r,{from:s,to:u,d:1});var h=r.l,c=r.r;if(le(u,r.from)<0)return h?jn(h,s,u):r.l={from:s,to:u,d:1,l:null,r:null},Hs(r);if(0<le(s,r.to))return c?jn(c,s,u):r.r={from:s,to:u,d:1,l:null,r:null},Hs(r);le(s,r.from)<0&&(r.from=s,r.l=null,r.d=c?c.d+1:1),0<le(u,r.to)&&(r.to=u,r.r=null,r.d=r.l?r.l.d+1:1),u=!r.r,h&&!r.l&&Bn(r,h),c&&u&&Bn(r,c)}}function Bn(r,s){_i(s)||function u(c,b){var d=b.from,m=b.to,y=b.l,b=b.r;jn(c,d,m),y&&u(c,y),b&&u(c,b)}(r,s)}function Gs(r,s){var u=xr(s),c=u.next();if(c.done)return!1;for(var h=c.value,d=xr(r),m=d.next(h.from),y=m.value;!c.done&&!m.done;){if(le(y.from,h.to)<=0&&0<=le(y.to,h.from))return!0;le(h.from,y.from)<0?h=(c=u.next(y.from)).value:y=(m=d.next(h.from)).value}return!1}function xr(r){var s=_i(r)?null:{s:0,n:r};return{next:function(u){for(var c=0<arguments.length;s;)switch(s.s){case 0:if(s.s=1,c)for(;s.n.l&&le(u,s.n.from)<0;)s={up:s,n:s.n.l,s:1};else for(;s.n.l;)s={up:s,n:s.n.l,s:1};case 1:if(s.s=2,!c||le(u,s.n.to)<=0)return{value:s.n,done:!1};case 2:if(s.n.r){s.s=3,s={up:s,n:s.n.r,s:0};continue}case 3:s=s.up}return{done:!0}}}}function Hs(r){var s,u,c=(((s=r.r)===null||s===void 0?void 0:s.d)||0)-(((u=r.l)===null||u===void 0?void 0:u.d)||0),h=1<c?"r":c<-1?"l":"";h&&(s=h=="r"?"l":"r",u=i({},r),c=r[h],r.from=c.from,r.to=c.to,r[h]=c[h],u[h]=c[s],(r[s]=u).d=Ws(u)),r.d=Ws(r)}function Ws(u){var s=u.r,u=u.l;return(s?u?Math.max(s.d,u.d):s.d:u?u.d:0)+1}function Er(r,s){return l(s).forEach(function(u){r[u]?Bn(r[u],s[u]):r[u]=function c(h){var d,m,y={};for(d in h)S(h,d)&&(m=h[d],y[d]=!m||typeof m!="object"||xe.has(m.constructor)?m:c(m));return y}(s[u])}),r}function ki(r,s){return r.all||s.all||Object.keys(r).some(function(u){return s[u]&&Gs(s[u],r[u])})}D(je.prototype,((Qe={add:function(r){return Bn(this,r),this},addKey:function(r){return jn(this,r,r),this},addKeys:function(r){var s=this;return r.forEach(function(u){return jn(s,u,u)}),this},hasKey:function(r){var s=xr(this).next(r).value;return s&&le(s.from,r)<=0&&0<=le(s.to,r)}})[Ot]=function(){return xr(this)},Qe));var It={},xi={},Ei=!1;function Ar(r){Er(xi,r),Ei||(Ei=!0,setTimeout(function(){Ei=!1,Ai(xi,!(xi={}))},0))}function Ai(r,s){s===void 0&&(s=!1);var u=new Set;if(r.all)for(var c=0,h=Object.values(It);c<h.length;c++)Qs(m=h[c],r,u,s);else for(var d in r){var m,y=/^idb\:\/\/(.*)\/(.*)\//.exec(d);y&&(d=y[1],y=y[2],(m=It["idb://".concat(d,"/").concat(y)])&&Qs(m,r,u,s))}u.forEach(function(b){return b()})}function Qs(r,s,u,c){for(var h=[],d=0,m=Object.entries(r.queries.query);d<m.length;d++){for(var y=m[d],b=y[0],k=[],A=0,v=y[1];A<v.length;A++){var O=v[A];ki(s,O.obsSet)?O.subscribers.forEach(function(x){return u.add(x)}):c&&k.push(O)}c&&h.push([b,k])}if(c)for(var _=0,E=h;_<E.length;_++){var P=E[_],b=P[0],k=P[1];r.queries.query[b]=k}}function Ha(r){var s=r._state,u=r._deps.indexedDB;if(s.isBeingOpened||r.idbdb)return s.dbReadyPromise.then(function(){return s.dbOpenError?Oe(s.dbOpenError):r});s.isBeingOpened=!0,s.dbOpenError=null,s.openComplete=!1;var c=s.openCanceller,h=Math.round(10*r.verno),d=!1;function m(){if(s.openCanceller!==c)throw new X.DatabaseClosed("db.open() was cancelled")}function y(){return new z(function(O,_){if(m(),!u)throw new X.MissingAPI;var E=r.name,P=s.autoSchema||!h?u.open(E):u.open(E,h);if(!P)throw new X.MissingAPI;P.onerror=st(_),P.onblocked=Ee(r._fireOnBlocked),P.onupgradeneeded=Ee(function(x){var C;A=P.transaction,s.autoSchema&&!r._options.allowEmptyDB?(P.onerror=Mn,A.abort(),P.result.close(),(C=u.deleteDatabase(E)).onsuccess=C.onerror=Ee(function(){_(new X.NoSuchDatabase("Database ".concat(E," doesnt exist")))})):(A.onerror=st(_),x=x.oldVersion>Math.pow(2,62)?0:x.oldVersion,v=x<1,r.idbdb=P.result,d&&Va(r,A),za(r,x/10,A,_))},_),P.onsuccess=Ee(function(){A=null;var x,C,R,T,N,K=r.idbdb=P.result,$=W(K.objectStoreNames);if(0<$.length)try{var j=K.transaction((T=$).length===1?T[0]:T,"readonly");if(s.autoSchema)C=K,R=j,(x=r).verno=C.version/10,R=x._dbSchema=wr(0,C,R),x._storeNames=W(C.objectStoreNames,0),vr(x,[x._allTables],l(R),R);else if(_r(r,r._dbSchema,j),((N=yi(wr(0,(N=r).idbdb,j),N._dbSchema)).add.length||N.change.some(function(B){return B.add.length||B.change.length}))&&!d)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),K.close(),h=K.version+1,d=!0,O(y());gr(r,j)}catch{}en.push(r),K.onversionchange=Ee(function(B){s.vcFired=!0,r.on("versionchange").fire(B)}),K.onclose=Ee(function(B){r.on("close").fire(B)}),v&&(N=r._deps,j=E,K=N.indexedDB,N=N.IDBKeyRange,bi(K)||j===hr||vi(K,N).put({name:j}).catch(ye)),O()},_)}).catch(function(O){switch(O?.name){case"UnknownError":if(0<s.PR1398_maxLoop)return s.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),y();break;case"VersionError":if(0<h)return h=0,y()}return z.reject(O)})}var b,k=s.dbReadyResolve,A=null,v=!1;return z.race([c,(typeof navigator>"u"?z.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(O){function _(){return indexedDB.databases().finally(O)}b=setInterval(_,100),_()}).finally(function(){return clearInterval(b)}):Promise.resolve()).then(y)]).then(function(){return m(),s.onReadyBeingFired=[],z.resolve(wi(function(){return r.on.ready.fire(r.vip)})).then(function O(){if(0<s.onReadyBeingFired.length){var _=s.onReadyBeingFired.reduce(Xr,ye);return s.onReadyBeingFired=[],z.resolve(wi(function(){return _(r.vip)})).then(O)}})}).finally(function(){s.openCanceller===c&&(s.onReadyBeingFired=null,s.isBeingOpened=!1)}).catch(function(O){s.dbOpenError=O;try{A&&A.abort()}catch{}return c===s.openCanceller&&r._close(),Oe(O)}).finally(function(){s.openComplete=!0,k()}).then(function(){var O;return v&&(O={},r.tables.forEach(function(_){_.schema.indexes.forEach(function(E){E.name&&(O["idb://".concat(r.name,"/").concat(_.name,"/").concat(E.name)]=new je(-1/0,[[[]]]))}),O["idb://".concat(r.name,"/").concat(_.name,"/")]=O["idb://".concat(r.name,"/").concat(_.name,"/:dels")]=new je(-1/0,[[[]]])}),_t(Dn).fire(O),Ai(O,!0)),r})}function Pi(r){function s(d){return r.next(d)}var u=h(s),c=h(function(d){return r.throw(d)});function h(d){return function(b){var y=d(b),b=y.value;return y.done?b:b&&typeof b.then=="function"?b.then(u,c):f(b)?Promise.all(b).then(u,c):u(b)}}return h(s)()}function Pr(r,s,u){for(var c=f(r)?r.slice():[r],h=0;h<u;++h)c.push(s);return c}var Wa={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(r){return i(i({},r),{table:function(s){var u=r.table(s),c=u.schema,h={},d=[];function m(v,O,_){var E=Kn(v),P=h[E]=h[E]||[],x=v==null?0:typeof v=="string"?1:v.length,C=0<O,C=i(i({},_),{name:C?"".concat(E,"(virtual-from:").concat(_.name,")"):_.name,lowLevelIndex:_,isVirtual:C,keyTail:O,keyLength:x,extractKey:pi(v),unique:!C&&_.unique});return P.push(C),C.isPrimaryKey||d.push(C),1<x&&m(x===2?v[0]:v.slice(0,x-1),O+1,_),P.sort(function(R,T){return R.keyTail-T.keyTail}),C}s=m(c.primaryKey.keyPath,0,c.primaryKey),h[":id"]=[s];for(var y=0,b=c.indexes;y<b.length;y++){var k=b[y];m(k.keyPath,0,k)}function A(v){var O,_=v.query.index;return _.isVirtual?i(i({},v),{query:{index:_.lowLevelIndex,range:(O=v.query.range,_=_.keyTail,{type:O.type===1?2:O.type,lower:Pr(O.lower,O.lowerOpen?r.MAX_KEY:r.MIN_KEY,_),lowerOpen:!0,upper:Pr(O.upper,O.upperOpen?r.MIN_KEY:r.MAX_KEY,_),upperOpen:!0})}}):v}return i(i({},u),{schema:i(i({},c),{primaryKey:s,indexes:d,getIndexByKeyPath:function(v){return(v=h[Kn(v)])&&v[0]}}),count:function(v){return u.count(A(v))},query:function(v){return u.query(A(v))},openCursor:function(v){var O=v.query.index,_=O.keyTail,E=O.isVirtual,P=O.keyLength;return E?u.openCursor(A(v)).then(function(C){return C&&x(C)}):u.openCursor(v);function x(C){return Object.create(C,{continue:{value:function(R){R!=null?C.continue(Pr(R,v.reverse?r.MAX_KEY:r.MIN_KEY,_)):v.unique?C.continue(C.key.slice(0,P).concat(v.reverse?r.MIN_KEY:r.MAX_KEY,_)):C.continue()}},continuePrimaryKey:{value:function(R,T){C.continuePrimaryKey(Pr(R,r.MAX_KEY,_),T)}},primaryKey:{get:function(){return C.primaryKey}},key:{get:function(){var R=C.key;return P===1?R[0]:R.slice(0,P)}},value:{get:function(){return C.value}}})}}})}})}};function Oi(r,s,u,c){return u=u||{},c=c||"",l(r).forEach(function(h){var d,m,y;S(s,h)?(d=r[h],m=s[h],typeof d=="object"&&typeof m=="object"&&d&&m?(y=qe(d))!==qe(m)?u[c+h]=s[h]:y==="Object"?Oi(d,m,u,c+h+"."):d!==m&&(u[c+h]=s[h]):d!==m&&(u[c+h]=s[h])):u[c+h]=void 0}),l(s).forEach(function(h){S(r,h)||(u[c+h]=s[h])}),u}function Si(r,s){return s.type==="delete"?s.keys:s.keys||s.values.map(r.extractKey)}var Qa={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(r){return i(i({},r),{table:function(s){var u=r.table(s),c=u.schema.primaryKey;return i(i({},u),{mutate:function(h){var d=Q.trans,m=d.table(s).hook,y=m.deleting,b=m.creating,k=m.updating;switch(h.type){case"add":if(b.fire===ye)break;return d._promise("readwrite",function(){return A(h)},!0);case"put":if(b.fire===ye&&k.fire===ye)break;return d._promise("readwrite",function(){return A(h)},!0);case"delete":if(y.fire===ye)break;return d._promise("readwrite",function(){return A(h)},!0);case"deleteRange":if(y.fire===ye)break;return d._promise("readwrite",function(){return function v(O,_,E){return u.query({trans:O,values:!1,query:{index:c,range:_},limit:E}).then(function(P){var x=P.result;return A({type:"delete",keys:x,trans:O}).then(function(C){return 0<C.numFailures?Promise.reject(C.failures[0]):x.length<E?{failures:[],numFailures:0,lastResult:void 0}:v(O,i(i({},_),{lower:x[x.length-1],lowerOpen:!0}),E)})})}(h.trans,h.range,1e4)},!0)}return u.mutate(h);function A(v){var O,_,E,P=Q.trans,x=v.keys||Si(c,v);if(!x)throw new Error("Keys missing");return(v=v.type==="add"||v.type==="put"?i(i({},v),{keys:x}):i({},v)).type!=="delete"&&(v.values=o([],v.values)),v.keys&&(v.keys=o([],v.keys)),O=u,E=x,((_=v).type==="add"?Promise.resolve([]):O.getMany({trans:_.trans,keys:E,cache:"immutable"})).then(function(C){var R=x.map(function(T,N){var K,$,j,B=C[N],F={onerror:null,onsuccess:null};return v.type==="delete"?y.fire.call(F,T,B,P):v.type==="add"||B===void 0?(K=b.fire.call(F,T,v.values[N],P),T==null&&K!=null&&(v.keys[N]=T=K,c.outbound||Ae(v.values[N],c.keyPath,T))):(K=Oi(B,v.values[N]),($=k.fire.call(F,K,T,B,P))&&(j=v.values[N],Object.keys($).forEach(function(q){S(j,q)?j[q]=$[q]:Ae(j,q,$[q])}))),F});return u.mutate(v).then(function(T){for(var N=T.failures,K=T.results,$=T.numFailures,T=T.lastResult,j=0;j<x.length;++j){var B=(K||x)[j],F=R[j];B==null?F.onerror&&F.onerror(N[j]):F.onsuccess&&F.onsuccess(v.type==="put"&&C[j]?v.values[j]:B)}return{failures:N,results:K,numFailures:$,lastResult:T}}).catch(function(T){return R.forEach(function(N){return N.onerror&&N.onerror(T)}),Promise.reject(T)})})}}})}})}};function Ys(r,s,u){try{if(!s||s.keys.length<r.length)return null;for(var c=[],h=0,d=0;h<s.keys.length&&d<r.length;++h)le(s.keys[h],r[d])===0&&(c.push(u?ce(s.values[h]):s.values[h]),++d);return c.length===r.length?c:null}catch{return null}}var Ya={stack:"dbcore",level:-1,create:function(r){return{table:function(s){var u=r.table(s);return i(i({},u),{getMany:function(c){if(!c.cache)return u.getMany(c);var h=Ys(c.keys,c.trans._cache,c.cache==="clone");return h?z.resolve(h):u.getMany(c).then(function(d){return c.trans._cache={keys:c.keys,values:c.cache==="clone"?ce(d):d},d})},mutate:function(c){return c.type!=="add"&&(c.trans._cache=null),u.mutate(c)}})}}}};function Xs(r,s){return r.trans.mode==="readonly"&&!!r.subscr&&!r.trans.explicit&&r.trans.db._options.cache!=="disabled"&&!s.schema.primaryKey.outbound}function Js(r,s){switch(r){case"query":return s.values&&!s.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Xa={stack:"dbcore",level:0,name:"Observability",create:function(r){var s=r.schema.name,u=new je(r.MIN_KEY,r.MAX_KEY);return i(i({},r),{transaction:function(c,h,d){if(Q.subscr&&h!=="readonly")throw new X.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Q.querier));return r.transaction(c,h,d)},table:function(c){var h=r.table(c),d=h.schema,m=d.primaryKey,v=d.indexes,y=m.extractKey,b=m.outbound,k=m.autoIncrement&&v.filter(function(_){return _.compound&&_.keyPath.includes(m.keyPath)}),A=i(i({},h),{mutate:function(_){function E(q){return q="idb://".concat(s,"/").concat(c,"/").concat(q),T[q]||(T[q]=new je)}var P,x,C,R=_.trans,T=_.mutatedParts||(_.mutatedParts={}),N=E(""),K=E(":dels"),$=_.type,F=_.type==="deleteRange"?[_.range]:_.type==="delete"?[_.keys]:_.values.length<50?[Si(m,_).filter(function(q){return q}),_.values]:[],j=F[0],B=F[1],F=_.trans._cache;return f(j)?(N.addKeys(j),(F=$==="delete"||j.length===B.length?Ys(j,F):null)||K.addKeys(j),(F||B)&&(P=E,x=F,C=B,d.indexes.forEach(function(q){var G=P(q.name||"");function ee(re){return re!=null?q.extractKey(re):null}function ae(re){return q.multiEntry&&f(re)?re.forEach(function(Ze){return G.addKey(Ze)}):G.addKey(re)}(x||C).forEach(function(re,Be){var ie=x&&ee(x[Be]),Be=C&&ee(C[Be]);le(ie,Be)!==0&&(ie!=null&&ae(ie),Be!=null&&ae(Be))})}))):j?(B={from:(B=j.lower)!==null&&B!==void 0?B:r.MIN_KEY,to:(B=j.upper)!==null&&B!==void 0?B:r.MAX_KEY},K.add(B),N.add(B)):(N.add(u),K.add(u),d.indexes.forEach(function(q){return E(q.name).add(u)})),h.mutate(_).then(function(q){return!j||_.type!=="add"&&_.type!=="put"||(N.addKeys(q.results),k&&k.forEach(function(G){var ee=_.values.map(function(re){return G.extractKey(re)}),ae=G.keyPath.findIndex(function(re){return re===m.keyPath});q.results.forEach(function(re){return ee[ae]=re}),E(G.name).addKeys(ee)})),R.mutatedParts=Er(R.mutatedParts||{},T),q})}}),v=function(E){var P=E.query,E=P.index,P=P.range;return[E,new je((E=P.lower)!==null&&E!==void 0?E:r.MIN_KEY,(P=P.upper)!==null&&P!==void 0?P:r.MAX_KEY)]},O={get:function(_){return[m,new je(_.key)]},getMany:function(_){return[m,new je().addKeys(_.keys)]},count:v,query:v,openCursor:v};return l(O).forEach(function(_){A[_]=function(E){var P=Q.subscr,x=!!P,C=Xs(Q,h)&&Js(_,E)?E.obsSet={}:P;if(x){var R=function(B){return B="idb://".concat(s,"/").concat(c,"/").concat(B),C[B]||(C[B]=new je)},T=R(""),N=R(":dels"),P=O[_](E),x=P[0],P=P[1];if((_==="query"&&x.isPrimaryKey&&!E.values?N:R(x.name||"")).add(P),!x.isPrimaryKey){if(_!=="count"){var K=_==="query"&&b&&E.values&&h.query(i(i({},E),{values:!1}));return h[_].apply(this,arguments).then(function(B){if(_==="query"){if(b&&E.values)return K.then(function(ee){return ee=ee.result,T.addKeys(ee),B});var F=E.values?B.result.map(y):B.result;(E.values?T:N).addKeys(F)}else if(_==="openCursor"){var q=B,G=E.values;return q&&Object.create(q,{key:{get:function(){return N.addKey(q.primaryKey),q.key}},primaryKey:{get:function(){var ee=q.primaryKey;return N.addKey(ee),ee}},value:{get:function(){return G&&T.addKey(q.primaryKey),q.value}}})}return B})}N.add(u)}}return h[_].apply(this,arguments)}}),A}})}};function Zs(r,s,u){if(u.numFailures===0)return s;if(s.type==="deleteRange")return null;var c=s.keys?s.keys.length:"values"in s&&s.values?s.values.length:1;return u.numFailures===c?null:(s=i({},s),f(s.keys)&&(s.keys=s.keys.filter(function(h,d){return!(d in u.failures)})),"values"in s&&f(s.values)&&(s.values=s.values.filter(function(h,d){return!(d in u.failures)})),s)}function Ci(r,s){return u=r,((c=s).lower===void 0||(c.lowerOpen?0<le(u,c.lower):0<=le(u,c.lower)))&&(r=r,(s=s).upper===void 0||(s.upperOpen?le(r,s.upper)<0:le(r,s.upper)<=0));var u,c}function eo(r,s,O,c,h,d){if(!O||O.length===0)return r;var m=s.query.index,y=m.multiEntry,b=s.query.range,k=c.schema.primaryKey.extractKey,A=m.extractKey,v=(m.lowLevelIndex||m).extractKey,O=O.reduce(function(_,E){var P=_,x=[];if(E.type==="add"||E.type==="put")for(var C=new je,R=E.values.length-1;0<=R;--R){var T,N=E.values[R],K=k(N);C.hasKey(K)||(T=A(N),(y&&f(T)?T.some(function(q){return Ci(q,b)}):Ci(T,b))&&(C.addKey(K),x.push(N)))}switch(E.type){case"add":var $=new je().addKeys(s.values?_.map(function(G){return k(G)}):_),P=_.concat(s.values?x.filter(function(G){return G=k(G),!$.hasKey(G)&&($.addKey(G),!0)}):x.map(function(G){return k(G)}).filter(function(G){return!$.hasKey(G)&&($.addKey(G),!0)}));break;case"put":var j=new je().addKeys(E.values.map(function(G){return k(G)}));P=_.filter(function(G){return!j.hasKey(s.values?k(G):G)}).concat(s.values?x:x.map(function(G){return k(G)}));break;case"delete":var B=new je().addKeys(E.keys);P=_.filter(function(G){return!B.hasKey(s.values?k(G):G)});break;case"deleteRange":var F=E.range;P=_.filter(function(G){return!Ci(k(G),F)})}return P},r);return O===r?r:(O.sort(function(_,E){return le(v(_),v(E))||le(k(_),k(E))}),s.limit&&s.limit<1/0&&(O.length>s.limit?O.length=s.limit:r.length===s.limit&&O.length<s.limit&&(h.dirty=!0)),d?Object.freeze(O):O)}function to(r,s){return le(r.lower,s.lower)===0&&le(r.upper,s.upper)===0&&!!r.lowerOpen==!!s.lowerOpen&&!!r.upperOpen==!!s.upperOpen}function Ja(r,s){return function(u,c,h,d){if(u===void 0)return c!==void 0?-1:0;if(c===void 0)return 1;if((c=le(u,c))===0){if(h&&d)return 0;if(h)return 1;if(d)return-1}return c}(r.lower,s.lower,r.lowerOpen,s.lowerOpen)<=0&&0<=function(u,c,h,d){if(u===void 0)return c!==void 0?1:0;if(c===void 0)return-1;if((c=le(u,c))===0){if(h&&d)return 0;if(h)return-1;if(d)return 1}return c}(r.upper,s.upper,r.upperOpen,s.upperOpen)}function Za(r,s,u,c){r.subscribers.add(u),c.addEventListener("abort",function(){var h,d;r.subscribers.delete(u),r.subscribers.size===0&&(h=r,d=s,setTimeout(function(){h.subscribers.size===0&&He(d,h)},3e3))})}var eu={stack:"dbcore",level:0,name:"Cache",create:function(r){var s=r.schema.name;return i(i({},r),{transaction:function(u,c,h){var d,m,y=r.transaction(u,c,h);return c==="readwrite"&&(m=(d=new AbortController).signal,h=function(b){return function(){if(d.abort(),c==="readwrite"){for(var k=new Set,A=0,v=u;A<v.length;A++){var O=v[A],_=It["idb://".concat(s,"/").concat(O)];if(_){var E=r.table(O),P=_.optimisticOps.filter(function(G){return G.trans===y});if(y._explicit&&b&&y.mutatedParts)for(var x=0,C=Object.values(_.queries.query);x<C.length;x++)for(var R=0,T=($=C[x]).slice();R<T.length;R++)ki((j=T[R]).obsSet,y.mutatedParts)&&(He($,j),j.subscribers.forEach(function(G){return k.add(G)}));else if(0<P.length){_.optimisticOps=_.optimisticOps.filter(function(G){return G.trans!==y});for(var N=0,K=Object.values(_.queries.query);N<K.length;N++)for(var $,j,B,F=0,q=($=K[N]).slice();F<q.length;F++)(j=q[F]).res!=null&&y.mutatedParts&&(b&&!j.dirty?(B=Object.isFrozen(j.res),B=eo(j.res,j.req,P,E,j,B),j.dirty?(He($,j),j.subscribers.forEach(function(G){return k.add(G)})):B!==j.res&&(j.res=B,j.promise=z.resolve({result:B}))):(j.dirty&&He($,j),j.subscribers.forEach(function(G){return k.add(G)})))}}}k.forEach(function(G){return G()})}}},y.addEventListener("abort",h(!1),{signal:m}),y.addEventListener("error",h(!1),{signal:m}),y.addEventListener("complete",h(!0),{signal:m})),y},table:function(u){var c=r.table(u),h=c.schema.primaryKey;return i(i({},c),{mutate:function(d){var m=Q.trans;if(h.outbound||m.db._options.cache==="disabled"||m.explicit||m.idbtrans.mode!=="readwrite")return c.mutate(d);var y=It["idb://".concat(s,"/").concat(u)];return y?(m=c.mutate(d),d.type!=="add"&&d.type!=="put"||!(50<=d.values.length||Si(h,d).some(function(b){return b==null}))?(y.optimisticOps.push(d),d.mutatedParts&&Ar(d.mutatedParts),m.then(function(b){0<b.numFailures&&(He(y.optimisticOps,d),(b=Zs(0,d,b))&&y.optimisticOps.push(b),d.mutatedParts&&Ar(d.mutatedParts))}),m.catch(function(){He(y.optimisticOps,d),d.mutatedParts&&Ar(d.mutatedParts)})):m.then(function(b){var k=Zs(0,i(i({},d),{values:d.values.map(function(A,v){var O;return b.failures[v]?A:(A=(O=h.keyPath)!==null&&O!==void 0&&O.includes(".")?ce(A):i({},A),Ae(A,h.keyPath,b.results[v]),A)})}),b);y.optimisticOps.push(k),queueMicrotask(function(){return d.mutatedParts&&Ar(d.mutatedParts)})}),m):c.mutate(d)},query:function(d){if(!Xs(Q,c)||!Js("query",d))return c.query(d);var m=((k=Q.trans)===null||k===void 0?void 0:k.db._options.cache)==="immutable",v=Q,y=v.requery,b=v.signal,k=function(E,P,x,C){var R=It["idb://".concat(E,"/").concat(P)];if(!R)return[];if(!(P=R.queries[x]))return[null,!1,R,null];var T=P[(C.query?C.query.index.name:null)||""];if(!T)return[null,!1,R,null];switch(x){case"query":var N=T.find(function(K){return K.req.limit===C.limit&&K.req.values===C.values&&to(K.req.query.range,C.query.range)});return N?[N,!0,R,T]:[T.find(function(K){return("limit"in K.req?K.req.limit:1/0)>=C.limit&&(!C.values||K.req.values)&&Ja(K.req.query.range,C.query.range)}),!1,R,T];case"count":return N=T.find(function(K){return to(K.req.query.range,C.query.range)}),[N,!!N,R,T]}}(s,u,"query",d),A=k[0],v=k[1],O=k[2],_=k[3];return A&&v?A.obsSet=d.obsSet:(v=c.query(d).then(function(E){var P=E.result;if(A&&(A.res=P),m){for(var x=0,C=P.length;x<C;++x)Object.freeze(P[x]);Object.freeze(P)}else E.result=ce(P);return E}).catch(function(E){return _&&A&&He(_,A),Promise.reject(E)}),A={obsSet:d.obsSet,promise:v,subscribers:new Set,type:"query",req:d,dirty:!1},_?_.push(A):(_=[A],(O=O||(It["idb://".concat(s,"/").concat(u)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[d.query.index.name||""]=_)),Za(A,_,y,b),A.promise.then(function(E){return{result:eo(E.result,d,O?.optimisticOps,c,A,m)}})}})}})}};function Or(r,s){return new Proxy(r,{get:function(u,c,h){return c==="db"?s:Reflect.get(u,c,h)}})}var dt=(Se.prototype.version=function(r){if(isNaN(r)||r<.1)throw new X.Type("Given version is not a positive number");if(r=Math.round(10*r)/10,this.idbdb||this._state.isBeingOpened)throw new X.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,r);var s=this._versions,u=s.filter(function(c){return c._cfg.version===r})[0];return u||(u=new this.Version(r),s.push(u),s.sort(Ua),u.stores({}),this._state.autoSchema=!1,u)},Se.prototype._whenReady=function(r){var s=this;return this.idbdb&&(this._state.openComplete||Q.letThrough||this._vip)?r():new z(function(u,c){if(s._state.openComplete)return c(new X.DatabaseClosed(s._state.dbOpenError));if(!s._state.isBeingOpened){if(!s._state.autoOpen)return void c(new X.DatabaseClosed);s.open().catch(ye)}s._state.dbReadyPromise.then(u,c)}).then(r)},Se.prototype.use=function(r){var s=r.stack,u=r.create,c=r.level,h=r.name;return h&&this.unuse({stack:s,name:h}),r=this._middlewares[s]||(this._middlewares[s]=[]),r.push({stack:s,create:u,level:c??10,name:h}),r.sort(function(d,m){return d.level-m.level}),this},Se.prototype.unuse=function(r){var s=r.stack,u=r.name,c=r.create;return s&&this._middlewares[s]&&(this._middlewares[s]=this._middlewares[s].filter(function(h){return c?h.create!==c:!!u&&h.name!==u})),this},Se.prototype.open=function(){var r=this;return Nt(yt,function(){return Ha(r)})},Se.prototype._close=function(){var r=this._state,s=en.indexOf(this);if(0<=s&&en.splice(s,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}r.isBeingOpened||(r.dbReadyPromise=new z(function(u){r.dbReadyResolve=u}),r.openCanceller=new z(function(u,c){r.cancelOpen=c}))},Se.prototype.close=function(u){var s=(u===void 0?{disableAutoOpen:!0}:u).disableAutoOpen,u=this._state;s?(u.isBeingOpened&&u.cancelOpen(new X.DatabaseClosed),this._close(),u.autoOpen=!1,u.dbOpenError=new X.DatabaseClosed):(this._close(),u.autoOpen=this._options.autoOpen||u.isBeingOpened,u.openComplete=!1,u.dbOpenError=null)},Se.prototype.delete=function(r){var s=this;r===void 0&&(r={disableAutoOpen:!0});var u=0<arguments.length&&typeof arguments[0]!="object",c=this._state;return new z(function(h,d){function m(){s.close(r);var y=s._deps.indexedDB.deleteDatabase(s.name);y.onsuccess=Ee(function(){var b,k,A;b=s._deps,k=s.name,A=b.indexedDB,b=b.IDBKeyRange,bi(A)||k===hr||vi(A,b).delete(k).catch(ye),h()}),y.onerror=st(d),y.onblocked=s._fireOnBlocked}if(u)throw new X.InvalidArgument("Invalid closeOptions argument to db.delete()");c.isBeingOpened?c.dbReadyPromise.then(m):m()})},Se.prototype.backendDB=function(){return this.idbdb},Se.prototype.isOpen=function(){return this.idbdb!==null},Se.prototype.hasBeenClosed=function(){var r=this._state.dbOpenError;return r&&r.name==="DatabaseClosed"},Se.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Se.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Se.prototype,"tables",{get:function(){var r=this;return l(this._allTables).map(function(s){return r._allTables[s]})},enumerable:!1,configurable:!0}),Se.prototype.transaction=function(){var r=function(s,u,c){var h=arguments.length;if(h<2)throw new X.InvalidArgument("Too few arguments");for(var d=new Array(h-1);--h;)d[h-1]=arguments[h];return c=d.pop(),[s,ke(d),c]}.apply(this,arguments);return this._transaction.apply(this,r)},Se.prototype._transaction=function(r,s,u){var c=this,h=Q.trans;h&&h.db===this&&r.indexOf("!")===-1||(h=null);var d,m,y=r.indexOf("?")!==-1;r=r.replace("!","").replace("?","");try{if(m=s.map(function(k){if(k=k instanceof c.Table?k.name:k,typeof k!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return k}),r=="r"||r===oi)d=oi;else{if(r!="rw"&&r!=ai)throw new X.InvalidArgument("Invalid transaction mode: "+r);d=ai}if(h){if(h.mode===oi&&d===ai){if(!y)throw new X.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");h=null}h&&m.forEach(function(k){if(h&&h.storeNames.indexOf(k)===-1){if(!y)throw new X.SubTransaction("Table "+k+" not included in parent transaction.");h=null}}),y&&h&&!h.active&&(h=null)}}catch(k){return h?h._promise(null,function(A,v){v(k)}):Oe(k)}var b=function k(A,v,O,_,E){return z.resolve().then(function(){var P=Q.transless||Q,x=A._createTransaction(v,O,A._dbSchema,_);if(x.explicit=!0,P={trans:x,transless:P},_)x.idbtrans=_.idbtrans;else try{x.create(),x.idbtrans._explicit=!0,A._state.PR1398_maxLoop=3}catch(T){return T.name===Yr.InvalidState&&A.isOpen()&&0<--A._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),A.close({disableAutoOpen:!1}),A.open().then(function(){return k(A,v,O,null,E)})):Oe(T)}var C,R=Wt(E);return R&&Zt(),P=z.follow(function(){var T;(C=E.call(x,x))&&(R?(T=vt.bind(null,null),C.then(T,T)):typeof C.next=="function"&&typeof C.throw=="function"&&(C=Pi(C)))},P),(C&&typeof C.then=="function"?z.resolve(C).then(function(T){return x.active?T:Oe(new X.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):P.then(function(){return C})).then(function(T){return _&&x._resolve(),x._completion.then(function(){return T})}).catch(function(T){return x._reject(T),Oe(T)})})}.bind(null,this,d,m,h,u);return h?h._promise(d,b,"lock"):Q.trans?Nt(Q.transless,function(){return c._whenReady(b)}):this._whenReady(b)},Se.prototype.table=function(r){if(!S(this._allTables,r))throw new X.InvalidTable("Table ".concat(r," does not exist"));return this._allTables[r]},Se);function Se(r,s){var u=this;this._middlewares={},this.verno=0;var c=Se.dependencies;this._options=s=i({addons:Se.addons,autoOpen:!0,indexedDB:c.indexedDB,IDBKeyRange:c.IDBKeyRange,cache:"cloned"},s),this._deps={indexedDB:s.indexedDB,IDBKeyRange:s.IDBKeyRange},c=s.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var h,d,m,y,b,k={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ye,dbReadyPromise:null,cancelOpen:ye,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:s.autoOpen};k.dbReadyPromise=new z(function(v){k.dbReadyResolve=v}),k.openCanceller=new z(function(v,O){k.cancelOpen=O}),this._state=k,this.name=r,this.on=Rn(this,"populate","blocked","versionchange","close",{ready:[Xr,ye]}),this.on.ready.subscribe=fe(this.on.ready.subscribe,function(v){return function(O,_){Se.vip(function(){var E,P=u._state;P.openComplete?(P.dbOpenError||z.resolve().then(O),_&&v(O)):P.onReadyBeingFired?(P.onReadyBeingFired.push(O),_&&v(O)):(v(O),E=u,_||v(function x(){E.on.ready.unsubscribe(O),E.on.ready.unsubscribe(x)}))})}}),this.Collection=(h=this,Tn(Ka.prototype,function(C,x){this.db=h;var _=Ns,E=null;if(x)try{_=x()}catch(R){E=R}var P=C._ctx,x=P.table,C=x.hook.reading.fire;this._ctx={table:x,index:P.index,isPrimKey:!P.index||x.schema.primKey.keyPath&&P.index===x.schema.primKey.name,range:_,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:E,or:P.or,valueMapper:C!==An?C:null}})),this.Table=(d=this,Tn(Ks.prototype,function(v,O,_){this.db=d,this._tx=_,this.name=v,this.schema=O,this.hook=d._allTables[v]?d._allTables[v].hook:Rn(null,{creating:[Oa,ye],reading:[Pa,An],updating:[Ca,ye],deleting:[Sa,ye]})})),this.Transaction=(m=this,Tn(La.prototype,function(v,O,_,E,P){var x=this;this.db=m,this.mode=v,this.storeNames=O,this.schema=_,this.chromeTransactionDurability=E,this.idbtrans=null,this.on=Rn(this,"complete","error","abort"),this.parent=P||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new z(function(C,R){x._resolve=C,x._reject=R}),this._completion.then(function(){x.active=!1,x.on.complete.fire()},function(C){var R=x.active;return x.active=!1,x.on.error.fire(C),x.parent?x.parent._reject(C):R&&x.idbtrans&&x.idbtrans.abort(),Oe(C)})})),this.Version=(y=this,Tn(Ga.prototype,function(v){this.db=y,this._cfg={version:v,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(b=this,Tn(qs.prototype,function(v,O,_){if(this.db=b,this._ctx={table:v,index:O===":id"?null:O,or:_},this._cmp=this._ascending=le,this._descending=function(E,P){return le(P,E)},this._max=function(E,P){return 0<le(E,P)?E:P},this._min=function(E,P){return le(E,P)<0?E:P},this._IDBKeyRange=b._deps.IDBKeyRange,!this._IDBKeyRange)throw new X.MissingAPI})),this.on("versionchange",function(v){0<v.newVersion?console.warn("Another connection wants to upgrade database '".concat(u.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(u.name,"'. Closing db now to resume the delete request.")),u.close({disableAutoOpen:!1})}),this.on("blocked",function(v){!v.newVersion||v.newVersion<v.oldVersion?console.warn("Dexie.delete('".concat(u.name,"') was blocked")):console.warn("Upgrade '".concat(u.name,"' blocked by other connection holding version ").concat(v.oldVersion/10))}),this._maxKey=In(s.IDBKeyRange),this._createTransaction=function(v,O,_,E){return new u.Transaction(v,O,_,u._options.chromeTransactionDurability,E)},this._fireOnBlocked=function(v){u.on("blocked").fire(v),en.filter(function(O){return O.name===u.name&&O!==u&&!O._state.vcFired}).map(function(O){return O.on("versionchange").fire(v)})},this.use(Ya),this.use(eu),this.use(Xa),this.use(Wa),this.use(Qa);var A=new Proxy(this,{get:function(v,O,_){if(O==="_vip")return!0;if(O==="table")return function(P){return Or(u.table(P),A)};var E=Reflect.get(v,O,_);return E instanceof Ks?Or(E,A):O==="tables"?E.map(function(P){return Or(P,A)}):O==="_createTransaction"?function(){return Or(E.apply(this,arguments),A)}:E}});this.vip=A,c.forEach(function(v){return v(u)})}var Sr,Qe=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",tu=(Ri.prototype.subscribe=function(r,s,u){return this._subscribe(r&&typeof r!="function"?r:{next:r,error:s,complete:u})},Ri.prototype[Qe]=function(){return this},Ri);function Ri(r){this._subscribe=r}try{Sr={indexedDB:a.indexedDB||a.mozIndexedDB||a.webkitIndexedDB||a.msIndexedDB,IDBKeyRange:a.IDBKeyRange||a.webkitIDBKeyRange}}catch{Sr={indexedDB:null,IDBKeyRange:null}}function no(r){var s,u=!1,c=new tu(function(h){var d=Wt(r),m,y=!1,b={},k={},A={get closed(){return y},unsubscribe:function(){y||(y=!0,m&&m.abort(),v&&_t.storagemutated.unsubscribe(_))}};h.start&&h.start(A);var v=!1,O=function(){return si(E)},_=function(P){Er(b,P),ki(k,b)&&O()},E=function(){var P,x,C;!y&&Sr.indexedDB&&(b={},P={},m&&m.abort(),m=new AbortController,C=function(R){var T=Xt();try{d&&Zt();var N=gt(r,R);return N=d?N.finally(vt):N}finally{T&&Jt()}}(x={subscr:P,signal:m.signal,requery:O,querier:r,trans:null}),Promise.resolve(C).then(function(R){u=!0,s=R,y||x.signal.aborted||(b={},function(T){for(var N in T)if(S(T,N))return;return 1}(k=P)||v||(_t(Dn,_),v=!0),si(function(){return!y&&h.next&&h.next(R)}))},function(R){u=!1,["DatabaseClosedError","AbortError"].includes(R?.name)||y||si(function(){y||h.error&&h.error(R)})}))};return setTimeout(O,0),A});return c.hasValue=function(){return u},c.getValue=function(){return s},c}var Kt=dt;function Ti(r){var s=kt;try{kt=!0,_t.storagemutated.fire(r),Ai(r,!0)}finally{kt=s}}D(Kt,i(i({},rr),{delete:function(r){return new Kt(r,{addons:[]}).delete()},exists:function(r){return new Kt(r,{addons:[]}).open().then(function(s){return s.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(r){try{return s=Kt.dependencies,u=s.indexedDB,s=s.IDBKeyRange,(bi(u)?Promise.resolve(u.databases()).then(function(c){return c.map(function(h){return h.name}).filter(function(h){return h!==hr})}):vi(u,s).toCollection().primaryKeys()).then(r)}catch{return Oe(new X.MissingAPI)}var s,u},defineClass:function(){return function(r){p(this,r)}},ignoreTransaction:function(r){return Q.trans?Nt(Q.transless,r):r()},vip:wi,async:function(r){return function(){try{var s=Pi(r.apply(this,arguments));return s&&typeof s.then=="function"?s:z.resolve(s)}catch(u){return Oe(u)}}},spawn:function(r,s,u){try{var c=Pi(r.apply(u,s||[]));return c&&typeof c.then=="function"?c:z.resolve(c)}catch(h){return Oe(h)}},currentTransaction:{get:function(){return Q.trans||null}},waitFor:function(r,s){return s=z.resolve(typeof r=="function"?Kt.ignoreTransaction(r):r).timeout(s||6e4),Q.trans?Q.trans.waitFor(s):s},Promise:z,debug:{get:function(){return it},set:function(r){As(r)}},derive:L,extend:p,props:D,override:fe,Events:Rn,on:_t,liveQuery:no,extendObservabilitySet:Er,getByKeyPath:_e,setByKeyPath:Ae,delByKeyPath:function(r,s){typeof s=="string"?Ae(r,s,void 0):"length"in s&&[].map.call(s,function(u){Ae(r,u,void 0)})},shallowClone:Xe,deepClone:ce,getObjectDiff:Oi,cmp:le,asap:pe,minKey:-1/0,addons:[],connections:en,errnames:Yr,dependencies:Sr,cache:It,semVer:"4.0.9",version:"4.0.9".split(".").map(function(r){return parseInt(r)}).reduce(function(r,s,u){return r+s/Math.pow(10,2*u)})})),Kt.maxKey=In(Kt.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(_t(Dn,function(r){kt||(r=new CustomEvent(fi,{detail:r}),kt=!0,dispatchEvent(r),kt=!1)}),addEventListener(fi,function(r){r=r.detail,kt||Ti(r)}));var rn,kt=!1,ro=function(){};return typeof BroadcastChannel<"u"&&((ro=function(){(rn=new BroadcastChannel(fi)).onmessage=function(r){return r.data&&Ti(r.data)}})(),typeof rn.unref=="function"&&rn.unref(),_t(Dn,function(r){kt||rn.postMessage(r)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(r){if(!dt.disableBfCache&&r.persisted){it&&console.debug("Dexie: handling persisted pagehide"),rn?.close();for(var s=0,u=en;s<u.length;s++)u[s].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(r){!dt.disableBfCache&&r.persisted&&(it&&console.debug("Dexie: handling persisted pageshow"),ro(),Ti({all:new je(-1/0,[[]])}))})),z.rejectionMapper=function(r,s){return!r||r instanceof Qt||r instanceof TypeError||r instanceof SyntaxError||!r.name||!Es[r.name]?r:(s=new Es[r.name](s||r.message,r),"stack"in r&&V(s,"stack",{get:function(){return this.inner.stack}}),s)},As(it),i(dt,Object.freeze({__proto__:null,Dexie:dt,liveQuery:no,Entity:Ms,cmp:le,PropModSymbol:ht,PropModification:Nn,replacePrefix:function(r,s){return new Nn({replacePrefix:[r,s]})},add:function(r){return new Nn({add:r})},remove:function(r){return new Nn({remove:r})},default:dt,RangeSet:je,mergeRanges:Bn,rangesOverlap:Gs}),{default:dt}),dt})})(fa);var zc=fa.exports;const ns=Uc(zc),wo=Symbol.for("Dexie"),Br=globalThis[wo]||(globalThis[wo]=ns);if(ns.semVer!==Br.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${ns.semVer} and ${Br.semVer}`);const{liveQuery:jf,mergeRanges:Bf,rangesOverlap:Lf,RangeSet:$f,cmp:qf,Entity:Gr,PropModSymbol:Ff,PropModification:Uf,replacePrefix:zf,add:Vf,remove:Gf}=Br,Lr=["a","b","c","d","e","f","g","h"],ha=["1","2","3","4","5","6","7","8"],Vt=["white","black"],tt=["pawn","knight","bishop","rook","queen","king"],Vc=["a","h"],Wn=t=>"role"in t,Z=t=>t!==void 0,De=t=>t==="white"?"black":"white",Gt=t=>t>>3,Ue=t=>t&7,rs=(t,e)=>0<=t&&t<8&&0<=e&&e<8?t+8*e:void 0,Ft=t=>{switch(t){case"pawn":return"p";case"knight":return"n";case"bishop":return"b";case"rook":return"r";case"queen":return"q";case"king":return"k"}};function pn(t){switch(t.toLowerCase()){case"p":return"pawn";case"n":return"knight";case"b":return"bishop";case"r":return"rook";case"q":return"queen";case"k":return"king";default:return}}function mn(t){if(t.length===2)return rs(t.charCodeAt(0)-97,t.charCodeAt(1)-49)}const Et=t=>Lr[Ue(t)]+ha[Gt(t)],ms=t=>{if(t[1]==="@"&&t.length===4){const e=pn(t[0]),n=mn(t.slice(2));if(e&&Z(n))return{role:e,to:n}}else if(t.length===4||t.length===5){const e=mn(t.slice(0,2)),n=mn(t.slice(2,4));let i;if(t.length===5&&(i=pn(t[4]),!i))return;if(Z(e)&&Z(n))return{from:e,to:n,promotion:i}}},_o=t=>Wn(t)?`${Ft(t.role).toUpperCase()}@${Et(t.to)}`:Et(t.from)+Et(t.to)+(t.promotion?Ft(t.promotion):""),ys=(t,e)=>t==="white"?e==="a"?2:6:e==="a"?58:62,gs=(t,e)=>t==="white"?e==="a"?3:5:e==="a"?59:61,ko=t=>(t=t-(t>>>1&1431655765),t=(t&858993459)+(t>>>2&858993459),Math.imul(t+(t>>>4)&252645135,16843009)>>24),is=t=>(t=t>>>8&16711935|(t&16711935)<<8,t>>>16&65535|(t&65535)<<16),xo=t=>(t=t>>>1&1431655765|(t&1431655765)<<1,t=t>>>2&858993459|(t&858993459)<<2,t=t>>>4&252645135|(t&252645135)<<4,is(t));class M{constructor(e,n){this.lo=e|0,this.hi=n|0}static fromSquare(e){return e>=32?new M(0,1<<e-32):new M(1<<e,0)}static fromRank(e){return new M(255,0).shl64(8*e)}static fromFile(e){return new M(16843009<<e,16843009<<e)}static empty(){return new M(0,0)}static full(){return new M(4294967295,4294967295)}static corners(){return new M(129,2164260864)}static center(){return new M(402653184,24)}static backranks(){return new M(255,4278190080)}static backrank(e){return e==="white"?new M(255,0):new M(0,4278190080)}static lightSquares(){return new M(1437226410,1437226410)}static darkSquares(){return new M(2857740885,2857740885)}complement(){return new M(~this.lo,~this.hi)}xor(e){return new M(this.lo^e.lo,this.hi^e.hi)}union(e){return new M(this.lo|e.lo,this.hi|e.hi)}intersect(e){return new M(this.lo&e.lo,this.hi&e.hi)}diff(e){return new M(this.lo&~e.lo,this.hi&~e.hi)}intersects(e){return this.intersect(e).nonEmpty()}isDisjoint(e){return this.intersect(e).isEmpty()}supersetOf(e){return e.diff(this).isEmpty()}subsetOf(e){return this.diff(e).isEmpty()}shr64(e){return e>=64?M.empty():e>=32?new M(this.hi>>>e-32,0):e>0?new M(this.lo>>>e^this.hi<<32-e,this.hi>>>e):this}shl64(e){return e>=64?M.empty():e>=32?new M(0,this.lo<<e-32):e>0?new M(this.lo<<e,this.hi<<e^this.lo>>>32-e):this}bswap64(){return new M(is(this.hi),is(this.lo))}rbit64(){return new M(xo(this.hi),xo(this.lo))}minus64(e){const n=this.lo-e.lo,i=(n&e.lo&1)+(e.lo>>>1)+(n>>>1)>>>31;return new M(n,this.hi-(e.hi+i))}equals(e){return this.lo===e.lo&&this.hi===e.hi}size(){return ko(this.lo)+ko(this.hi)}isEmpty(){return this.lo===0&&this.hi===0}nonEmpty(){return this.lo!==0||this.hi!==0}has(e){return(e>=32?this.hi&1<<e-32:this.lo&1<<e)!==0}set(e,n){return n?this.with(e):this.without(e)}with(e){return e>=32?new M(this.lo,this.hi|1<<e-32):new M(this.lo|1<<e,this.hi)}without(e){return e>=32?new M(this.lo,this.hi&~(1<<e-32)):new M(this.lo&~(1<<e),this.hi)}toggle(e){return e>=32?new M(this.lo,this.hi^1<<e-32):new M(this.lo^1<<e,this.hi)}last(){if(this.hi!==0)return 63-Math.clz32(this.hi);if(this.lo!==0)return 31-Math.clz32(this.lo)}first(){if(this.lo!==0)return 31-Math.clz32(this.lo&-this.lo);if(this.hi!==0)return 63-Math.clz32(this.hi&-this.hi)}withoutFirst(){return this.lo!==0?new M(this.lo&this.lo-1,this.hi):new M(0,this.hi&this.hi-1)}moreThanOne(){return this.hi!==0&&this.lo!==0||(this.lo&this.lo-1)!==0||(this.hi&this.hi-1)!==0}singleSquare(){return this.moreThanOne()?void 0:this.last()}*[Symbol.iterator](){let e=this.lo,n=this.hi;for(;e!==0;){const i=31-Math.clz32(e&-e);e^=1<<i,yield i}for(;n!==0;){const i=31-Math.clz32(n&-n);n^=1<<i,yield 32+i}}*reversed(){let e=this.lo,n=this.hi;for(;n!==0;){const i=31-Math.clz32(n);n^=1<<i,yield 32+i}for(;e!==0;){const i=31-Math.clz32(e);e^=1<<i,yield i}}}const $r=(t,e)=>{let n=M.empty();for(const i of e){const o=t+i;0<=o&&o<64&&Math.abs(Ue(t)-Ue(o))<=2&&(n=n.with(o))}return n},Pt=t=>{const e=[];for(let n=0;n<64;n++)e[n]=t(n);return e},Gc=Pt(t=>$r(t,[-9,-8,-7,-1,1,7,8,9])),Hc=Pt(t=>$r(t,[-17,-15,-10,-6,6,10,15,17])),Wc={white:Pt(t=>$r(t,[7,9])),black:Pt(t=>$r(t,[-7,-9]))},Hr=t=>Gc[t],Wr=t=>Hc[t],er=(t,e)=>Wc[t][e],ss=Pt(t=>M.fromFile(Ue(t)).without(t)),os=Pt(t=>M.fromRank(Gt(t)).without(t)),as=Pt(t=>{const e=new M(134480385,2151686160),n=8*(Gt(t)-Ue(t));return(n>=0?e.shl64(n):e.shr64(-n)).without(t)}),us=Pt(t=>{const e=new M(270549120,16909320),n=8*(Gt(t)+Ue(t)-7);return(n>=0?e.shl64(n):e.shr64(-n)).without(t)}),cs=(t,e,n)=>{let i=n.intersect(e),o=i.bswap64();return i=i.minus64(t),o=o.minus64(t.bswap64()),i.xor(o.bswap64()).intersect(e)},Qc=(t,e)=>cs(M.fromSquare(t),ss[t],e),Yc=(t,e)=>{const n=os[t];let i=e.intersect(n),o=i.rbit64();return i=i.minus64(M.fromSquare(t)),o=o.minus64(M.fromSquare(63-t)),i.xor(o.rbit64()).intersect(n)},vn=(t,e)=>{const n=M.fromSquare(t);return cs(n,as[t],e).xor(cs(n,us[t],e))},bn=(t,e)=>Qc(t,e).xor(Yc(t,e)),vs=(t,e)=>vn(t,e).xor(bn(t,e)),Xc=(t,e,n)=>{switch(t.role){case"pawn":return er(t.color,e);case"knight":return Wr(e);case"bishop":return vn(e,n);case"rook":return bn(e,n);case"queen":return vs(e,n);case"king":return Hr(e)}},da=(t,e)=>{const n=M.fromSquare(e);return os[t].intersects(n)?os[t].with(t):us[t].intersects(n)?us[t].with(t):as[t].intersects(n)?as[t].with(t):ss[t].intersects(n)?ss[t].with(t):M.empty()},Qn=(t,e)=>da(t,e).intersect(M.full().shl64(t).xor(M.full().shl64(e))).withoutFirst();class yn{constructor(){}static default(){const e=new yn;return e.reset(),e}reset(){this.occupied=new M(65535,4294901760),this.promoted=M.empty(),this.white=new M(65535,0),this.black=new M(0,4294901760),this.pawn=new M(65280,16711680),this.knight=new M(66,1107296256),this.bishop=new M(36,603979776),this.rook=new M(129,2164260864),this.queen=new M(8,134217728),this.king=new M(16,268435456)}static empty(){const e=new yn;return e.clear(),e}clear(){this.occupied=M.empty(),this.promoted=M.empty();for(const e of Vt)this[e]=M.empty();for(const e of tt)this[e]=M.empty()}clone(){const e=new yn;e.occupied=this.occupied,e.promoted=this.promoted;for(const n of Vt)e[n]=this[n];for(const n of tt)e[n]=this[n];return e}getColor(e){if(this.white.has(e))return"white";if(this.black.has(e))return"black"}getRole(e){for(const n of tt)if(this[n].has(e))return n}get(e){const n=this.getColor(e);if(!n)return;const i=this.getRole(e),o=this.promoted.has(e);return{color:n,role:i,promoted:o}}take(e){const n=this.get(e);return n&&(this.occupied=this.occupied.without(e),this[n.color]=this[n.color].without(e),this[n.role]=this[n.role].without(e),n.promoted&&(this.promoted=this.promoted.without(e))),n}set(e,n){const i=this.take(e);return this.occupied=this.occupied.with(e),this[n.color]=this[n.color].with(e),this[n.role]=this[n.role].with(e),n.promoted&&(this.promoted=this.promoted.with(e)),i}has(e){return this.occupied.has(e)}*[Symbol.iterator](){for(const e of this.occupied)yield[e,this.get(e)]}pieces(e,n){return this[e].intersect(this[n])}rooksAndQueens(){return this.rook.union(this.queen)}bishopsAndQueens(){return this.bishop.union(this.queen)}kingOf(e){return this.pieces(e,"king").singleSquare()}}class at{constructor(){}static empty(){const e=new at;for(const n of tt)e[n]=0;return e}static fromBoard(e,n){const i=new at;for(const o of tt)i[o]=e.pieces(n,o).size();return i}clone(){const e=new at;for(const n of tt)e[n]=this[n];return e}equals(e){return tt.every(n=>this[n]===e[n])}add(e){const n=new at;for(const i of tt)n[i]=this[i]+e[i];return n}subtract(e){const n=new at;for(const i of tt)n[i]=this[i]-e[i];return n}nonEmpty(){return tt.some(e=>this[e]>0)}isEmpty(){return!this.nonEmpty()}hasPawns(){return this.pawn>0}hasNonPawns(){return this.knight>0||this.bishop>0||this.rook>0||this.queen>0||this.king>0}size(){return this.pawn+this.knight+this.bishop+this.rook+this.queen+this.king}}class Lt{constructor(e,n){this.white=e,this.black=n}static empty(){return new Lt(at.empty(),at.empty())}static fromBoard(e){return new Lt(at.fromBoard(e,"white"),at.fromBoard(e,"black"))}clone(){return new Lt(this.white.clone(),this.black.clone())}equals(e){return this.white.equals(e.white)&&this.black.equals(e.black)}add(e){return new Lt(this.white.add(e.white),this.black.add(e.black))}subtract(e){return new Lt(this.white.subtract(e.white),this.black.subtract(e.black))}count(e){return this.white[e]+this.black[e]}size(){return this.white.size()+this.black.size()}isEmpty(){return this.white.isEmpty()&&this.black.isEmpty()}nonEmpty(){return!this.isEmpty()}hasPawns(){return this.white.hasPawns()||this.black.hasPawns()}hasNonPawns(){return this.white.hasNonPawns()||this.black.hasNonPawns()}}class Yn{constructor(e,n){this.white=e,this.black=n}static default(){return new Yn(3,3)}clone(){return new Yn(this.white,this.black)}equals(e){return this.white===e.white&&this.black===e.black}}class pa{unwrap(e,n){const i=this._chain(o=>ne.ok(e?e(o):o),o=>n?ne.ok(n(o)):ne.err(o));if(i.isErr)throw i.error;return i.value}map(e,n){return this._chain(i=>ne.ok(e(i)),i=>ne.err(n?n(i):i))}chain(e,n){return this._chain(e,n||(i=>ne.err(i)))}}class Jc extends pa{constructor(e){super(),this.value=void 0,this.isOk=!0,this.isErr=!1,this.value=e}_chain(e,n){return e(this.value)}}class Zc extends pa{constructor(e){super(),this.error=void 0,this.isOk=!1,this.isErr=!0,this.error=e}_chain(e,n){return n(this.error)}}var ne;(function(t){t.ok=function(e){return new Jc(e)},t.err=function(e){return new Zc(e||new Error)},t.all=function(e){if(Array.isArray(e)){const o=[];for(let a=0;a<e.length;a++){const l=e[a];if(l.isErr)return l;o.push(l.value)}return t.ok(o)}const n={},i=Object.keys(e);for(let o=0;o<i.length;o++){const a=e[i[o]];if(a.isErr)return a;n[i[o]]=a.value}return t.ok(n)}})(ne||(ne={}));var xt;(function(t){t.Empty="ERR_EMPTY",t.OppositeCheck="ERR_OPPOSITE_CHECK",t.PawnsOnBackrank="ERR_PAWNS_ON_BACKRANK",t.Kings="ERR_KINGS",t.Variant="ERR_VARIANT"})(xt||(xt={}));class an extends Error{}const el=(t,e,n,i)=>n[e].intersect(bn(t,i).intersect(n.rooksAndQueens()).union(vn(t,i).intersect(n.bishopsAndQueens())).union(Wr(t).intersect(n.knight)).union(Hr(t).intersect(n.king)).union(er(De(e),t).intersect(n.pawn)));class $t{constructor(){}static default(){const e=new $t;return e.castlingRights=M.corners(),e.rook={white:{a:0,h:7},black:{a:56,h:63}},e.path={white:{a:new M(14,0),h:new M(96,0)},black:{a:new M(0,234881024),h:new M(0,1610612736)}},e}static empty(){const e=new $t;return e.castlingRights=M.empty(),e.rook={white:{a:void 0,h:void 0},black:{a:void 0,h:void 0}},e.path={white:{a:M.empty(),h:M.empty()},black:{a:M.empty(),h:M.empty()}},e}clone(){const e=new $t;return e.castlingRights=this.castlingRights,e.rook={white:{a:this.rook.white.a,h:this.rook.white.h},black:{a:this.rook.black.a,h:this.rook.black.h}},e.path={white:{a:this.path.white.a,h:this.path.white.h},black:{a:this.path.black.a,h:this.path.black.h}},e}add(e,n,i,o){const a=ys(e,n),l=gs(e,n);this.castlingRights=this.castlingRights.with(o),this.rook[e][n]=o,this.path[e][n]=Qn(o,l).with(l).union(Qn(i,a).with(a)).without(i).without(o)}static fromSetup(e){const n=$t.empty(),i=e.castlingRights.intersect(e.board.rook);for(const o of Vt){const a=M.backrank(o),l=e.board.kingOf(o);if(!Z(l)||!a.has(l))continue;const f=i.intersect(e.board[o]).intersect(a),p=f.first();Z(p)&&p<l&&n.add(o,"a",l,p);const g=f.last();Z(g)&&l<g&&n.add(o,"h",l,g)}return n}discardRook(e){if(this.castlingRights.has(e)){this.castlingRights=this.castlingRights.without(e);for(const n of Vt)for(const i of Vc)this.rook[n][i]===e&&(this.rook[n][i]=void 0)}}discardColor(e){this.castlingRights=this.castlingRights.diff(M.backrank(e)),this.rook[e].a=void 0,this.rook[e].h=void 0}}class tl{constructor(e){this.rules=e}reset(){this.board=yn.default(),this.pockets=void 0,this.turn="white",this.castles=$t.default(),this.epSquare=void 0,this.remainingChecks=void 0,this.halfmoves=0,this.fullmoves=1}setupUnchecked(e){this.board=e.board.clone(),this.board.promoted=M.empty(),this.pockets=void 0,this.turn=e.turn,this.castles=$t.fromSetup(e),this.epSquare=nl(this,e.epSquare),this.remainingChecks=void 0,this.halfmoves=e.halfmoves,this.fullmoves=e.fullmoves}kingAttackers(e,n,i){return el(e,n,this.board,i)}playCaptureAt(e,n){this.halfmoves=0,n.role==="rook"&&this.castles.discardRook(e),this.pockets&&this.pockets[De(n.color)][n.promoted?"pawn":n.role]++}ctx(){const e=this.isVariantEnd(),n=this.board.kingOf(this.turn);if(!Z(n))return{king:n,blockers:M.empty(),checkers:M.empty(),variantEnd:e,mustCapture:!1};const i=bn(n,M.empty()).intersect(this.board.rooksAndQueens()).union(vn(n,M.empty()).intersect(this.board.bishopsAndQueens())).intersect(this.board[De(this.turn)]);let o=M.empty();for(const l of i){const f=Qn(n,l).intersect(this.board.occupied);f.moreThanOne()||(o=o.union(f))}const a=this.kingAttackers(n,De(this.turn),this.board.occupied);return{king:n,blockers:o,checkers:a,variantEnd:e,mustCapture:!1}}clone(){var e,n;const i=new this.constructor;return i.board=this.board.clone(),i.pockets=(e=this.pockets)===null||e===void 0?void 0:e.clone(),i.turn=this.turn,i.castles=this.castles.clone(),i.epSquare=this.epSquare,i.remainingChecks=(n=this.remainingChecks)===null||n===void 0?void 0:n.clone(),i.halfmoves=this.halfmoves,i.fullmoves=this.fullmoves,i}validate(){if(this.board.occupied.isEmpty())return ne.err(new an(xt.Empty));if(this.board.king.size()!==2)return ne.err(new an(xt.Kings));if(!Z(this.board.kingOf(this.turn)))return ne.err(new an(xt.Kings));const e=this.board.kingOf(De(this.turn));return Z(e)?this.kingAttackers(e,this.turn,this.board.occupied).nonEmpty()?ne.err(new an(xt.OppositeCheck)):M.backranks().intersects(this.board.pawn)?ne.err(new an(xt.PawnsOnBackrank)):ne.ok(void 0):ne.err(new an(xt.Kings))}dropDests(e){return M.empty()}dests(e,n){if(n=n||this.ctx(),n.variantEnd)return M.empty();const i=this.board.get(e);if(!i||i.color!==this.turn)return M.empty();let o,a;if(i.role==="pawn"){o=er(this.turn,e).intersect(this.board[De(this.turn)]);const l=this.turn==="white"?8:-8,f=e+l;if(0<=f&&f<64&&!this.board.occupied.has(f)){o=o.with(f);const p=this.turn==="white"?e<16:e>=48,g=f+l;p&&!this.board.occupied.has(g)&&(o=o.with(g))}Z(this.epSquare)&&il(this,e,n)&&(a=M.fromSquare(this.epSquare))}else i.role==="bishop"?o=vn(e,this.board.occupied):i.role==="knight"?o=Wr(e):i.role==="rook"?o=bn(e,this.board.occupied):i.role==="queen"?o=vs(e,this.board.occupied):o=Hr(e);if(o=o.diff(this.board[this.turn]),Z(n.king)){if(i.role==="king"){const l=this.board.occupied.without(e);for(const f of o)this.kingAttackers(f,De(this.turn),l).nonEmpty()&&(o=o.without(f));return o.union(Eo(this,"a",n)).union(Eo(this,"h",n))}if(n.checkers.nonEmpty()){const l=n.checkers.singleSquare();if(!Z(l))return M.empty();o=o.intersect(Qn(l,n.king).with(l))}n.blockers.has(e)&&(o=o.intersect(da(e,n.king)))}return a&&(o=o.union(a)),o}isVariantEnd(){return!1}variantOutcome(e){}hasInsufficientMaterial(e){return this.board[e].intersect(this.board.pawn.union(this.board.rooksAndQueens())).nonEmpty()?!1:this.board[e].intersects(this.board.knight)?this.board[e].size()<=2&&this.board[De(e)].diff(this.board.king).diff(this.board.queen).isEmpty():this.board[e].intersects(this.board.bishop)?(!this.board.bishop.intersects(M.darkSquares())||!this.board.bishop.intersects(M.lightSquares()))&&this.board.pawn.isEmpty()&&this.board.knight.isEmpty():!0}toSetup(){var e,n;return{board:this.board.clone(),pockets:(e=this.pockets)===null||e===void 0?void 0:e.clone(),turn:this.turn,castlingRights:this.castles.castlingRights,epSquare:rl(this),remainingChecks:(n=this.remainingChecks)===null||n===void 0?void 0:n.clone(),halfmoves:Math.min(this.halfmoves,150),fullmoves:Math.min(Math.max(this.fullmoves,1),9999)}}isInsufficientMaterial(){return Vt.every(e=>this.hasInsufficientMaterial(e))}hasDests(e){e=e||this.ctx();for(const n of this.board[this.turn])if(this.dests(n,e).nonEmpty())return!0;return this.dropDests(e).nonEmpty()}isLegal(e,n){if(Wn(e))return!this.pockets||this.pockets[this.turn][e.role]<=0||e.role==="pawn"&&M.backranks().has(e.to)?!1:this.dropDests(n).has(e.to);{if(e.promotion==="pawn"||e.promotion==="king"&&this.rules!=="antichess"||!!e.promotion!==(this.board.pawn.has(e.from)&&M.backranks().has(e.to)))return!1;const i=this.dests(e.from,n);return i.has(e.to)||i.has(sl(this,e).to)}}isCheck(){const e=this.board.kingOf(this.turn);return Z(e)&&this.kingAttackers(e,De(this.turn),this.board.occupied).nonEmpty()}isEnd(e){return(e?e.variantEnd:this.isVariantEnd())?!0:this.isInsufficientMaterial()||!this.hasDests(e)}isCheckmate(e){return e=e||this.ctx(),!e.variantEnd&&e.checkers.nonEmpty()&&!this.hasDests(e)}isStalemate(e){return e=e||this.ctx(),!e.variantEnd&&e.checkers.isEmpty()&&!this.hasDests(e)}outcome(e){const n=this.variantOutcome(e);return n||(e=e||this.ctx(),this.isCheckmate(e)?{winner:De(this.turn)}:this.isInsufficientMaterial()||this.isStalemate(e)?{winner:void 0}:void 0)}allDests(e){e=e||this.ctx();const n=new Map;if(e.variantEnd)return n;for(const i of this.board[this.turn])n.set(i,this.dests(i,e));return n}play(e){const n=this.turn,i=this.epSquare,o=ma(this,e);if(this.epSquare=void 0,this.halfmoves+=1,n==="black"&&(this.fullmoves+=1),this.turn=De(n),Wn(e))this.board.set(e.to,{role:e.role,color:n}),this.pockets&&this.pockets[n][e.role]--,e.role==="pawn"&&(this.halfmoves=0);else{const a=this.board.take(e.from);if(!a)return;let l;if(a.role==="pawn"){this.halfmoves=0,e.to===i&&(l=this.board.take(e.to+(n==="white"?-8:8)));const f=e.from-e.to;Math.abs(f)===16&&8<=e.from&&e.from<=55&&(this.epSquare=e.from+e.to>>1),e.promotion&&(a.role=e.promotion,a.promoted=!!this.pockets)}else if(a.role==="rook")this.castles.discardRook(e.from);else if(a.role==="king"){if(o){const f=this.castles.rook[n][o];if(Z(f)){const p=this.board.take(f);this.board.set(ys(n,o),a),p&&this.board.set(gs(n,o),p)}}this.castles.discardColor(n)}if(!o){const f=this.board.set(e.to,a)||l;f&&this.playCaptureAt(e.to,f)}}this.remainingChecks&&this.isCheck()&&(this.remainingChecks[n]=Math.max(this.remainingChecks[n]-1,0))}}class tr extends tl{constructor(){super("chess")}static default(){const e=new this;return e.reset(),e}static fromSetup(e){const n=new this;return n.setupUnchecked(e),n.validate().map(i=>n)}clone(){return super.clone()}}const nl=(t,e)=>{if(!Z(e))return;const n=t.turn==="white"?5:2,i=t.turn==="white"?8:-8;if(Gt(e)!==n||t.board.occupied.has(e+i))return;const o=e-i;if(!(!t.board.pawn.has(o)||!t.board[De(t.turn)].has(o)))return e},rl=t=>{if(!Z(t.epSquare))return;const e=t.ctx(),i=t.board.pieces(t.turn,"pawn").intersect(er(De(t.turn),t.epSquare));for(const o of i)if(t.dests(o,e).has(t.epSquare))return t.epSquare},il=(t,e,n)=>{if(!Z(t.epSquare)||!er(t.turn,e).has(t.epSquare))return!1;if(!Z(n.king))return!0;const i=t.turn==="white"?8:-8,o=t.epSquare-i;return t.kingAttackers(n.king,De(t.turn),t.board.occupied.toggle(e).toggle(o).with(t.epSquare)).without(o).isEmpty()},Eo=(t,e,n)=>{if(!Z(n.king)||n.checkers.nonEmpty())return M.empty();const i=t.castles.rook[t.turn][e];if(!Z(i)||t.castles.path[t.turn][e].intersects(t.board.occupied))return M.empty();const o=ys(t.turn,e),a=Qn(n.king,o),l=t.board.occupied.without(n.king);for(const g of a)if(t.kingAttackers(g,De(t.turn),l).nonEmpty())return M.empty();const f=gs(t.turn,e),p=t.board.occupied.toggle(n.king).toggle(i).toggle(f);return t.kingAttackers(o,De(t.turn),p).nonEmpty()?M.empty():M.fromSquare(i)},ma=(t,e)=>{if(Wn(e))return;const n=e.to-e.from;if(!(Math.abs(n)!==2&&!t.board[t.turn].has(e.to))&&t.board.king.has(e.from))return n>0?"h":"a"},sl=(t,e)=>{const n=ma(t,e);if(!n)return e;const i=t.castles.rook[t.turn][n];return{from:e.from,to:Z(i)?i:e.to}},ol=(t,e)=>{const n=new Map,i=t.ctx();for(const[o,a]of t.allDests(i))if(a.nonEmpty()){const l=Array.from(a,Et);o===i.king&&Ue(o)===4&&(a.has(0)?l.push("c1"):a.has(56)&&l.push("c8"),a.has(7)?l.push("g1"):a.has(63)&&l.push("g8")),n.set(Et(o),l)}return n},al="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR",ul=al+" w KQkq -",ya=ul+" 0 1";var Re;(function(t){t.Fen="ERR_FEN",t.Board="ERR_BOARD",t.Pockets="ERR_POCKETS",t.Turn="ERR_TURN",t.Castling="ERR_CASTLING",t.EpSquare="ERR_EP_SQUARE",t.RemainingChecks="ERR_REMAINING_CHECKS",t.Halfmoves="ERR_HALFMOVES",t.Fullmoves="ERR_FULLMOVES"})(Re||(Re={}));class Ie extends Error{}const cl=(t,e,n)=>{let i=t.indexOf(e);for(;n-- >0&&i!==-1;)i=t.indexOf(e,i+e.length);return i},fn=t=>/^\d{1,4}$/.test(t)?parseInt(t,10):void 0,ga=t=>{const e=pn(t);return e&&{role:e,color:t.toLowerCase()===t?"black":"white"}},Bi=t=>{const e=yn.empty();let n=7,i=0;for(let o=0;o<t.length;o++){const a=t[o];if(a==="/"&&i===8)i=0,n--;else{const l=parseInt(a,10);if(l>0)i+=l;else{if(i>=8||n<0)return ne.err(new Ie(Re.Board));const f=i+n*8,p=ga(a);if(!p)return ne.err(new Ie(Re.Board));t[o+1]==="~"&&(p.promoted=!0,o++),e.set(f,p),i++}}}return n!==0||i!==8?ne.err(new Ie(Re.Board)):ne.ok(e)},Ao=t=>{if(t.length>64)return ne.err(new Ie(Re.Pockets));const e=Lt.empty();for(const n of t){const i=ga(n);if(!i)return ne.err(new Ie(Re.Pockets));e[i.color][i.role]++}return ne.ok(e)},ll=(t,e)=>{let n=M.empty();if(e==="-")return ne.ok(n);for(const i of e){const o=i.toLowerCase(),a=i===o?"black":"white",l=a==="white"?0:7;if("a"<=o&&o<="h")n=n.with(rs(o.charCodeAt(0)-97,l));else if(o==="k"||o==="q"){const f=t[a].intersect(M.backrank(a)).intersect(t.rook.union(t.king)),p=o==="k"?f.last():f.first();n=n.with(Z(p)&&t.rook.has(p)?p:rs(o==="k"?7:0,l))}else return ne.err(new Ie(Re.Castling))}return Vt.some(i=>M.backrank(i).intersect(n).size()>2)?ne.err(new Ie(Re.Castling)):ne.ok(n)},Po=t=>{const e=t.split("+");if(e.length===3&&e[0]===""){const n=fn(e[1]),i=fn(e[2]);return!Z(n)||n>3||!Z(i)||i>3?ne.err(new Ie(Re.RemainingChecks)):ne.ok(new Yn(3-n,3-i))}else if(e.length===2){const n=fn(e[0]),i=fn(e[1]);return!Z(n)||n>3||!Z(i)||i>3?ne.err(new Ie(Re.RemainingChecks)):ne.ok(new Yn(n,i))}else return ne.err(new Ie(Re.RemainingChecks))},xn=t=>{const e=t.split(/[\s_]+/),n=e.shift();let i,o=ne.ok(void 0);if(n.endsWith("]")){const f=n.indexOf("[");if(f===-1)return ne.err(new Ie(Re.Fen));i=Bi(n.slice(0,f)),o=Ao(n.slice(f+1,-1))}else{const f=cl(n,"/",7);f===-1?i=Bi(n):(i=Bi(n.slice(0,f)),o=Ao(n.slice(f+1)))}let a;const l=e.shift();if(!Z(l)||l==="w")a="white";else if(l==="b")a="black";else return ne.err(new Ie(Re.Turn));return i.chain(f=>{const p=e.shift(),g=Z(p)?ll(f,p):ne.ok(M.empty()),w=e.shift();let S;if(Z(w)&&w!=="-"&&(S=mn(w),!Z(S)))return ne.err(new Ie(Re.EpSquare));let D=e.shift(),I;Z(D)&&D.includes("+")&&(I=Po(D),D=e.shift());const V=Z(D)?fn(D):0;if(!Z(V))return ne.err(new Ie(Re.Halfmoves));const L=e.shift(),H=Z(L)?fn(L):1;if(!Z(H))return ne.err(new Ie(Re.Fullmoves));const Y=e.shift();let W=ne.ok(void 0);if(Z(Y)){if(Z(I))return ne.err(new Ie(Re.RemainingChecks));W=Po(Y)}else Z(I)&&(W=I);return e.length>0?ne.err(new Ie(Re.Fen)):o.chain(fe=>g.chain(oe=>W.map(pe=>({board:f,pockets:fe,turn:a,castlingRights:oe,remainingChecks:pe,epSquare:S,halfmoves:V,fullmoves:Math.max(1,H)}))))})},fl=t=>{let e=Ft(t.role);return t.color==="white"&&(e=e.toUpperCase()),t.promoted&&(e+="~"),e},hl=t=>{let e="",n=0;for(let i=7;i>=0;i--)for(let o=0;o<8;o++){const a=o+i*8,l=t.get(a);l?(n>0&&(e+=n,n=0),e+=fl(l)):n++,o===7&&(n>0&&(e+=n,n=0),i!==0&&(e+="/"))}return e},Oo=t=>tt.map(e=>Ft(e).repeat(t[e])).join(""),dl=t=>Oo(t.white).toUpperCase()+Oo(t.black),pl=(t,e)=>{let n="";for(const i of Vt){const o=M.backrank(i);let a=t.kingOf(i);Z(a)&&!o.has(a)&&(a=void 0);const l=t.pieces(i,"rook").intersect(o);for(const f of e.intersect(o).reversed())if(f===l.first()&&Z(a)&&f<a)n+=i==="white"?"Q":"q";else if(f===l.last()&&Z(a)&&a<f)n+=i==="white"?"K":"k";else{const p=Lr[Ue(f)];n+=i==="white"?p.toUpperCase():p}}return n||"-"},ml=t=>`${t.white}+${t.black}`,va=(t,e)=>[hl(t.board)+(t.pockets?`[${dl(t.pockets)}]`:""),t.turn[0],pl(t.board,t.castlingRights),Z(t.epSquare)?Et(t.epSquare):"-",...t.remainingChecks?[ml(t.remainingChecks)]:[],Math.max(0,Math.min(t.halfmoves,9999)),Math.max(1,Math.min(t.fullmoves,9999))].join(" "),yl=(t,e)=>{let n="";if(Wn(e))e.role!=="pawn"&&(n=Ft(e.role).toUpperCase()),n+="@"+Et(e.to);else{const i=t.board.getRole(e.from);if(!i)return"--";if(i==="king"&&(t.board[t.turn].has(e.to)||Math.abs(e.to-e.from)===2))n=e.to>e.from?"O-O":"O-O-O";else{const o=t.board.occupied.has(e.to)||i==="pawn"&&Ue(e.from)!==Ue(e.to);if(i!=="pawn"){n=Ft(i).toUpperCase();let a;if(i==="king"?a=Hr(e.to).intersect(t.board.king):i==="queen"?a=vs(e.to,t.board.occupied).intersect(t.board.queen):i==="rook"?a=bn(e.to,t.board.occupied).intersect(t.board.rook):i==="bishop"?a=vn(e.to,t.board.occupied).intersect(t.board.bishop):a=Wr(e.to).intersect(t.board.knight),a=a.intersect(t.board[t.turn]).without(e.from),a.nonEmpty()){const l=t.ctx();for(const f of a)t.dests(f,l).has(e.to)||(a=a.without(f));if(a.nonEmpty()){let f=!1,p=a.intersects(M.fromRank(Gt(e.from)));a.intersects(M.fromFile(Ue(e.from)))?f=!0:p=!0,p&&(n+=Lr[Ue(e.from)]),f&&(n+=ha[Gt(e.from)])}}}else o&&(n=Lr[Ue(e.from)]);o&&(n+="x"),n+=Et(e.to),e.promotion&&(n+="="+Ft(e.promotion).toUpperCase())}}return n},gl=(t,e)=>{var n;const i=yl(t,e);return t.play(e),!((n=t.outcome())===null||n===void 0)&&n.winner?i+"#":t.isCheck()?i+"+":i},ba=(t,e)=>gl(t.clone(),e),So=(t,e)=>{const n=t.ctx(),i=e.match(/^([NBRQK])?([a-h])?([1-8])?[-x]?([a-h][1-8])(?:=?([nbrqkNBRQK]))?[+#]?$/);if(!i){let w;if(e==="O-O"||e==="O-O+"||e==="O-O#"?w="h":(e==="O-O-O"||e==="O-O-O+"||e==="O-O-O#")&&(w="a"),w){const I=t.castles.rook[t.turn][w];return!Z(n.king)||!Z(I)||!t.dests(n.king,n).has(I)?void 0:{from:n.king,to:I}}const S=e.match(/^([pnbrqkPNBRQK])?@([a-h][1-8])[+#]?$/);if(!S)return;const D={role:S[1]?pn(S[1]):"pawn",to:mn(S[2])};return t.isLegal(D,n)?D:void 0}const o=i[1]?pn(i[1]):"pawn",a=mn(i[4]),l=i[5]?pn(i[5]):void 0;if(!!l!==(o==="pawn"&&M.backranks().has(a))||l==="king"&&t.rules!=="antichess")return;let f=t.board.pieces(t.turn,o);o==="pawn"&&!i[2]?f=f.intersect(M.fromFile(Ue(a))):i[2]&&(f=f.intersect(M.fromFile(i[2].charCodeAt(0)-97))),i[3]&&(f=f.intersect(M.fromRank(i[3].charCodeAt(0)-49)));const p=o==="pawn"?M.fromFile(Ue(a)):M.empty();f=f.intersect(p.union(Xc({color:De(t.turn),role:o},a,t.board.occupied)));let g;for(const w of f)if(t.dests(w,n).has(a)){if(Z(g))return;g=w}if(Z(g))return{from:g,to:a,promotion:l}},vl=(t=bs)=>({headers:t(),moves:new wa});let wa=class{constructor(){this.children=[]}*mainlineNodes(){let e=this;for(;e.children.length;){const n=e.children[0];yield n,e=n}}*mainline(){for(const e of this.mainlineNodes())yield e.data}end(){let e=this;for(;e.children.length;)e=e.children[0];return e}};class bl extends wa{constructor(e){super(),this.data=e}}const bs=()=>new Map([["Event","?"],["Site","?"],["Date","????.??.??"],["Round","?"],["White","?"],["Black","?"],["Result","*"]]),Co="\uFEFF",Li=t=>/^\s*$/.test(t),$i=t=>t.startsWith("%");class wl extends Error{}class _l{constructor(e,n=bs,i=1e6){this.emitGame=e,this.initHeaders=n,this.maxBudget=i,this.lineBuf=[],this.resetGame(),this.state=0}resetGame(){this.budget=this.maxBudget,this.found=!1,this.state=1,this.game=vl(this.initHeaders),this.stack=[{parent:this.game.moves,root:!0}],this.commentBuf=[]}consumeBudget(e){if(this.budget-=e,this.budget<0)throw new wl("ERR_PGN_BUDGET")}parse(e,n){if(!(this.budget<0))try{let i=0;for(;;){const o=e.indexOf(`
`,i);if(o===-1)break;const a=o>i&&e[o-1]==="\r"?o-1:o;this.consumeBudget(o-i),this.lineBuf.push(e.slice(i,a)),i=o+1,this.handleLine()}this.consumeBudget(e.length-i),this.lineBuf.push(e.slice(i)),n?.stream||(this.handleLine(),this.emit(void 0))}catch(i){this.emit(i)}}handleLine(){let e=!0,n=this.lineBuf.join("");this.lineBuf=[];e:for(;;)switch(this.state){case 0:n.startsWith(Co)&&(n=n.slice(Co.length)),this.state=1;case 1:if(Li(n)||$i(n))return;this.found=!0,this.state=2;case 2:{if($i(n))return;let i=!0;for(;i;)i=!1,n=n.replace(/^\s*\[([A-Za-z0-9][A-Za-z0-9_+#=:-]*)\s+"((?:[^"\\]|\\"|\\\\)*)"\]/,(o,a,l)=>(this.consumeBudget(200),this.game.headers.set(a,l.replace(/\\"/g,'"').replace(/\\\\/g,"\\")),i=!0,e=!1,""));if(Li(n))return;this.state=3}case 3:{if(e){if($i(n))return;if(Li(n))return this.emit(void 0)}const i=/(?:[NBKRQ]?[a-h]?[1-8]?[-x]?[a-h][1-8](?:=?[nbrqkNBRQK])?|[pnbrqkPNBRQK]?@[a-h][1-8]|O-O-O|0-0-0|O-O|0-0)[+#]?|--|Z0|0000|@@@@|{|;|\$\d{1,4}|[?!]{1,2}|\(|\)|\*|1-0|0-1|1\/2-1\/2/g;let o;for(;o=i.exec(n);){const a=this.stack[this.stack.length-1];let l=o[0];if(l===";")return;if(l.startsWith("$"))this.handleNag(parseInt(l.slice(1),10));else if(l==="!")this.handleNag(1);else if(l==="?")this.handleNag(2);else if(l==="!!")this.handleNag(3);else if(l==="??")this.handleNag(4);else if(l==="!?")this.handleNag(5);else if(l==="?!")this.handleNag(6);else if(l==="1-0"||l==="0-1"||l==="1/2-1/2"||l==="*")this.stack.length===1&&l!=="*"&&this.game.headers.set("Result",l);else if(l==="(")this.consumeBudget(100),this.stack.push({parent:a.parent,root:!1});else if(l===")")this.stack.length>1&&this.stack.pop();else if(l==="{"){const f=i.lastIndex,p=n[f]===" "?f+1:f;n=n.slice(p),this.state=4;continue e}else this.consumeBudget(100),l==="Z0"||l==="0000"||l==="@@@@"?l="--":l.startsWith("0")&&(l=l.replace(/0/g,"O")),a.node&&(a.parent=a.node),a.node=new bl({san:l,startingComments:a.startingComments}),a.startingComments=void 0,a.root=!1,a.parent.children.push(a.node)}return}case 4:{const i=n.indexOf("}");if(i===-1){this.commentBuf.push(n);return}else{const o=i>0&&n[i-1]===" "?i-1:i;this.commentBuf.push(n.slice(0,o)),this.handleComment(),n=n.slice(i),this.state=3,e=!1}}}}handleNag(e){var n;this.consumeBudget(50);const i=this.stack[this.stack.length-1];i.node&&((n=i.node.data).nags||(n.nags=[]),i.node.data.nags.push(e))}handleComment(){var e,n;this.consumeBudget(100);const i=this.stack[this.stack.length-1],o=this.commentBuf.join(`
`);this.commentBuf=[],i.node?((e=i.node.data).comments||(e.comments=[]),i.node.data.comments.push(o)):i.root?((n=this.game).comments||(n.comments=[]),this.game.comments.push(o)):(i.startingComments||(i.startingComments=[]),i.startingComments.push(o))}emit(e){if(this.state===4&&this.handleComment(),e)return this.emitGame(this.game,e);this.found&&this.emitGame(this.game,void 0),this.resetGame()}}const kl=(t,e=bs)=>{const n=[];return new _l(i=>n.push(i),e,NaN).parse(t),n},xl=(t,e)=>t==="white"?e:-e,_a=t=>2/(1+Math.exp(-.00368208*t))-1,El=t=>_a(Math.min(Math.max(-1e3,t),1e3)),Al=t=>{const n=(21-Math.min(10,Math.abs(t)))*100*(t>0?1:-1);return _a(n)},Pl=t=>typeof t.mate<"u"?Al(t.mate):El(t.cp),Ro=(t,e)=>xl(t,Pl(e)),Ol=(t,e,n)=>103.1668*Math.exp(-.04354*(Ro(t,e)*100-Ro(t,n)*100))-3.1669;class Sl{async request_move_data(e,n){console.log(e,n);let i={cp:Math.random()*1e3},o={cp:i.cp-Math.random()*200},a=Ol("white",i,o),l=Tl(n).slice(0,4);return{before_cp:i,after_cp:o,accuracy:a,multi_pvs4:l}}}const Cl=new Sl;function Wf(t,e){let n=xn(t).unwrap(),i=tr.fromSetup(n).unwrap(),o=ms(e);return i.play(o),va(i.toSetup())}function Qf(t,e){let n=xn(t).unwrap(),i=tr.fromSetup(n).unwrap(),o=ms(e);return ba(i,o)}const Rl=t=>xn(t).unwrap().turn;function Tl(t){let e=tr.fromSetup(xn(t).unwrap()).unwrap(),n=[];for(let[i,o]of ol(e))n.push(...o.map(a=>i+a));return n}class Qr{constructor(e,n){this.headers=e,this.tree=n}static make_many=e=>kl(e).flatMap(n=>{let i=n.headers.get("Event"),o=n.headers.get("Site"),a=n.headers.get("White"),l=n.headers.get("Black"),f=n.headers.get("Puzzle"),p=n.headers.get("Section"),g=n.headers.get("Chapter"),w=n.headers.get("FEN"),S=w??ya,D=tr.fromSetup(xn(S).unwrap()).unwrap(),I=n.moves.children.map(Y=>{let W=Y.data.san,fe=So(D,W);return[_o(fe)]}),V=hn.make(S,I);n.moves.children.forEach(Y=>{L(V,Y,D,[])});function L(Y,W,fe,oe){let pe=So(fe,W.data.san),_e=fe.clone();_e.play(pe);let Ae=_o(pe),Xe=W.data.nags;Y.append_uci(Ae,oe),Y.set_nags([...oe,Ae],Xe),W.children.forEach(ve=>{L(Y,ve,_e,[...oe,Ae])})}return new Qr({event:i,site:o,white:a,black:l,puzzle:f,section:p,chapter:g,fen:w},V)});get event(){return this.headers.event}get site(){return this.headers.site}get white(){return this.headers.white}get black(){return this.headers.black}get puzzle(){return this.headers.puzzle}get section(){return this.headers.section}get chapter(){return this.headers.chapter}get fen(){return this.headers.fen}}class Ut{constructor(e){this.data=e,this._children=Ke([])}static color_of(e){return Rl(e.data.before_fen)}static make=e=>new Ut(e);get clone(){let e=new Ut({...this.data});return e.children=this.children.map(n=>n.clone),e}get all_leaves(){return this.children.length===0?[this]:this.children.flatMap(e=>e.all_leaves)}get length(){if(this.children.length>1)return 1;if(this.children.length===0)return 0;let e=1,n=this.children[0];for(;n?.children.length===1;)e++,n=n.children[0];return e}get nb_first_variations(){return this.children_first_variations?.length??0}get first_node_with_variations(){if(this.children.length!==0)return this.children.length===1?this.children[0].first_node_with_variations:this}get children_first_variations(){return this.first_node_with_variations?.children}get children(){return this._children[0]()}set children(e){this._children[1](e)}get all_nodes(){return[this.data,...this.children.flatMap(e=>e.all_nodes)]}_children}class ls{constructor(e){this.root=e}static make=e=>{function n(f,p){let g=f.data.path.length,w=f.length,S=f.nb_first_variations,D=-p*100+1/(g/40)*10+w/20*10+(S+1)*100,I=Ut.make({path:f.data.path,uci:f.data.uci,score:D}),V=f.children.length+p,L=V*(V+1)/2;return I.children=f.children.map((H,Y)=>n(H,(Y+p)/L)),I}function i(f){return f.data.score+f.children.map(g=>i(g)).reduce((g,w)=>g+w,0)}function o(f,p){f.data.score/=p,f.children.forEach(g=>o(g,p))}let a=e.root.map(f=>n(f,1)),l=a.map(f=>i(f)).reduce((f,p)=>f+p,0);return a.forEach(f=>o(f,l)),new ls(a)};get clone(){return new ls(this.root.map(e=>e.clone))}get progress_paths(){function e(i,o,a){o.push(i.data.path),i.children.length===0?a.push(o):i.children.length===1?e(i.children[0],o,a):(a.push(o),i.children.forEach(l=>{e(l,[],a)}))}let n=[];return this.root.forEach(i=>e(i,[],n)),n}_traverse_path(e){let n,i=this.root;for(let o of e){if(n=i.find(a=>a.data.uci===o),!n)return;i=n.children}return n}get_children(e){return this._traverse_path(e)?.children.map(i=>i.data)}get_at(e){return this._traverse_path(e)?.data}delete_at(e){const n=this._traverse_path(e.slice(0,-1));n&&(n.children=n.children.filter(i=>i.data.path.join("")!==e.join("")))}}class hn{constructor(e){this.root=e}static make=(e,n)=>{let i=n.map(a=>a[0]),o=new hn(i.map(a=>Ut.make(hn.make_data(e,a,1,[]))));return n.forEach(a=>o.append_ucis(a)),o};get before_fen(){return this.root[0]?.data.before_fen??ya}get initial_color(){if(this.root[0])return Ut.color_of(this.root[0])}get clone(){return new hn(this.root.map(e=>e.clone))}static make_data(e,n,i,o){let a=xn(e).unwrap(),l=tr.fromSetup(a).unwrap(),f=ms(n),p=ba(l,f);return l.play(f),{path:[...o,n],ply:i,before_fen:e,san:p,after_fen:va(l.toSetup()),uci:n}}_traverse_path(e){let n,i=this.root;for(let o of e){if(n=i.find(a=>a.data.uci===o),!n)return;i=n.children}return n}_find_path(e){let n=[],i=[],o,a=this.root,l=!1;for(let f of e)if(l)i.push(f);else{let p=a?.find(g=>g.data.uci===f);p?(n.push(f),o=p,a=Pe(()=>o?.children)):(l=!0,i.push(f))}return[n,o,i]}get all_moves(){return this.root.flatMap(e=>e.all_nodes)}get all_leaves(){return this.root.flatMap(e=>e.all_leaves.map(n=>n.data))}get_children(e){return this._traverse_path(e)?.children.map(i=>i.data)}async request_ceval_and_get_at(e){let n=this.get_at(e);if(n)return n.eval_accuracy=await Cl.request_move_data(n.before_fen,n.after_fen),n}collect_branch_sums(e){let n=[],i=this.root,o=this.root.length>1;for(let a of e){let l=i.find(f=>f.data.uci===a);if(!l)return;o&&(n.push(l.data),o=!1),l.children.length>1&&(o=!0),i=l.children}return n}get_at(e){return this._traverse_path(e)?.data}delete_at(e){const n=this._traverse_path(e.slice(0,-1));n&&(n.children=n.children.filter(i=>i.data.path.join("")!==e.join("")))}set_nags(e,n){let i=this._traverse_path(e);i&&(i.data.nags=n)}append_uci(e,n=[]){this.append_ucis([...n,e])}append_ucis(e){let[n,i,o]=this._find_path(e);if(i!==void 0)for(let a of o){let l=Ut.make(hn.make_data(i.data.after_fen,a,i.data.ply+1,n)),f=Pe(()=>i.children);i.children=[...f,l],i=l,n=[...n,a]}}}const Nl=(t,e,n,i)=>{let o=Qr.make_many(t).map(a=>{let l=a.site?.includes("http")?a.site:`https://lichess.org/study/${e}`,f=a.event,p;if(f?.includes(": "))[n,p]=f.split(": ");else if(a.white!=="?"){let g=a.white,w=a.black;p=`${g} vs ${w} at ${f}`}else p=f;return{name:p,site:l,pgn:a}});return{id:e,name:n,orientation:i,chapters:o}},ws=(t,e,n,i,o)=>{let a=[];return Qr.make_many(t).map(l=>{let f,p;l.section?(f=l.section,p=l.chapter):[n,f,p]=l.event.split(":");let g=a.find(w=>w.name===f);g||a.push(g={name:f,chapters:[]}),g?.chapters.push({name:p,pgn:l})}),{id:e,name:n,orientation:i,import_lichess_link:o,sections:a}},Ml=(t,e,n)=>fetch(`pgns/${t}.pgn`).then(i=>i.text()).then(i=>Nl(i,t,e,n)),Dl=(t,e,n)=>fetch(`pgns/${t}.section.pgn`).then(i=>i.text()).then(i=>ws(i,t,e,n)),Il=(t,e,n)=>{let[i]=zn("","pgn.imported."+t);return ws(i(),t,e,"white",n)};class _s{static init=()=>new _s;async read_section_study(e){let{study_name:n,orientation:i,import_lichess_link:o}=Nr.study_by_id(e)||Nr.imported_by_id(e);return o?Il(e,n,o):Dl(e,n,i)}read_study(e){let{study_name:n,orientation:i}=Nr.study_by_id(e);return Ml(e,n,i)}}const Kl=_s.init(),jl={Openings:[["Berlin Defence","berlin","white"],["Slav Defense","slav","black"],["London System","london-system","black"],["Caro-Kann Defense","caro-kann","white"],["Petroff Defense","petroff","white"],["Philidor Defence","philidor","white"],["Accelerated Dragon","accelerated-dragon","white"],["Caro Kann","","white"],["Four-Knights","","white"],["Sicilian Defense","","white"],["French Defense","","black"]],Masters:[["Bobby Fischer 60 Memorable Games","",60],["Magnus Carlsen 2023",""],["Tata Steel 2023",""]],Tactics:[["50 Puzzles 1600","",50],["50 Puzzles 2000","",50],["50 Puzzles 2200","",50]],Endgames:[["100 Endgames You Must Know",""],["King and Pawn Endgames",""]]};class ks{static init=()=>{function e(i){return jl[i].map(o=>({category:i,study_name:o[0],study_id:o[1],orientation:o[3]}))}let n=new ks;return n.openings=e("Openings"),n.masters=e("Masters"),n.tactics=e("Tactics"),n.endgames=e("Endgames"),n.all=[...n.openings,...n.masters,...n.tactics,...n.endgames],n.recent=[],n.completed=[],n.imported=zn([],"fixture.imported"),n};clear_progress(e){Object.entries(localStorage).map(n=>n[0]).filter(n=>n.includes(`.openings.id.${e}`)).map(n=>localStorage.removeItem(n))}async update_imported_study(e){let n=`https://lichess.org/study/${e}`,i=await fetch(`https://lichess.org/api/study/${e}.pgn`).then(o=>o.text());Nr.save_import_pgn(e,i,n)}delete_imported_study(e){let n=this.imported[0]();n=n.filter(a=>a.study_id!==e),this.imported[1](n);let[i,o]=zn("","pgn.imported."+e);o(""),Object.entries(localStorage).map(a=>a[0]).filter(a=>a.includes(`.openings.id.${e}`)).map(a=>localStorage.removeItem(a))}save_import_pgn(e,n,i){this.delete_imported_study(e);let o="";o=ws(n,e,o,"white",i).name;let l=this.imported[0]();l.push({category:"openings",study_name:o,study_id:e,import_lichess_link:i,import_pgn:!i}),this.imported[1](l);let[f,p]=zn("","pgn.imported."+e);p(n)}all;openings;masters;tactics;endgames;recent;completed;imported;imported_by_id(e){return this.imported[0]().find(i=>i.study_id===e)}study_by_id(e){return this.all.find(i=>i.study_id===e)}}const Nr=ks.init();var he=(t=>(t[t.New=0]="New",t[t.Learning=1]="Learning",t[t.Review=2]="Review",t[t.Relearning=3]="Relearning",t))(he||{}),U=(t=>(t[t.Manual=0]="Manual",t[t.Again=1]="Again",t[t.Hard=2]="Hard",t[t.Good=3]="Good",t[t.Easy=4]="Easy",t))(U||{});class se{static card(e){return{...e,state:se.state(e.state),due:se.time(e.due),last_review:e.last_review?se.time(e.last_review):void 0}}static rating(e){if(typeof e=="string"){const n=e.charAt(0).toUpperCase(),i=e.slice(1).toLowerCase(),o=U[`${n}${i}`];if(o===void 0)throw new Error(`Invalid rating:[${e}]`);return o}else if(typeof e=="number")return e;throw new Error(`Invalid rating:[${e}]`)}static state(e){if(typeof e=="string"){const n=e.charAt(0).toUpperCase(),i=e.slice(1).toLowerCase(),o=he[`${n}${i}`];if(o===void 0)throw new Error(`Invalid state:[${e}]`);return o}else if(typeof e=="number")return e;throw new Error(`Invalid state:[${e}]`)}static time(e){if(typeof e=="object"&&e instanceof Date)return e;if(typeof e=="string"){const n=Date.parse(e);if(isNaN(n))throw new Error(`Invalid date:[${e}]`);return new Date(n)}else if(typeof e=="number")return new Date(e);throw new Error(`Invalid date:[${e}]`)}static review_log(e){return{...e,due:se.time(e.due),rating:se.rating(e.rating),state:se.state(e.state),review:se.time(e.review)}}}const Bl=.9,Ll=36500,$l=[.4072,1.1829,3.1262,15.4722,7.2102,.5316,1.0651,.0234,1.616,.1544,1.0824,1.9813,.0953,.2975,2.2042,.2407,2.9466,.5034,.6567],ql=!1,Fl=!0,To=t=>{let e=$l;return t?.w&&(t.w.length===19?e=t?.w:t.w.length===17&&(e=t?.w.concat([0,0]),e[4]=+(e[5]*2+e[4]).toFixed(8),e[5]=+(Math.log(e[5]*3+1)/3).toFixed(8),console.debug("[FSRS V5]auto fill w to 19 length"))),{request_retention:t?.request_retention||Bl,maximum_interval:t?.maximum_interval||Ll,w:e,enable_fuzz:t?.enable_fuzz??ql,enable_short_term:t?.enable_short_term??Fl}};function qr(t,e){const n={due:t?se.time(t):new Date,stability:0,difficulty:0,elapsed_days:0,scheduled_days:0,reps:0,lapses:0,state:he.New,last_review:void 0};return e&&typeof e=="function"?e(n):n}Date.prototype.scheduler=function(t,e){return Ul(this,t,e)},Date.prototype.diff=function(t,e){return zl(this,t,e)},Date.prototype.format=function(){return Vl(this)},Date.prototype.dueFormat=function(t,e,n){return Gl(this,t,e,n)};function Ul(t,e,n){return new Date(n?Ht(t).getTime()+e*24*60*60*1e3:Ht(t).getTime()+e*60*1e3)}function zl(t,e,n){if(!t||!e)throw new Error("Invalid date");const i=Ht(t).getTime()-Ht(e).getTime();let o=0;switch(n){case"days":o=Math.floor(i/(24*60*60*1e3));break;case"minutes":o=Math.floor(i/(60*1e3));break}return o}function Vl(t){const e=Ht(t),n=e.getFullYear(),i=e.getMonth()+1,o=e.getDate(),a=e.getHours(),l=e.getMinutes(),f=e.getSeconds();return`${n}-${Ln(i)}-${Ln(o)} ${Ln(a)}:${Ln(l)}:${Ln(f)}`}function Ln(t){return t<10?`0${t}`:`${t}`}const qi=[60,60,24,31,12],Fi=["second","min","hour","day","month","year"];function Gl(t,e,n,i=Fi){t=Ht(t),e=Ht(e),i.length!==Fi.length&&(i=Fi);let o=t.getTime()-e.getTime(),a;for(o/=1e3,a=0;a<qi.length&&!(o<qi[a]);a++)o/=qi[a];return`${Math.floor(o)}${n?i[a]:""}`}function Ht(t){return se.time(t)}const Hl=[U.Again,U.Hard,U.Good,U.Easy],Wl=[{start:2.5,end:7,factor:.15},{start:7,end:20,factor:.1},{start:20,end:1/0,factor:.05}];function Ql(t,e,n){let i=1;for(const l of Wl)i+=l.factor*Math.max(Math.min(t,l.end)-l.start,0);t=Math.min(t,n);let o=Math.max(2,Math.round(t-i));const a=Math.min(Math.round(t+i),n);return t>e&&(o=Math.max(o,e+1)),o=Math.min(o,a),{min_ivl:o,max_ivl:a}}function Ui(t,e,n){return Math.min(Math.max(t,e),n)}class Yl{c;s0;s1;s2;constructor(e){const n=Xl();this.c=1,this.s0=n(" "),this.s1=n(" "),this.s2=n(" "),e==null&&(e=+new Date),this.s0-=n(e),this.s0<0&&(this.s0+=1),this.s1-=n(e),this.s1<0&&(this.s1+=1),this.s2-=n(e),this.s2<0&&(this.s2+=1)}next(){const e=2091639*this.s0+this.c*23283064365386963e-26;return this.s0=this.s1,this.s1=this.s2,this.s2=e-(this.c=e|0),this.s2}set state(e){this.c=e.c,this.s0=e.s0,this.s1=e.s1,this.s2=e.s2}get state(){return{c:this.c,s0:this.s0,s1:this.s1,s2:this.s2}}}function Xl(){let t=4022871197;return function(e){e=String(e);for(let n=0;n<e.length;n++){t+=e.charCodeAt(n);let i=.02519603282416938*t;t=i>>>0,i-=t,i*=t,t=i>>>0,i-=t,t+=i*4294967296}return(t>>>0)*23283064365386963e-26}}function Jl(t){const e=new Yl(t),n=()=>e.next();return n.int32=()=>e.next()*4294967296|0,n.double=()=>n()+(n()*2097152|0)*11102230246251565e-32,n.state=()=>e.state,n.importState=i=>(e.state=i,n),n}const No=-.5,Mo=19/81;class Zl{param;intervalModifier;_seed;constructor(e){this.param=new Proxy(To(e),this.params_handler_proxy()),this.intervalModifier=this.calculate_interval_modifier(this.param.request_retention)}get interval_modifier(){return this.intervalModifier}set seed(e){this._seed=e}calculate_interval_modifier(e){if(e<=0||e>1)throw new Error("Requested retention rate should be in the range (0,1]");return+((Math.pow(e,1/No)-1)/Mo).toFixed(8)}get parameters(){return this.param}set parameters(e){this.update_parameters(e)}params_handler_proxy(){const e=this;return{set:function(n,i,o){return i==="request_retention"&&Number.isFinite(o)&&(e.intervalModifier=e.calculate_interval_modifier(Number(o))),Reflect.set(n,i,o),!0}}}update_parameters(e){const n=To(e);for(const i in n)if(i in this.param){const o=i;this.param[o]=n[o]}}init_stability(e){return Math.max(this.param.w[e-1],.1)}init_difficulty(e){return this.constrain_difficulty(this.param.w[4]-Math.exp((e-1)*this.param.w[5])+1)}apply_fuzz(e,n){if(!this.param.enable_fuzz||e<2.5)return Math.round(e);const i=Jl(this._seed)(),{min_ivl:o,max_ivl:a}=Ql(e,n,this.param.maximum_interval);return Math.floor(i*(a-o+1)+o)}next_interval(e,n){const i=Math.min(Math.max(1,Math.round(e*this.intervalModifier)),this.param.maximum_interval);return this.apply_fuzz(i,n)}next_difficulty(e,n){const i=e-this.param.w[6]*(n-3);return this.constrain_difficulty(this.mean_reversion(this.init_difficulty(U.Easy),i))}constrain_difficulty(e){return Math.min(Math.max(+e.toFixed(8),1),10)}mean_reversion(e,n){return+(this.param.w[7]*e+(1-this.param.w[7])*n).toFixed(8)}next_recall_stability(e,n,i,o){const a=U.Hard===o?this.param.w[15]:1,l=U.Easy===o?this.param.w[16]:1;return+Ui(n*(1+Math.exp(this.param.w[8])*(11-e)*Math.pow(n,-this.param.w[9])*(Math.exp((1-i)*this.param.w[10])-1)*a*l),.01,36500).toFixed(8)}next_forget_stability(e,n,i){return+Ui(this.param.w[11]*Math.pow(e,-this.param.w[12])*(Math.pow(n+1,this.param.w[13])-1)*Math.exp((1-i)*this.param.w[14]),.01,36500).toFixed(8)}next_short_term_stability(e,n){return+Ui(e*Math.exp(this.param.w[17]*(n-3+this.param.w[18])),.01,36500).toFixed(8)}forgetting_curve(e,n){return+Math.pow(1+Mo*e/n,No).toFixed(8)}}class ka{last;current;review_time;next=new Map;algorithm;constructor(e,n,i){this.algorithm=i,this.last=se.card(e),this.current=se.card(e),this.review_time=se.time(n),this.init()}init(){const{state:e,last_review:n}=this.current;let i=0;e!==he.New&&n&&(i=this.review_time.diff(n,"days")),this.current.last_review=this.review_time,this.current.elapsed_days=i,this.current.reps+=1,this.initSeed()}preview(){return{[U.Again]:this.review(U.Again),[U.Hard]:this.review(U.Hard),[U.Good]:this.review(U.Good),[U.Easy]:this.review(U.Easy),[Symbol.iterator]:this.previewIterator.bind(this)}}*previewIterator(){for(const e of Hl)yield this.review(e)}review(e){const{state:n}=this.last;let i;switch(n){case he.New:i=this.newState(e);break;case he.Learning:case he.Relearning:i=this.learningState(e);break;case he.Review:i=this.reviewState(e);break}if(i)return i;throw new Error("Invalid grade")}initSeed(){const e=this.review_time.getTime(),n=this.current.reps,i=this.current.difficulty*this.current.stability;this.algorithm.seed=`${e}_${n}_${i}`}buildLog(e){const{last_review:n,due:i,elapsed_days:o}=this.last;return{rating:e,state:this.current.state,due:n||i,stability:this.current.stability,difficulty:this.current.difficulty,elapsed_days:this.current.elapsed_days,last_elapsed_days:o,scheduled_days:this.current.scheduled_days,review:this.review_time}}}class Do extends ka{newState(e){const n=this.next.get(e);if(n)return n;const i=se.card(this.current);switch(i.difficulty=this.algorithm.init_difficulty(e),i.stability=this.algorithm.init_stability(e),e){case U.Again:i.scheduled_days=0,i.due=this.review_time.scheduler(1),i.state=he.Learning;break;case U.Hard:i.scheduled_days=0,i.due=this.review_time.scheduler(5),i.state=he.Learning;break;case U.Good:i.scheduled_days=0,i.due=this.review_time.scheduler(10),i.state=he.Learning;break;case U.Easy:{const a=this.algorithm.next_interval(i.stability,this.current.elapsed_days);i.scheduled_days=a,i.due=this.review_time.scheduler(a,!0),i.state=he.Review;break}default:throw new Error("Invalid grade")}const o={card:i,log:this.buildLog(e)};return this.next.set(e,o),o}learningState(e){const n=this.next.get(e);if(n)return n;const{state:i,difficulty:o,stability:a}=this.last,l=se.card(this.current),f=this.current.elapsed_days;switch(l.difficulty=this.algorithm.next_difficulty(o,e),l.stability=this.algorithm.next_short_term_stability(a,e),e){case U.Again:{l.scheduled_days=0,l.due=this.review_time.scheduler(5,!1),l.state=i;break}case U.Hard:{l.scheduled_days=0,l.due=this.review_time.scheduler(10),l.state=i;break}case U.Good:{const g=this.algorithm.next_interval(l.stability,f);l.scheduled_days=g,l.due=this.review_time.scheduler(g,!0),l.state=he.Review;break}case U.Easy:{const g=this.algorithm.next_short_term_stability(a,U.Good),w=this.algorithm.next_interval(g,f),S=Math.max(this.algorithm.next_interval(l.stability,f),w+1);l.scheduled_days=S,l.due=this.review_time.scheduler(S,!0),l.state=he.Review;break}default:throw new Error("Invalid grade")}const p={card:l,log:this.buildLog(e)};return this.next.set(e,p),p}reviewState(e){const n=this.next.get(e);if(n)return n;const i=this.current.elapsed_days,{difficulty:o,stability:a}=this.last,l=this.algorithm.forgetting_curve(i,a),f=se.card(this.current),p=se.card(this.current),g=se.card(this.current),w=se.card(this.current);this.next_ds(f,p,g,w,o,a,l),this.next_interval(f,p,g,w,i),this.next_state(f,p,g,w),f.lapses+=1;const S={card:f,log:this.buildLog(U.Again)},D={card:p,log:super.buildLog(U.Hard)},I={card:g,log:super.buildLog(U.Good)},V={card:w,log:super.buildLog(U.Easy)};return this.next.set(U.Again,S),this.next.set(U.Hard,D),this.next.set(U.Good,I),this.next.set(U.Easy,V),this.next.get(e)}next_ds(e,n,i,o,a,l,f){e.difficulty=this.algorithm.next_difficulty(a,U.Again),e.stability=this.algorithm.next_forget_stability(a,l,f),n.difficulty=this.algorithm.next_difficulty(a,U.Hard),n.stability=this.algorithm.next_recall_stability(a,l,f,U.Hard),i.difficulty=this.algorithm.next_difficulty(a,U.Good),i.stability=this.algorithm.next_recall_stability(a,l,f,U.Good),o.difficulty=this.algorithm.next_difficulty(a,U.Easy),o.stability=this.algorithm.next_recall_stability(a,l,f,U.Easy)}next_interval(e,n,i,o,a){let l,f;l=this.algorithm.next_interval(n.stability,a),f=this.algorithm.next_interval(i.stability,a),l=Math.min(l,f),f=Math.max(f,l+1);const p=Math.max(this.algorithm.next_interval(o.stability,a),f+1);e.scheduled_days=0,e.due=this.review_time.scheduler(5),n.scheduled_days=l,n.due=this.review_time.scheduler(l,!0),i.scheduled_days=f,i.due=this.review_time.scheduler(f,!0),o.scheduled_days=p,o.due=this.review_time.scheduler(p,!0)}next_state(e,n,i,o){e.state=he.Relearning,n.state=he.Review,i.state=he.Review,o.state=he.Review}}class Io extends ka{newState(e){const n=this.next.get(e);if(n)return n;this.current.scheduled_days=0,this.current.elapsed_days=0;const i=se.card(this.current),o=se.card(this.current),a=se.card(this.current),l=se.card(this.current);return this.init_ds(i,o,a,l),this.next_interval(i,o,a,l,0),this.next_state(i,o,a,l),this.update_next(i,o,a,l),this.next.get(e)}init_ds(e,n,i,o){e.difficulty=this.algorithm.init_difficulty(U.Again),e.stability=this.algorithm.init_stability(U.Again),n.difficulty=this.algorithm.init_difficulty(U.Hard),n.stability=this.algorithm.init_stability(U.Hard),i.difficulty=this.algorithm.init_difficulty(U.Good),i.stability=this.algorithm.init_stability(U.Good),o.difficulty=this.algorithm.init_difficulty(U.Easy),o.stability=this.algorithm.init_stability(U.Easy)}learningState(e){return this.reviewState(e)}reviewState(e){const n=this.next.get(e);if(n)return n;const i=this.current.elapsed_days,{difficulty:o,stability:a}=this.last,l=this.algorithm.forgetting_curve(i,a),f=se.card(this.current),p=se.card(this.current),g=se.card(this.current),w=se.card(this.current);return this.next_ds(f,p,g,w,o,a,l),this.next_interval(f,p,g,w,i),this.next_state(f,p,g,w),f.lapses+=1,this.update_next(f,p,g,w),this.next.get(e)}next_ds(e,n,i,o,a,l,f){e.difficulty=this.algorithm.next_difficulty(a,U.Again),e.stability=this.algorithm.next_forget_stability(a,l,f),n.difficulty=this.algorithm.next_difficulty(a,U.Hard),n.stability=this.algorithm.next_recall_stability(a,l,f,U.Hard),i.difficulty=this.algorithm.next_difficulty(a,U.Good),i.stability=this.algorithm.next_recall_stability(a,l,f,U.Good),o.difficulty=this.algorithm.next_difficulty(a,U.Easy),o.stability=this.algorithm.next_recall_stability(a,l,f,U.Easy)}next_interval(e,n,i,o,a){let l,f,p,g;l=this.algorithm.next_interval(e.stability,a),f=this.algorithm.next_interval(n.stability,a),p=this.algorithm.next_interval(i.stability,a),g=this.algorithm.next_interval(o.stability,a),l=Math.min(l,f),f=Math.max(f,l+1),p=Math.max(p,f+1),g=Math.max(g,p+1),e.scheduled_days=l,e.due=this.review_time.scheduler(l,!0),n.scheduled_days=f,n.due=this.review_time.scheduler(f,!0),i.scheduled_days=p,i.due=this.review_time.scheduler(p,!0),o.scheduled_days=g,o.due=this.review_time.scheduler(g,!0)}next_state(e,n,i,o){e.state=he.Review,n.state=he.Review,i.state=he.Review,o.state=he.Review}update_next(e,n,i,o){const a={card:e,log:this.buildLog(U.Again)},l={card:n,log:super.buildLog(U.Hard)},f={card:i,log:super.buildLog(U.Good)},p={card:o,log:super.buildLog(U.Easy)};this.next.set(U.Again,a),this.next.set(U.Hard,l),this.next.set(U.Good,f),this.next.set(U.Easy,p)}}class ef{fsrs;constructor(e){this.fsrs=e}replay(e,n,i){return this.fsrs.next(e,n,i)}handleManualRating(e,n,i,o,a,l,f){if(typeof n>"u")throw new Error("reschedule: state is required for manual rating");let p,g;if(n===he.New)p={rating:U.Manual,state:n,due:f??i,stability:e.stability,difficulty:e.difficulty,elapsed_days:o,last_elapsed_days:e.elapsed_days,scheduled_days:e.scheduled_days,review:i},g=qr(i),g.last_review=i;else{if(typeof f>"u")throw new Error("reschedule: due is required for manual rating");const w=f.diff(i,"days");p={rating:U.Manual,state:e.state,due:e.last_review||e.due,stability:e.stability,difficulty:e.difficulty,elapsed_days:o,last_elapsed_days:e.elapsed_days,scheduled_days:e.scheduled_days,review:i},g={...e,state:n,due:f,last_review:i,stability:a||e.stability,difficulty:l||e.difficulty,elapsed_days:o,scheduled_days:w,reps:e.reps+1}}return{card:g,log:p}}reschedule(e,n){const i=[];let o=qr(e.due);for(const a of n){let l;if(a.review=se.time(a.review),a.rating===U.Manual){let f=0;o.state!==he.New&&o.last_review&&(f=a.review.diff(o.last_review,"days")),l=this.handleManualRating(o,a.state,a.review,f,a.stability,a.difficulty,a.due?se.time(a.due):void 0)}else l=this.replay(o,a.review,a.rating);i.push(l),o=l.card}return i}calculateManualRecord(e,n,i,o){if(!i)return null;const{card:a,log:l}=i,f=se.card(e);return f.due.getTime()===a.due.getTime()?null:(f.scheduled_days=a.due.diff(f.due,"days"),this.handleManualRating(f,a.state,se.time(n),l.elapsed_days,o?a.stability:void 0,o?a.difficulty:void 0,a.due))}}class tf extends Zl{Scheduler;constructor(e){super(e);const{enable_short_term:n}=this.parameters;this.Scheduler=n?Do:Io}params_handler_proxy(){const e=this;return{set:function(n,i,o){return i==="request_retention"&&Number.isFinite(o)?e.intervalModifier=e.calculate_interval_modifier(Number(o)):i==="enable_short_term"&&(e.Scheduler=o===!0?Do:Io),Reflect.set(n,i,o),!0}}}repeat(e,n,i){const o=this.Scheduler,a=new o(e,n,this).preview();return i&&typeof i=="function"?i(a):a}next(e,n,i,o){const a=this.Scheduler,l=new a(e,n,this),f=se.rating(i);if(f===U.Manual)throw new Error("Cannot review a manual rating");const p=l.review(f);return o&&typeof o=="function"?o(p):p}get_retrievability(e,n,i=!0){const o=se.card(e);n=n?se.time(n):new Date;const a=o.state!==he.New?Math.max(n.diff(o.last_review,"days"),0):0,l=o.state!==he.New?this.forgetting_curve(a,+o.stability.toFixed(8)):0;return i?`${(l*100).toFixed(2)}%`:l}rollback(e,n,i){const o=se.card(e),a=se.review_log(n);if(a.rating===U.Manual)throw new Error("Cannot rollback a manual rating");let l,f,p;switch(a.state){case he.New:l=a.due,f=void 0,p=0;break;case he.Learning:case he.Relearning:case he.Review:l=a.review,f=a.due,p=o.lapses-(a.rating===U.Again&&a.state===he.Review?1:0);break}const g={...o,due:l,stability:a.stability,difficulty:a.difficulty,elapsed_days:a.last_elapsed_days,scheduled_days:a.scheduled_days,reps:Math.max(0,o.reps-1),lapses:Math.max(0,p),state:a.state,last_review:f};return i&&typeof i=="function"?i(g):g}forget(e,n,i=!1,o){const a=se.card(e);n=se.time(n);const l=a.state===he.New?0:n.diff(a.last_review,"days"),f={rating:U.Manual,state:a.state,due:a.due,stability:a.stability,difficulty:a.difficulty,elapsed_days:0,last_elapsed_days:a.elapsed_days,scheduled_days:l,review:n},p={card:{...a,due:n,stability:0,difficulty:0,elapsed_days:0,scheduled_days:0,reps:i?0:a.reps,lapses:i?0:a.lapses,state:he.New,last_review:a.last_review},log:f};return o&&typeof o=="function"?o(p):p}reschedule(e,n=[],i={}){const{recordLogHandler:o,reviewsOrderBy:a,skipManual:l=!0,now:f=new Date,update_memory_state:p=!1}=i;a&&typeof a=="function"&&n.sort(a),l&&(n=n.filter(V=>V.rating!==U.Manual));const g=new ef(this),w=g.reschedule(i.first_card||qr(),n),S=w.length,D=se.card(e),I=g.calculateManualRecord(D,f,S?w[S-1]:void 0,p);return o&&typeof o=="function"?{collections:w.map(o),reschedule_item:I?o(I):null}:{collections:w,reschedule_item:I}}}const nf=Xn();class rf extends Br{sections;repeats;moves;move_cards;remove_database(){this.delete()}constructor(){super("RepeatsDB"),this.version(1).stores({sections:"++id, study_id, section_name",repeats:"++id, name, sections*",moves:"++id, repeat_id",move_cards:"++id, move_id"}),this.sections.mapToClass(of),this.repeats.mapToClass(sf),this.moves.mapToClass(af),this.move_cards.mapToClass(uf)}async add_repeat(e){let n=await this.sections.bulkAdd(e.sections,{allKeys:!0}),i=await this.repeats.add({name:e.name,sections:n}),o={};await Promise.all(e.sections.map(async(l,f)=>{let p=n[f];(await Kl.read_section_study(l.study_id)).sections.find(S=>l.section_name===S.name).chapters.forEach(S=>S.pgn.tree.all_moves.forEach(D=>{let I=D.path,V=D.before_fen,L=D.uci;if(o[V])o[V].ucis.push({sections_id:p,uci:L,path:I});else{let H=[{uci:L,path:I,sections_id:p}];o[V]={repeat_id:i,fen:V,ucis:H}}}))}));let a=await this.moves.bulkAdd(Object.values(o),{allKeys:!0});await this.move_cards.bulkAdd(a.map(l=>({...qr(),move_id:l})))}async remove_repeat(e){let n=await this.repeats.where("name").equals(e).first();n&&await n.delete()}async repeat_by_id(e){let n=await this.repeats.where("id").equals(e).first();if(n)return await this.get_repeat_with_moves(n)}async get_repeats(){return await Promise.all((await this.repeats.toArray()).map(async e=>this.get_repeat_with_moves(e)))}async get_repeat_with_moves(e){return{id:e.id,name:e.name,sections:await e.get_sections(),moves:await this.get_moves_for_repeat(e.id)}}async get_moves_for_repeat(e){let n=await this.moves.where("repeat_id").equals(e).toArray(),i=n.map(a=>a.id),o=await this.move_cards.where("move_id").anyOf(i).toArray();return n.map(a=>({...a,card:o.find(l=>l.move_id===a.id)}))}async play_due_move(e,n,i){let a=(await this.moves.where("repeat_id").equals(e).toArray()).find(w=>w.fen===n);if(!a)return;let l=a.ucis.map(w=>w.uci).includes(i),f=await this.move_cards.where("move_id").equals(a.id).first();if(!f)return;let g=new tf({}).repeat(f.get_card(),new Date)[l?U.Good:U.Again].card;console.log(f,g),this.move_cards.update(f.id,g)}}class sf extends Gr{id;name;sections;async get_sections(){return(await Promise.all(this.sections.map(async n=>await this.db.sections.get(n)))).filter(Boolean)}async delete(){let e=(await this.db.sections.where("id").anyOf(this.sections).toArray()).map(o=>o.id);await this.db.sections.bulkDelete(e);let n=(await this.db.moves.where("repeat_id").equals(this.id).toArray()).map(o=>o.id);await this.db.moves.bulkDelete(n);let i=(await this.db.move_cards.where("move_id").anyOf(n).toArray()).map(o=>o.id);await this.db.move_cards.bulkDelete(i),await this.db.repeats.where("id").equals(this.id).delete()}}class of extends Gr{id;study_id;section_name}class af extends Gr{id;repeat_id;fen;ucis}class uf extends Gr{id;move_id;due;stability;difficulty;elapsed_days;scheduled_days;reps;lapses;state;last_review;get_card(){let{due:e,stability:n,difficulty:i,elapsed_days:o,scheduled_days:a,reps:l,lapses:f,state:p,last_review:g}=this;return{due:e,stability:n,difficulty:i,elapsed_days:o,scheduled_days:a,reps:l,lapses:f,state:p,last_review:g}}}const cf=t=>J(nf.Provider,{value:new rf,get children(){return t.children}});var lf=hs('<header id=top><div class=site-title-nav><input type=checkbox id=tn-tg class="topnav-toggle fullscreen-toggle"><label for=tn-tg class=fullscreen-mask></label><label for=tn-tg class=hbg><span class=hbg__in></span></label><h1 class=site-title> <small></small> </h1><nav id=topnav><section></section><section></section><section></section><section></section><section></section><section></section></nav></div><div class=site-buttons><div class=dasher>'),ff=hs("<div><div class=main>");const hf=ze(()=>Ve(()=>import("./Home-cu90zK64.js"),__vite__mapDeps([0,1]),import.meta.url)),df=ze(()=>Ve(()=>import("./Repertoires-Df534WIS.js"),__vite__mapDeps([2,3]),import.meta.url)),un=ze(()=>Ve(()=>import("./Contact-JLyDr-a8.js"),__vite__mapDeps([4,5]),import.meta.url)),pf=ze(()=>Ve(()=>import("./Repertoire-BgySM0k5.js"),__vite__mapDeps([6,7,8,9,10,11,12,13,14,15]),import.meta.url)),mf=ze(()=>Ve(()=>import("./Masters-BPjtha3X.js"),__vite__mapDeps([16,17]),import.meta.url)),yf=ze(()=>Ve(()=>import("./Tactics-Sue91Onm.js"),__vite__mapDeps([18,7,8,9,10,15]),import.meta.url)),gf=ze(()=>Ve(()=>import("./Endgames-CFTGTknd.js"),__vite__mapDeps([19,17]),import.meta.url)),vf=ze(()=>Ve(()=>import("./Dashboard-o35f0tNZ.js"),__vite__mapDeps([20,11,21]),import.meta.url)),bf=ze(()=>Ve(()=>import("./Explorer-oKncb6Bc.js"),__vite__mapDeps([22,7,8,9,10,12,23]),import.meta.url)),wf=ze(()=>Ve(()=>import("./Challenges-DTa4Prfo.js"),__vite__mapDeps([24,25]),import.meta.url)),_f=ze(()=>Ve(()=>import("./Widen-BwXa_oxk.js"),__vite__mapDeps([26,7,8,27]),import.meta.url)),kf=ze(()=>Ve(()=>import("./SixthDraw-CvsitdiI.js"),__vite__mapDeps([28,7,8,9,10,29]),import.meta.url)),xa=ze(()=>Ve(()=>import("./Beta-CfUl9bID.js"),__vite__mapDeps([30,31]),import.meta.url)),xf=ze(()=>Ve(()=>import("./Show-Co6K_oNu.js"),__vite__mapDeps([32,33,34]),import.meta.url)),Ef=ze(()=>Ve(()=>import("./Dues-m7rhSnPJ.js"),__vite__mapDeps([35,33,7,8,13,36]),import.meta.url)),Af=()=>J(Tc,{get children(){return J(cf,{get children(){return J(Fc,{get children(){return J(_c,{root:Pf,get children(){return[J(Ce,{path:"/",component:hf}),J(Ce,{path:"/sixth",component:kf}),J(Ce,{path:"/repeat",component:xf}),J(Ce,{path:"/repeat/:id",component:Ef}),J(Ce,{path:"/widen",component:_f}),J(Ce,{path:"/beta",component:xa}),J(Ce,{path:"/explorer",component:bf}),J(Ce,{path:"/challenges",component:wf}),J(Ce,{path:"/repertoires",component:df}),J(Ce,{path:"/openings/:id",component:pf}),J(Ce,{path:"/masters/:id",component:mf}),J(Ce,{path:"/tactics/:id",component:yf}),J(Ce,{path:"/endgames/:id",component:gf}),J(Ce,{path:"/contact",component:un}),J(Ce,{path:"/terms",component:un}),J(Ce,{path:"/privacy",component:un}),J(Ce,{path:"/about",component:un}),J(Ce,{path:"/donate",component:un}),J(Ce,{path:"/thanks",component:un}),J(Ce,{path:"/dashboard",component:vf})]}})}})}})}}),Pf=t=>{let e=Vr(),n=ge(()=>e.pathname.split("/")[1]);const i=()=>{let l=n();return`on-${l===""?"home":l}`},[o,a]=Ke(!1,{equals:!1});return rc(()=>{a(!1)}),[(()=>{var l=lf(),f=l.firstChild,p=f.firstChild,g=p.nextSibling,w=g.nextSibling,S=w.nextSibling,D=S.firstChild,I=D.nextSibling,V=S.nextSibling,L=V.firstChild,H=L.nextSibling,Y=H.nextSibling,W=Y.nextSibling,fe=W.nextSibling,oe=fe.nextSibling,pe=f.nextSibling,_e=pe.firstChild;return et(S,J(pt,{href:"/",children:"aidchess.com"}),D),et(I,J(pt,{class:"beta",href:"/beta",children:"beta"})),et(L,J(pt,{class:"home",href:"/",children:"aidchess.com"})),et(H,J(pt,{href:"/challenges",children:"Challenges"})),et(Y,J(pt,{href:"/widen",children:"Widen"})),et(W,J(pt,{href:"/repertoires",children:"Repertoires"})),et(fe,J(pt,{href:"/repeat",children:"Repeat"})),et(oe,J(pt,{class:"site-title-nav__donate",href:"/donate",children:"Donate"})),et(_e,J(pt,{href:"/dashboard",children:"Dashboard"})),ut(()=>p.checked=o()),l})(),(()=>{var l=ff(),f=l.firstChild;return et(f,J(_u,{fallback:p=>xa(),get children(){return t.children}})),ut(()=>Qo(l,"main-wrap "+i())),l})()]},Of=document.getElementById("root");Tu(()=>J(Af,{}),Of);export{Cf as $,pt as A,zn as B,mu as C,Rl as D,Wf as E,Rf as F,Qf as G,hn as H,ya as I,Qi as J,Ur as K,nf as L,Nf as M,zr as N,Du as O,Df as P,ms as Q,Nr as R,Ho as S,Gt as T,Et as U,tr as V,xn as W,ol as X,va as Y,mn as Z,ba as _,Ke as a,jf as a0,If as a1,Oc as a2,na as b,J as c,Wo as d,Vr as e,ge as f,Tf as g,ut as h,et as i,Qo as j,Mf as k,ou as l,Kl as m,iu as n,Kf as o,Pe as p,fs as q,Sf as r,Yi as s,hs as t,ju as u,zt as v,Ku as w,Lo as x,ls as y,Lc as z};
