import{c as a,g as X,au as Y,h as ue,b as c,j as E,u as oe,k as Z,t as d,i as r,e as M,A as pe,F as H,l as fe,m as g,aa as ee,d as ge}from"./index-sRNI4wmP.js";var he=d("<div class=header><h4>Selected <span class=number></span> sections</h4><h4>Total <span class=number></span> chapters "),I=d("<h4> Memorize due moves through Spaced Repetition "),ve=d("<p> Select a due move category below to start playing. "),$e=d("<div class=filler>"),me=d("<div class=dues><button><span>First 10 moves</span><span class=due>Due: </span></button><button><span>10-20 moves</span><span class=due> Due: </span></button><button><span>20+ moves</span><span class=due> Due: </span></button><button><span>White moves</span><span class=due> Due: </span></button><button><span>Black moves</span><span class=due> Due: "),be=d("<div class=content>"),Se=d("<main class=repetition><div class=studies-list><div class=header><h3>Select an Opening</h3></div><div class=filter><label for=filter>Filter: </label><select id=filter><option value=mine id=mine>My Openings</option><option value=featured id=featured>Featured Openings</option></select></div><div class=list></div></div><div class=sections-list-multiple><div class=header><h3>Select multiple Sections</h3></div><div class=list></div></div><div class=repeat-info>"),ye=d("<div class=no-study>No openings here. "),ke=d("<div class=study>"),Ce=d("<div class=no-section>No sections to show. Select some openings first."),we=d("<div class=section>"),xe=d("<div class=loading>Loading..."),De=d("<div class=no-selected-sections>Please select some sections.");const Ee=()=>a(Oe,{});function Le(s){return s.card.due.getTime()<new Date().getTime()}function J(s){return s.ply<=20}function K(s){return s.ply>20&&s.ply<=40}function Q(s){return s.ply>40}function U(s){return ee(s.before_fen)==="white"}function V(s){return ee(s.before_fen)==="black"}function Fe(){let[s]=X(),[_]=Y();const w=c(()=>Object.values(s.studies)),b=c(()=>{if(!_.repeat_selected_study_id)return;let e=s.studies[_.repeat_selected_study_id];if(e)return e.section_ids.map(D=>e.sections.find(f=>f.id===D))}),S=c(()=>_.repeat_selected_study_id),l=Z(()=>_.repeat_selected_study_id),h=e=>_.selected_section_ids[_.repeat_selected_study_id]?.includes(e),v=c(()=>b()?.filter(e=>h(e.id))??[]),y=c(()=>v().map(e=>e.id)),x=c(()=>{let e=S();if(e)return s.studies[e]}),k=c(()=>s.chapters.list.filter(e=>y().includes(e.section_id))),o=c(()=>s.due_moves.list),p=c(()=>s.due_moves.list.filter(e=>!e.attempts[0]||Le(e.attempts[0])));return{isSelectedStudy:l,isSelectedSection:h,get selected_study_id(){return S()},get study(){return x()},get studies(){return w()},get sections(){return b()},get selected_sections(){return v()},get selected_section_ids(){return y()},get all_chapters_selected(){return k()},get due_first_ten(){return p().filter(e=>J(e.tree_step_node.step))},get due_ten_twenty(){return p().filter(e=>K(e.tree_step_node.step))},get due_twenty_plus(){return p().filter(e=>Q(e.tree_step_node.step))},get due_white(){return p().filter(e=>U(e.tree_step_node.step))},get due_black(){return p().filter(e=>V(e.tree_step_node.step))},get all_first_ten(){return o().filter(e=>J(e.tree_step_node.step))},get all_ten_twenty(){return o().filter(e=>K(e.tree_step_node.step))},get all_twenty_plus(){return o().filter(e=>Q(e.tree_step_node.step))},get all_white(){return o().filter(e=>U(e.tree_step_node.step))},get all_black(){return o().filter(e=>V(e.tree_step_node.step))}}}function Oe(){let[,{load_studies:s,load_chapters_for_sections:_,load_due_moves:w}]=X(),[,{set_repeat_selected_study:b,toggle_repeat_study_section:S}]=Y(),l=Fe();const h=()=>{_(l.selected_section_ids)},v=()=>{let i=l.selected_study_id,$=l.selected_section_ids;i&&$.length>0&&w(i,$)};let[y,x]=ue();const k=c(()=>y.filter??"mine"),o=i=>{x({filter:i})},p=c(()=>{let i=k();return i==="mine"||i==="featured"||i==="auto"?i:"mine"});E(()=>s(p())),E(h),E(v);const e=i=>{S(i),h(),v()};let D=oe();const f=i=>{D("/repetition/"+l.selected_study_id+"?filter="+i)},N=Z(k);return(()=>{var i=Se(),$=i.firstChild,te=$.firstChild,R=te.nextSibling,se=R.firstChild,T=se.nextSibling,j=T.firstChild,le=j.nextSibling,ie=R.nextSibling,A=$.nextSibling,ne=A.firstChild,re=ne.nextSibling,de=A.nextSibling;return T.addEventListener("change",t=>o(t.target.value)),r(ie,a(H,{get each(){return l.studies},get fallback(){return(()=>{var t=ye();return t.firstChild,r(t,a(pe,{href:"/openings",children:"Build some openings first."}),null),t})()},children:t=>(()=>{var n=ke();return n.$$click=()=>b(l.isSelectedStudy(t.id)?void 0:t.id),r(n,()=>t.name),M(()=>n.classList.toggle("active",!!l.isSelectedStudy(t.id))),n})()})),r(re,a(H,{get each(){return l.sections},get fallback(){return Ce()},children:t=>(()=>{var n=we();return n.$$click=()=>e(t.id),r(n,()=>t.name),M(()=>n.classList.toggle("selected",!!l.isSelectedSection(t.id))),n})()})),r(de,a(g,{get fallback(){return xe()},get children(){return[(()=>{var t=he(),n=t.firstChild,u=n.firstChild,L=u.nextSibling,C=n.nextSibling,m=C.firstChild,F=m.nextSibling;return r(L,()=>l.selected_sections.length),r(F,()=>l.all_chapters_selected.length),t})(),(()=>{var t=be();return r(t,a(fe,{get when(){return l.selected_sections.length>0},get fallback(){return[I(),De()]},get children(){return[I(),ve(),$e(),(()=>{var n=me(),u=n.firstChild,L=u.firstChild,C=L.nextSibling;C.firstChild;var m=u.nextSibling,F=m.firstChild,B=F.nextSibling;B.firstChild;var O=m.nextSibling,ae=O.firstChild,z=ae.nextSibling;z.firstChild;var P=O.nextSibling,ce=P.firstChild,W=ce.nextSibling;W.firstChild;var q=P.nextSibling,_e=q.firstChild,G=_e.nextSibling;return G.firstChild,u.$$click=()=>f("first-ten"),r(C,a(g,{fallback:"..",get children(){return l.due_first_ten?.length??".."}}),null),m.$$click=()=>f("ten-twenty"),r(B,a(g,{fallback:"..",get children(){return l.due_ten_twenty?.length??".."}}),null),O.$$click=()=>f("twenty-plus"),r(z,a(g,{fallback:"..",get children(){return l.due_twenty_plus?.length??".."}}),null),P.$$click=()=>f("white"),r(W,a(g,{fallback:"..",get children(){return l.due_white?.length??".."}}),null),q.$$click=()=>f("black"),r(G,a(g,{fallback:"..",get children(){return l.due_black?.length??".."}}),null),n})()]}})),t})()]}})),M(t=>{var n=N("mine"),u=N("featured");return n!==t.e&&(j.selected=t.e=n),u!==t.t&&(le.selected=t.t=u),t},{e:void 0,t:void 0}),i})()}ge(["click"]);export{Fe as createRepeatProps,Ee as default};
