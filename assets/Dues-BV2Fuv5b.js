import{k as y,K as C,c,S as N,f as o,a as T,D as F,I as R,n as h,i as v,t as S,L as D,q as b,x as k}from"./index-Dw2aBFZW.js";import{a as A}from"./solid-dexie-j8f_eXXV.js";import{S as E,C as L}from"./Chessboard-IFjzVceM.js";import{a as P}from"./annotationShapes-BNkomk1i.js";var q=S("<div class=repeat-dues><div class=board-wrap></div><div class=info><h3> Due Moves"),K=S("<span>Repeat Not Found");function Q(r){return r[Math.floor(Math.random()*r.length)]}const O=()=>{let r=y();const d=parseInt(r.id),i=C(D),u=A(()=>i.repeat_by_id(d));return c(N,{get when(){return u()},get fallback(){return c(z,{})},children:n=>c(j,{get repeats(){return n()}})})},j=r=>{const d=C(D),i=o(()=>r.repeats),u=o(()=>i().moves.filter(e=>e.due.getTime()<=new Date().getTime())),n=o(()=>Q(u())),[f,m]=T(void 0),t=new E,$=o(()=>F(n()?.fen??R)),x=o(()=>f()===void 0);return h(b(n,e=>{e&&t.on_set_fen_uci(e.fen)})),h(b(()=>t.add_uci,e=>{if(!e)return;const s=n();if(!s)return;let[a,l]=e;const _=i().id,w=s.fen,I=s.ucis;let g="✓",M="✗",p=g;I.includes(a)?p=g:p=M,m(P(a,l,p)),setTimeout(()=>{k(()=>{m(void 0),d.play_due_move(_,w,a)})},600)})),(()=>{var e=q(),s=e.firstChild,a=s.nextSibling,l=a.firstChild,_=l.firstChild;return v(s,c(L,{get shapes(){return f()},get orientation(){return $()},get movable(){return x()},get doPromotion(){return t.promotion},get onMoveAfter(){return t.on_move_after},get fen_uci(){return t.fen_uci},get color(){return t.turnColor},get dests(){return t.dests}})),v(l,()=>u().length,_),e})()},z=()=>K();export{O as default};
