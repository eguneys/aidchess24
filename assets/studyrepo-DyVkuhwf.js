var k=Object.defineProperty;var P=(s,t,e)=>t in s?k(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var a=(s,t,e)=>(P(s,typeof t!="symbol"?t+"":t,e),e);import{P as g}from"./chess_pgn_logic-BZsrL4fn.js";import{y as m}from"./index-DqX9ZEU6.js";const D=(s,t,e,n)=>{let i=g.make_many(s).map(r=>{var c;let l=(c=r.site)!=null&&c.includes("http")?r.site:`https://lichess.org/study/${t}`,o=r.event,d;if(o!=null&&o.includes(": "))[e,d]=o.split(": ");else if(r.white!=="?"){let h=r.white,b=r.black;d=`${h} vs ${b} at ${o}`}else d=o;return{name:d,site:l,pgn:r}});return{id:t,name:e,orientation:n,chapters:i}},w=(s,t,e,n,i)=>{let r=[];return g.make_many(s).map(l=>{let o=l.section,d=l.chapter??l.event,c=r.find(h=>h.name===o);c||r.push(c={name:o,chapters:[]}),c==null||c.chapters.push({name:d,pgn:l})}),{id:t,name:e,orientation:n,imported:i,sections:r}},S=(s,t,e)=>fetch(`pgns/${s}.pgn`).then(n=>n.text()).then(n=>D(n,s,t,e)),$=(s,t,e)=>fetch(`pgns/${s}.section.pgn`).then(n=>n.text()).then(n=>w(n,s,t,e)),z=(s,t)=>{let[e]=m("","pgn.imported."+s);return w(e(),s,t,"white",!0)},p=class p{read_section_study(t){let{study_name:e,orientation:n,imported:i}=_.study_by_id(t)||_.imported_by_id(t);return i?z(t,e):$(t,e,n)}read_study(t){let{study_name:e,orientation:n}=_.study_by_id(t);return S(t,e,n)}};a(p,"init",()=>new p);let f=p;const E=f.init(),v={Openings:[["Berlin Defence","berlin","white"],["Slav Defense","slav","black"],["London System","london-system","black"],["Caro-Kann Defense","caro-kann","white"],["Petroff Defense","petroff","white"],["Philidor Defence","philidor","white"],["Accelerated Dragon","accelerated-dragon","white"],["Caro Kann","","white"],["Four-Knights","","white"],["Sicilian Defense","","white"],["French Defense","","black"]],Masters:[["Bobby Fischer 60 Memorable Games","",60],["Magnus Carlsen 2023",""],["Tata Steel 2023",""]],Tactics:[["50 Puzzles 1600","",50],["50 Puzzles 2000","",50],["50 Puzzles 2200","",50]],Endgames:[["100 Endgames You Must Know",""],["King and Pawn Endgames",""]]},u=class u{constructor(){a(this,"all");a(this,"openings");a(this,"masters");a(this,"tactics");a(this,"endgames");a(this,"recent");a(this,"completed");a(this,"imported")}delete_imported_study(t){let e=this.imported[0]();e=e.filter(r=>r.study_link!==t),this.imported[1](e);let[n,i]=m("","pgn.imported."+t);i("")}save_import_pgn(t,e,n){let i=this.imported[0]();i.push({category:"openings",study_name:t,study_link:e,imported:!0}),this.imported[1](i);let[r,l]=m("","pgn.imported."+e);l(n)}imported_by_id(t){return this.imported[0]().find(n=>n.study_link===t)}study_by_id(t){return this.all.find(n=>n.study_link===t)}};a(u,"init",()=>{function t(n){return v[n].map(i=>({category:n,study_name:i[0],study_link:i[1],orientation:i[3]}))}let e=new u;return e.openings=t("Openings"),e.masters=t("Masters"),e.tactics=t("Tactics"),e.endgames=t("Endgames"),e.all=[...e.openings,...e.masters,...e.tactics,...e.endgames],e.recent=[],e.completed=[],e.imported=m([],"fixture.imported"),e});let y=u;const _=y.init();export{_ as R,E as S};
