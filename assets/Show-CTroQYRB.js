import{c as d,a as W,H as U,f as a,i as t,S as K,R as ne,l as le,u as ie,F as j,A as ae,h as T,j as V,s as O,K as ce,L as Q,b as re,d as de,t as $,J as X,m as oe}from"./index-DjH-B4QQ.js";import{c as _e,D as ue}from"./types-lsVOugvr.js";var he=$("<div class=repeat-show>"),$e=$("<div class=show>"),ve=$('<div class=new-repeat><h3>Create a New Repeat</h3><input type=text placeholder="Repeat Name"value="My Repeat"><div class=study-list><h3>Studies</h3><div class=list></div></div><div class=section-list><h3>Sections</h3><div class=controls><button>Select All</button></div><div class=list></div></div><button class=save> Save '),pe=$("<div class=none>"),Y=$("<div>"),be=$("<p>Select a Study"),ge=$("<div class=section><input type=checkbox><label>"),me=$("<div class=dialog><div class=overlay></div><div class=content>"),fe=$("<div class=list-wrap><h3>Repeats</h3><div class=list></div><button>Create a New Repeat"),Se=$("<div class=show><h2></h2><div class=content><div class=sections-wrap><h3>Sections</h3><div class=sections></div></div><div class=info><small>Total Positions: </small><p>Total Due: </p><div class=buttons><button>Play Due White <span></span></button><button>Play Due Black <span></span></button><button>Play Due First 10 moves<span></span></button><button>Play Due 10-20 moves <span></span></button><button>Play Due 20+ moves <span></span></button><button>Play All Due <span></span></button></div></div></div><a class=delete>Delete Repeat"),xe=$("<div class=section>");const Ae=()=>d(ye,{}),ye=()=>{const[i,s]=W(!1),e=()=>{s(!0)},n=U(X),c=_e(()=>n.get_repeats()),[_,g]=W(0),r=a(()=>c[_()]),v=()=>{const o=r();o&&n.remove_repeat(o.name)};return(()=>{var o=he();return t(o,d(Re,{repeats:c,set_i_selected_repeat:g,get i_selected_repeat(){return _()},on_open_create_repeat:e}),null),t(o,d(K,{get when(){return r()},get fallback(){return $e()},children:R=>d(De,{on_delete:v,get repeat(){return R()},on_open_create_repeat:e})}),null),t(o,d(K,{get when(){return i()},get children(){return d(ke,{onClose:()=>{s(!1)}})}}),null),o})()};class Ce{sections=[];add_section(s,e){this.sections=this.sections.filter(n=>!(n.study_id===s&&n.section_name===e)),this.sections.push({study_id:s,section_name:e})}remove_section(s,e){this.sections=this.sections.filter(n=>!(n.study_id===s&&n.section_name===e))}has(s,e){return!!this.sections.find(n=>n.study_id===s&&n.section_name===e)}}const ke=i=>{const s=a(ne.imported[0]),[e,n]=W(0),c=a(()=>s()[e()]),_=a(()=>c()?.study_id),[g]=le(()=>c()?.study_id,l=>oe.read_section_study(l)),r=new Ce,v=(l,S)=>{S?r.add_section(_(),l):r.remove_section(_(),l)};let o;const R=()=>o.value,[m,f]=W(void 0,{equals:!1}),x=()=>{g()?.sections.map(l=>l.name).forEach(l=>r.add_section(_(),l)),f()},N=l=>(m(),r.has(_(),l)),A=U(X),q=()=>{let l=R();if(!l||l.length<3)return;let S={id:-1,name:l,sections:r.sections};A.add_repeat(S),i.onClose()};return d(we,{get onClose(){return i.onClose},get children(){var l=ve(),S=l.firstChild,y=S.nextSibling,C=y.nextSibling,B=C.firstChild,D=B.nextSibling,E=C.nextSibling,H=E.firstChild,k=H.nextSibling,I=k.firstChild,J=k.nextSibling,P=E.nextSibling;return ie(p=>o=p,y),t(D,d(j,{get each(){return s()},get fallback(){return(()=>{var p=pe();return t(p,d(ae,{href:"/repertoires",children:"Import some studies first"})),p})()},children:(p,b)=>(()=>{var u=Y();return u.$$click=()=>n(b()),t(u,()=>p.study_name),T(()=>V(u,e()===b()?"study active":"study")),u})()})),I.$$click=()=>x(),t(J,d(K,{get when(){return g()},children:p=>d(j,{get each(){return p().sections},get fallback(){return be()},children:b=>(()=>{var u=ge(),w=u.firstChild,F=w.nextSibling;return w.addEventListener("change",h=>v(b.name,h.target.checked)),t(F,()=>b.name),T(h=>{var L=b.name,M=b.name;return L!==h.e&&O(w,"id",h.e=L),M!==h.t&&O(F,"for",h.t=M),h},{e:void 0,t:void 0}),T(()=>w.checked=N(b.name)),u})()})})),P.$$click=q,l}})},we=i=>{const s=ce(()=>i.children);return(()=>{var e=me(),n=e.firstChild,c=n.nextSibling;return Q(n,"click",i.onClose,!0),t(c,s),e})()},Re=i=>{const s=a(()=>i.repeats);return(()=>{var e=fe(),n=e.firstChild,c=n.nextSibling,_=c.nextSibling;return t(c,d(j,{get each(){return s()},children:(g,r)=>(()=>{var v=Y();return v.$$click=()=>i.set_i_selected_repeat(r()),t(v,()=>g.name),T(()=>V(v,"repeat"+(r()===i.i_selected_repeat?" active":""))),v})()})),Q(_,"click",i.on_open_create_repeat,!0),e})()},De=i=>{const s=a(()=>i.repeat),e=a(()=>new ue(s())),n=a(()=>e().total.length),c=a(()=>e().due.length),_=a(()=>e().due_white.length),g=a(()=>e().due_black.length),r=a(()=>e().due_10.length),v=a(()=>e().due_10_20.length),o=a(()=>e().due_20plus.length),R=re(),m=f=>{let x=s().id;R("/repeat/"+x+(f?`?filter=${f}`:""))};return(()=>{var f=Se(),x=f.firstChild,N=x.nextSibling,A=N.firstChild,q=A.firstChild,l=q.nextSibling,S=A.nextSibling,y=S.firstChild;y.firstChild;var C=y.nextSibling;C.firstChild;var B=C.nextSibling,D=B.firstChild,E=D.firstChild,H=E.nextSibling,k=D.nextSibling,I=k.firstChild,J=I.nextSibling,P=k.nextSibling,p=P.firstChild,b=p.nextSibling,u=P.nextSibling,w=u.firstChild,F=w.nextSibling,h=u.nextSibling,L=h.firstChild,M=L.nextSibling,z=h.nextSibling,Z=z.firstChild,ee=Z.nextSibling,te=N.nextSibling;return t(x,()=>s().name),t(l,d(j,{get each(){return s().sections},children:se=>(()=>{var G=xe();return t(G,()=>se.section_name),G})()})),t(y,n,null),t(C,c,null),D.$$click=()=>m("white"),t(H,_),k.$$click=()=>m("black"),t(J,g),P.$$click=()=>m("first-ten"),t(b,r),u.$$click=()=>m("ten-twenty"),t(F,v),h.$$click=()=>m("twenty-plus"),t(M,o),z.$$click=()=>m(),t(ee,c),Q(te,"click",i.on_delete,!0),f})()};de(["click"]);export{Ae as default};
