import{k as T,K as k,c as _,S as L,P as q,f as i,a as $,D as K,I as Q,n as C,i as y,d as j,t as I,L as M,q as D,x}from"./index-BPo209fg.js";import{a as z,D as B}from"./types-DqmV88Zc.js";import{S as G,C as H}from"./Chessboard-BALN8MJ7.js";import{a as J}from"./annotationShapes-BBmIaIoK.js";var O=I("<div class=repeat-dues><div class=board-wrap></div><div class=info><h3> Due Moves</h3><button>Show Answer"),U=I("<span>Repeat Not Found");function V(o){return o[Math.floor(Math.random()*o.length)]}const re=()=>{let o=T();const p=parseInt(o.id),l=k(M),u=z(()=>l.repeat_by_id(p));return _(L,{get when(){return u()},get fallback(){return _(X,{})},children:r=>_(W,{get repeats(){return r()}})})},W=o=>{const[p]=q(),l=k(M),u=i(()=>o.repeats),r=i(()=>new B(u())),g=i(()=>{switch(p.filter){case"white":return r().due_white;case"black":return r().due_black;case"first-ten":return r().due_10;case"ten-twenty":return r().due_10_20;case"twenty-plus":return r().due_20plus;default:return r().due}}),c=i(()=>V(g())),[b,f]=$(void 0),n=new G;let[w,d]=$(void 0);const F=i(()=>K(c()?.fen??Q)),N=i(()=>{let e=w(),t=b();return e===void 0&&t===void 0});C(D(c,e=>{e&&n.on_set_fen_uci(e.fen)})),C(D(()=>n.add_uci,e=>{if(!e)return;const t=c();if(!t)return;let[s,a]=e;const m=u().id,h=t.fen,A=t.ucis.map(R=>R.uci);let S="✓",E="✗",v=S;A.includes(s)?v=S:v=E,f(J(s,a,v)),d(setTimeout(()=>{x(()=>{f(void 0),l.play_due_move(m,h,s),d(void 0)})},600))}));const P=()=>{if(w()!==void 0)return;let e=c();if(!e)return;let t=u().id,s=e.fen,a=e.ucis[e.ucis.length-1].uci;n.on_play_uci(a),d(setTimeout(()=>{x(()=>{f(void 0),l.play_due_move(t,s,""),d(void 0)})},600))};return(()=>{var e=O(),t=e.firstChild,s=t.nextSibling,a=s.firstChild,m=a.firstChild,h=a.nextSibling;return y(t,_(H,{get shapes(){return b()},get orientation(){return F()},get movable(){return N()},get doPromotion(){return n.promotion},get onMoveAfter(){return n.on_move_after},get fen_uci(){return n.fen_uci},get color(){return n.turnColor},get dests(){return n.dests}})),y(a,()=>g().length,m),h.$$click=P,e})()},X=()=>U();j(["click"]);export{re as default};
