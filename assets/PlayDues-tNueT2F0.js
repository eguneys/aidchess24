import{l as X,u as q,c as s,S as m,g as t,a6 as Z,q as T,i as d,m as ee,a as g,D as te,I as ne,n as F,r as re,b as se,d as ae,t as i,R as L,x as R}from"./index-CpFAxWkl.js";import{S as oe,C as ue}from"./Chessboard-DgUeALmb.js";import{C as ie,a as le}from"./ChessTreeWithTools-gzZClc0H.js";import{c as de,P as ce,D as _e}from"./Show2-Dq0OfrVL.js";import"./chessground-lU4YbH_i.js";import"./Chesstree2-CdVLz99v.js";import"./random-BMCilaBQ.js";var he=i("<div class=repeat-dues>"),fe=i("<p>Completed All Due Moves."),me=i("<div class=header><h3></h3><p></p><p> Due Moves"),ge=i("<div class=board-wrap>"),pe=i("<div class=info>"),ve=i("<div class=replay-wrap><div class=replay-header><div class=title><h3></h3><h4>"),we=i("<button>Hint: Show Previous Moves"),be=i("<button>Show Answer"),$e=i("<button>Next Due"),ye=i("<p> Study Not Found ");function Ce(r){return r[Math.floor(Math.random()*r.length)]}const Fe=()=>{let r=X();const c=parseInt(r.id),l=q(L),n=de(()=>l.get_study_by_id(c));return s(m,{get when(){return n()},get fallback(){return s(W,{})},children:_=>s(Se,{get study(){return _()}})})},Se=r=>{const c=t(()=>r.study),[l]=Z(),n=t(()=>ce(r.study.id)),_=t(()=>n()[0]());let h=t(T(_,a=>_e(a)));const p=t(()=>{switch(l.filter){case"white":return h().due_white;case"black":return h().due_black;case"first-ten":return h().due_10;case"ten-twenty":return h().due_10_20;case"twenty-plus":return h().due_20plus;default:return h().due}}),P=t(()=>{switch(l.filter){case"white":return"White Only";case"black":return"Black Only";case"first-ten":return"First 10 moves";case"ten-twenty":return"10-20 moves";case"twenty-plus":return"20+ moves";default:return"All moves"}}),C=t(()=>Ce(p()));return(()=>{var a=he();return d(a,s(m,{get when(){return C()},get fallback(){return fe()},children:S=>[(()=>{var v=me(),k=v.firstChild,x=k.nextSibling,w=x.nextSibling,A=w.firstChild;return d(k,()=>c().name),d(x,P),d(w,()=>p().length,A),v})(),s(ke,{get study(){return c()},get due_move(){return S()}})]})),a})()},ke=r=>{const c=q(L),[l]=ee(()=>r.study.id,n=>c.get_study_imported_by_id(n));return s(m,{get when(){return l()},get fallback(){return s(W,{})},children:n=>s(xe,{get on_wheel(){return r.on_wheel},get due_move(){return r.due_move},get study(){return n()}})})},xe=r=>{const c=q(L),l=t(()=>r.study),n=t(()=>r.due_move),_=t(()=>n().moves[0].data.path),h=t(()=>l().sections.find(e=>e.name===n().section.name)),p=t(()=>h().chapters.find(e=>e.name===n().moves[0].chapter.name)),[P,C]=g(void 0),a=new oe;let[S,v]=g(void 0);const k=t(()=>te(n()?.before_fen??ne));F(()=>{a.on_set_fen_uci(n().before_fen)}),F(T(n,()=>{R(()=>{v(void 0),b(void 0),D([]),w(_().slice(0,-1))})}));const[x,w]=g(_().slice(0,-1),{equals:!1}),[A,D]=g([]);F(T(()=>a.add_uci,e=>{if(!e)return;const o=n();let[I,$]=e;const N=o.moves.map(V=>V.data.san);let y="✓",u="✗";const E=f();let M=y;N.includes($)?(M=y,E||b("easy")):(M=u,(!E||E==="hard")&&b("again")),C(le(I,$,M)),M===u?D(void 0):v(setTimeout(B,600))}));const H=([e,o])=>{a.on_set_fen_uci(e,o)},Q=()=>{if(f()==="again")return!1;b("hard"),D(_())},Y=()=>{R(()=>{b("again"),D(void 0),w(_())})},[f,b]=g(void 0),B=()=>{const e=n().before_fen,o=f();R(()=>{C(void 0),c.play_due_move(e,o??"again")})},j=t(()=>{const e=f();return!(!e||e==="hard")}),z=t(()=>f()===void 0),G=t(()=>f()!=="again"),J=t(()=>{let e=S(),o=f();return e===void 0&&o!=="again"}),[K,U]=g(void 0,{equals:!1});let O;return re(()=>{O.addEventListener("wheel",e=>{U(Math.sign(e.deltaY))},{passive:!0})}),[(()=>{var e=ge();return se(o=>O=o,e),d(e,s(ue,{get shapes(){return P()},get orientation(){return k()},get movable(){return J()},get doPromotion(){return a.promotion},get onMoveAfter(){return a.on_move_after},get fen_uci(){return a.fen_uci},get color(){return a.turnColor},get dests(){return a.dests}})),e})(),(()=>{var e=ve(),o=e.firstChild,I=o.firstChild,$=I.firstChild,N=$.nextSibling;return d($,()=>l().name),d(N,()=>p().name),d(e,s(ie,{get hide_after_path(){return A()},get on_wheel(){return K()},get pgn(){return p().pgn},on_fen_last_move:H,get cursor_path(){return x()},get children(){var y=pe();return d(y,s(m,{get when(){return S()},get fallback(){return[s(m,{get when(){return z()},get children(){var u=we();return u.$$click=Q,u}}),s(m,{get when(){return G()},get children(){var u=be();return u.$$click=Y,u}}),s(m,{get when(){return j()},get children(){var u=$e();return u.$$click=B,u}})]},get children(){return[]}})),y}}),null),e})()]},W=()=>ye();ae(["click"]);export{Fe as default};
