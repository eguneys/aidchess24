import{k as V,H as L,c as s,S as p,N as X,f as r,i as _,l as Z,a as m,D as ee,I as te,n as F,r as ne,u as re,d as se,t as c,J as H,q,x as I,m as ae}from"./index-CxjnW7CE.js";import{a as oe,D as ie}from"./types-DWxjifQ5.js";import{S as ue,C as le}from"./Chessboard-4w8FktvT.js";import{C as ce,a as _e}from"./ChessTreeWithTools-Cj_Do3X9.js";import"./Chesstree2-D38sT_Ch.js";var de=c("<div class=repeat-dues>"),he=c("<p>Completed All Due Moves."),pe=c("<div class=header><h3></h3><p></p><p> Due Moves"),me=c("<div class=board-wrap>"),ge=c("<div class=info>"),ve=c("<div class=replay-wrap><div class=replay-header><div class=title><h3></h3><h4>"),fe=c("<button>Hint: Show Previous Moves"),we=c("<button>Show Answer"),$e=c("<button>Next Due"),be=c("<span>Repeat Not Found");function ye(t){return t[Math.floor(Math.random()*t.length)]}const Fe=()=>{let t=V();const d=parseInt(t.id),a=L(H),u=oe(()=>a.repeat_by_id(d));return s(p,{get when(){return u()},get fallback(){return s(xe,{})},children:n=>s(Se,{get repeats(){return n()}})})},Se=t=>{const[d]=X(),a=r(()=>t.repeats),u=r(()=>new ie(a())),n=r(()=>{switch(d.filter){case"white":return u().due_white;case"black":return u().due_black;case"first-ten":return u().due_10;case"ten-twenty":return u().due_10_20;case"twenty-plus":return u().due_20plus;default:return u().due}}),M=r(()=>{switch(d.filter){case"white":return"White Only";case"black":return"Black Only";case"first-ten":return"First 10 moves";case"ten-twenty":return"10-20 moves";case"twenty-plus":return"20+ moves";default:return"All moves"}}),y=r(()=>ye(n()));return(()=>{var S=de();return _(S,s(p,{get when(){return y()},get fallback(){return he()},children:C=>[(()=>{var l=pe(),g=l.firstChild,v=g.nextSibling,k=v.nextSibling,N=k.firstChild;return _(g,()=>a().name),_(v,M),_(k,()=>n().length,N),l})(),s(Ce,{get repeats(){return a()},get due_move(){return C()}})]})),S})()},Ce=t=>{const[d]=Z(()=>t.due_move.ucis[0].section.study_id,a=>ae.read_section_study(a));return s(p,{get when(){return d()},children:a=>s(ke,{get on_wheel(){return t.on_wheel},get repeats(){return t.repeats},get due_move(){return t.due_move},get study(){return a()}})})},ke=t=>{const d=L(H),a=r(()=>t.study),u=r(()=>t.repeats),n=r(()=>t.due_move),M=r(()=>a().sections.find(e=>e.name===n().ucis[0].section.section_name)),y=r(()=>M().chapters.find(e=>e.name===n().ucis[0].section.chapter_name)),[S,C]=m(void 0),l=new ue;let[g,v]=m(void 0);const k=r(()=>ee(n()?.fen??te));F(()=>{}),F(q(n,()=>{I(()=>{f(void 0),x([]),R(n().ucis[0].path.slice(0,-1))})}));const[N,R]=m(n().ucis[0].path.slice(0,-1),{equals:!1}),[O,x]=m([]);F(q(()=>l.add_uci,e=>{if(!e)return;const o=n();let[w,$]=e;const P=o.ucis.map(U=>U.san);let b="✓",i="✗";const A=h();let D=b;P.includes($)?(D=b,A||f("easy")):(D=i,(!A||A==="hard")&&f("again")),C(_e(w,$,D)),D===i?x(void 0):v(setTimeout(E,600))}));const W=([e,o])=>{l.on_set_fen_uci(e,o)},B=()=>{if(h()==="again")return!1;f("hard"),x(n().ucis[0].path)},J=()=>{I(()=>{f("again"),x(void 0),R(n().ucis[0].path)})},[h,f]=m(void 0),E=()=>{const e=u().id,o=n().fen,w=h();I(()=>{C(void 0),d.play_due_move(e,o,w??"again"),v(void 0)})},Q=r(()=>{const e=h();return!(!e||e==="hard")}),Y=r(()=>h()===void 0),j=r(()=>h()!=="again"),z=r(()=>{let e=g(),o=h();return e===void 0&&o!=="again"}),[G,K]=m(void 0,{equals:!1});let T;return ne(()=>{T.addEventListener("wheel",e=>{K(Math.sign(e.deltaY))},{passive:!0})}),[(()=>{var e=me();return re(o=>T=o,e),_(e,s(le,{get shapes(){return S()},get orientation(){return k()},get movable(){return z()},get doPromotion(){return l.promotion},get onMoveAfter(){return l.on_move_after},get fen_uci(){return l.fen_uci},get color(){return l.turnColor},get dests(){return l.dests}})),e})(),(()=>{var e=ve(),o=e.firstChild,w=o.firstChild,$=w.firstChild,P=$.nextSibling;return _($,()=>a().name),_(P,()=>y().name),_(e,s(ce,{get hide_after_path(){return O()},get on_wheel(){return G()},get pgn(){return y().pgn},on_fen_last_move:W,get cursor_path(){return N()},get children(){var b=ge();return _(b,s(p,{get when(){return g()},get fallback(){return[s(p,{get when(){return Y()},get children(){var i=fe();return i.$$click=B,i}}),s(p,{get when(){return j()},get children(){var i=we();return i.$$click=J,i}}),s(p,{get when(){return Q()},get children(){var i=$e();return i.$$click=E,i}})]},get children(){return[]}})),b}}),null),e})()]},xe=()=>be();se(["click"]);export{Fe as default};
